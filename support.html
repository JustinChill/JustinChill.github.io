<!DOCTYPE html>
<html lang="en">

<head>
  <title>A ticket beyond</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="How customer support teams have evolved at SaaS companies.">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="keywords" content="data viz, SaaS, technical support, customer support, ">
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="website" property="og:type">
  <meta content="https://justinchill.com/support.html" property="og:url">
  <meta content="A ticket beyond" property="og:title">
  <meta content="How customer support teams have evolved at SaaS companies." property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/support.html">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="A ticket beyond">
  <meta name="twitter:description" content="How customer support teams have evolved at SaaS companies.">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <style type="text/css">

  </style>
</head>

<body>
  <nav class="nav" role="navigation">
    <div class="nav__list">
      <a href="index.html" class="nav__item" aria-label="Homepage">Home</a>
      <a href="blog.html" class="nav__item" aria-label="Blog section">Blog</a>
      <a href="now.html" class="nav__item" aria-label="Now page">Now</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <div class="article-hero mid-size">
        <h2 class="article-category">Called out</h2>
        <h1 class="article-title">A ticket beyond</h1>
        <h2 class="article-subtitle">Technical Support Teams in the Age of AI</h2>
      </div>
      <img src="https://www.economist.com/cdn-cgi/image/width=1424,quality=80,format=auto/content-assets/images/20241019_WBD001.jpg" />
        <p>It’s a rainy Tuesday morning at a rising SaaS startup, and the technical support inbox is already overflowing. Panicked emails about login errors mix with chat pings from users struggling to find a hidden feature. The support agents – the unsung first responders of the software world – spring into action. They know every interaction counts: <strong>over 70% of customers will jump to a competitor after multiple bad support experiences</strong>.</p> 
        <p>In SaaS (software-as-a-service), where customers pay month after month, a single glitch or misunderstanding could mean a lost subscription. The support team’s mission isn’t just to fix bugs or reset passwords; it’s to <strong>ensure customers fully understand the product’s value, smoothing every bump on the user journey to prevent churn</strong>. In other words, a great support conversation can be the difference between a loyal customer and a lost customer.</p>
        <h2>The Front Lines: Roles and Goals</h2>
        <p>Technical support team members wear many hats. On any given day, a support agent might be an educator guiding a new user through a feature, a detective troubleshooting an unexpected error, or a therapist calming a frustrated client. The overarching goal is the same: resolve the customer’s issue completely – and do it with such clarity and care that the user comes away more confident in the product than before.</p> 
        <p>This means reiterating the product’s value at every interaction, not just expeditiously closing tickets. A good support rep shortens the learning curve of a complex app and helps customers unlock features they might never have discovered on their own. The payoff for the business is huge: effective support accelerates product adoption, boosts customer satisfaction, and protects the recurring revenue stream that SaaS firms rely on.</p> <p>In my opinion, support isn’t a mere cost center – it’s a retention engine. In fact, studies show <strong>72%</strong> of consumers have stopped doing business with a company <mark>after just one bad support experience</mark>, whereas resolving issues effectively builds loyalty. The stakes riding on each support interaction are sky-high.</p>
        <p>This high-pressure mandate has traditionally been met with a combination of human empathy and technical expertise – bolstered by an evolving arsenal of tools. Over the past decade, SaaS support teams have adopted various technologies to help them serve customers faster and more consistently. <strong>Ticketing systems</strong> became the backbone, funneling customer queries from emails and web forms into an organized queue instead of an agent’s chaotic inbox. A good helpdesk doesn’t just track issues; it prioritizes and routes them, ensuring nothing falls through the cracks. Meanwhile, <strong>live chat</strong> brought real-time immediacy to support. Instead of waiting hours for an email reply, customers could get answers in minutes through in-app chat windows or messaging platforms. And for the support agents, chat opened a chance to juggle multiple conversations at once or use chatbots to greet users and handle basic questions. It’s no coincidence that <strong>using helpdesk software and live chat has been shown to streamline support conversations and improve resolution quality</strong> – these tools imposed order and speed on an inherently unpredictable workflow.</p>
        <p>Perhaps the most ubiquitous efficiency booster has been the humble <strong>scripted response</strong>. Also known as <em>macros</em> or <em>canned replies</em>, these are pre-written answers for common questions – the copy-paste snippets that turn a five-minute typing exercise into a one-click response. <strong>“Macros, canned responses, scripts, templates… call them what you want – they offer improved speed and accuracy for handling repetitive inquiries,”</strong> as one customer service expert notes. With a well-crafted library of templates, a support agent can respond to “How do I reset my password?” or “Is there a discount for annual plans?” in seconds, with a friendly, polished answer that has been refined over time. This kind of positive scripting not only saves time but helps maintain a consistent, on-brand voice across the team. The result: less waiting for customers and fewer errors under pressure.</p>
        <p>Yet for all their benefits, these first waves of support automation had their limits. Traditional chatbots followed decision trees – helpful for simple FAQs, but easily stumped by anything unexpected. Ticket systems and routing rules could sort issues, but not actually solve them. And canned responses, if overused, risked turning service robotic. <strong>Customers can tell when they’re getting a one-size-fits-all answer</strong>. The moment a reply feels copy-pasted or doesn’t quite address the question, frustration mounts. <em>“The agent didn’t actually read my question and instead sent me this canned response,”</em> goes a common complaint, illustrating how impersonal scripts can backfire.</p> 
        <p>In short, earlier automation helped support teams cope with volume and standardize service, but it didn’t replace the need for a savvy human to really understand and resolve the customer’s problem. The hardest issues still had to be untangled by Tier-2 specialists; the angriest customers still wanted a manager on the phone. As SaaS businesses scaled to thousands (or millions) of users, the gap between rising support demand and the ability of human teams to keep up became a looming challenge. Hiring more agents is expensive and not always feasible – yet letting service quality slip means users flee to competitors in a single click.</p>
        <h2>Automation Levels Up: From Scripts to Smart Agents</h2>
        <p>Now, a new technological wave is breaking in the support world – one that promises not just to streamline the work of human agents, but to <strong>fundamentally transform who (or what) handles customer issues. Generative AI has entered the chat.</strong> Powered by large language models that can understand and produce human-like text, generative AI is poised to handle a wide swath of support tasks that once required a person’s touch. These AI systems <strong>“understand natural language, identify context, and even interpret emotion”</strong> in a customer’s message. They don’t rely on rigid scripts or predefined options. Ask a question in plain English (or Spanish, or Hindi – they’re multilingual by nature), and they can not only find an answer in the knowledge base, but phrase it in a friendly sentence. They can troubleshoot problems step-by-step, tailoring each follow-up question based on what the user said earlier. In essence, the latest AI support agents aim to <strong>mimic a talented human rep – one who’s always available, instantly scalable, and blissfully immune to burnout</strong>.</p>
        <p>This isn’t just hype; it’s already happening. In 2023, Intercom – a customer messaging platform – surveyed support leaders and found <strong>69% planned to invest more in AI</strong> for customer service (with 38% already doing so). The rationale is clear. Imagine a virtual assistant that can instantly field the routine queries that bog down human agents: “How do I change my billing info?” “Why isn’t my integration working?” If AI can handle those in seconds, the support team can focus on tougher cases. <strong>Automation in support has always been about freeing up humans’ time, not removing the human element</strong>. Generative AI just takes this to a new level. Instead of simple chatbots that operate on <em>“message in, response out”</em> logic, we now have AI that can conduct a nuanced dialogue. <em >“Real customers change their minds, ask clarifying questions, and expect the AI to follow along naturally,”</em> says Adrian McDermott, CTO of Zendesk, noting how traditional bots struggled with anything outside their scripted flow. By contrast, the new AI systems can handle the twists and turns. They use techniques like retrieval augmented generation (grounding their answers in real help center data) and dynamic reasoning to stay on track. They can even decide when to deviate from a script – asking <em>you</em> a question if it’ll help pinpoint your issue.</p>
        <p>This shift is evident in the tools major SaaS players are rolling out. <strong>Zendesk</strong>, a longtime leader in customer support software, recently partnered with OpenAI to reinvent its chatbot technology. The result is a <em >“new class of agentic AI agents”</em> that do more than respond – <em>“they lead conversations, reason through context, and drive toward resolution.”</em> In early pilots, Zendesk reported these autonomous agents handling entire multi-step support dialogues on their own. They can clarify what a customer needs, lookup relevant policies or data, and even execute procedures like resetting an account or escalating a ticket – all without human intervention. The goal? <strong>Handle up to 80% of customer inquiries start-to-finish through AI</strong>, reserving only the most complex or sensitive cases for people. It’s an ambitious target, but one Zendesk believes is reachable with this new adaptive approach.</p>
        <p><strong>Intercom</strong> has taken a similar plunge with its aptly named AI bot, Fin. Billed as <em>“the #1 AI agent for customer service,”</em> Fin was built using OpenAI’s GPT-4 and proprietary tech to achieve something previous bots couldn’t: answer not just simple FAQs, but the majority of real-world customer questions. At Lightspeed, a global commerce platform, Fin <strong>now plays a role in 99% of support conversations and resolves <em>up to 65%</em> of them end-to-end</strong> – even the tricky ones. <em>“Fin is in a completely different league,”</em> says one Lightspeed support leader, noting that it even tackles complex queries that used to require escalation. Crucially, Fin is designed with a safety net: when it doesn’t know or lacks confidence, it can seamlessly hand off to a human agent. But by handling two-thirds of issues on its own, it dramatically lightens the team’s load.</p>
        <p>No discussion of AI in SaaS support would be complete without <strong>Salesforce</strong>, the CRM titan. Salesforce’s support platform (Service Cloud) introduced <strong>Einstein GPT</strong>, a generative AI copilot woven into the fabric of its CRM. Einstein GPT can <strong>“generate specific responses for customer service professionals to more quickly answer customer questions”</strong>. More impressively, it auto-drafts entire knowledge base articles from past case notes. Every support agent knows the pain of writing up a help article after solving a novel problem; Einstein GPT proposes to do it for them in seconds, turning one customer’s resolved ticket into documentation that can help thousands of others. By training on a company’s own historical support data (securely and privately within the Salesforce platform), it tailors its suggestions to the business’s context. The aim is a virtuous cycle: the AI learns from past support interactions to improve future ones, while agents get AI-crafted drafts that they can refine and send – saving time without sacrificing the personal touch. <strong>Customer service becomes faster and more personalized at once</strong>.</p>
        <p>Meanwhile, <strong>Freshworks</strong> – maker of the popular Freshdesk support suite – has unleashed its <strong>Freddy AI</strong> across the support workflow. Freddy isn’t a single bot but a collection of AI capabilities: <strong>Freddy Self Service (an AI agent for customer queries), Freddy Copilot (an assistant for human agents), and Freddy Insights (analytics)</strong>. When Freshworks rolled out these tools in 2023, they reported striking early results: in private beta, <strong>Freddy AI Agent autonomously resolved roughly 45% of all incoming customer support requests</strong>. That’s nearly half of issues handled from start to finish by AI – customers got their answers or fixes without any human stepping in. The AI agent works across channels (web chat, email, even Slack or Teams), and it learns your company’s FAQs and policies in minutes by ingesting your help center content. <em>“The best part is how quickly it can be deployed,”</em> says one product manager who configured a Freshdesk AI bot in 20 minutes by feeding it their FAQ pages. For a mid-sized business, it’s like instantly training a new support rep who’s read the entire company wiki and never sleeps. And when this AI agent is stumped or when a VIP client needs hand-holding, Freddy gracefully forwards the conversation to a human agent – complete with a summary so the human doesn’t start cold.</p>
        <p>For the support teams at these companies, the impact is transformative. Response times that used to be hours are now seconds. <strong>Customers can get 24/7 help in a conversational format, boosting satisfaction and cutting wait times</strong>. One obvious benefit is <strong>cost</strong>: AI agents don’t demand salaries or overtime, so handling more tickets with bots can bend the customer support cost curve down. Traditionally, if your user base doubled, your support volume would too – and you’d need to hire more staff in kind. But <strong>SaaS firms discovered that automation lets them scale support without a linear rise in headcount or expense</strong>. Self-service portals, chatbots, and now generative AI mean <em>one</em> agent (human or otherwise) can do the work that once required many. As an industry comparison noted, a SaaS support operation can be “easily scalable with automation, bots, and self-service… cost-efficient per user,” whereas old-school support had no choice but to add bodies at high cost as the customer base grows.</p>
        <p>However, the equation isn’t as simple as <em>AI in, humans out</em>. In practice, <strong>these tools are as much about augmenting human agents as replacing them</strong>. The best SaaS support teams now function like a <strong>human-AI hybrid</strong>, each doing what they do best. The AI copilot features in tools like Zendesk and Freshdesk illustrate this well: while an AI agent might handle a straightforward refund request autonomously, a human agent handling a complex issue can rely on AI to do grunt work in the background – searching knowledge bases, summarizing long customer descriptions, even suggesting the next reply. For example, Zendesk’s suite can <strong data-start="15287" data-end="15389">auto-suggest a first response draft to a ticket based on similar past cases and knowledge articles</strong>, saving the agent from starting from scratch. It can also instantly summarize a messy multi-email thread so a new agent taking over doesn’t need 10 minutes to read it all. Freshworks’ Freddy Copilot similarly <strong data-start="15677" data-end="15772">suggests replies, summarizes conversations, and translates messages in real time for agents</strong>. In the hands of a skilled support rep, such AI tools are like a superpower – they shorten research time, ensure nothing is overlooked, and even adjust the tone of messages on the fly (making an overly formal draft sound more empathetic, for instance). The agent remains in control, but they’re more efficient and consistent with AI riding shotgun.</p>
        <h2>Augmenting the Human Touch (Without Erasing It)</h2>
        <p>What does all this mean for the people who make a career in customer support? There’s understandable anxiety. If a bot can do the first reply, the second, and maybe the whole thing, what’s left for the humans? The optimistic view – and so far, the prevailing narrative in the industry – is that <strong>AI will free human agents to focus on higher-value work, rather than eliminate them.</strong> <em>“Automation is about freeing up your team’s time, not removing the human element,”</em> one SaaS support guide emphasizes. In the real world, companies using these AI tools report something similar: their human agents are still essential, but their roles are evolving. A support manager at Bchex, a startup that adopted Freshworks’ Freddy AI, reflected that <strong>the AI now handles the repetitive inquiries, allowing the human team to <em>“spend their time and resources to address tougher issues”</em></strong> – the thorny problems, critical bugs, or sensitive customer situations where a personal touch is irreplaceable. In this way, the AI is like a tireless Level-1 support rep, triaging and solving basic cases, while human staff move up the value chain to Level-2 and Level-3 expertise.</p>
        <p>From a cost perspective, companies see a chance to rein in the ballooning expense of large support operations. If one AI agent can resolve 50% of tickets, that might mean you don’t need to hire quite so many new agents next quarter, or you can handle a surge of users without the support backlog exploding. But many SaaS leaders are quick to position AI as a <strong>productivity booster</strong> rather than a pink slip machine. <em>“We’re only just beginning to see the positive impact of agentic AI on the workplace,”</em> says Freshworks CTO Murali Swaminathan, who envisions an <em data-start="18053" data-end="18078">“orchestrated symphony”</em> of specialized AI agents working together with humans. In his view, AI agents will increasingly handle the bulk of routine requests, <strong data-start="18251" data-end="18321">while human experts oversee the process and step in for exceptions</strong>. An IDC analyst studying these trends noted that using AI in support can actually <em data-start="18443" data-end="18459">reduce burnout</em> among human agents, by <em data-start="18483" data-end="18511">“automating the rote work”</em> and empowering staff to focus on more meaningful, engaging tasks. In theory, that could mean happier support teams and lower turnover – a big win, considering how emotionally taxing front-line customer service can be.</p>
        <p data-start="18770" data-end="20498">Still, the rise of AI in customer support raises important questions about quality and trust. An answer that arrives in 2 seconds is great – <strong data-start="18911" data-end="18947">only if it’s correct and helpful</strong>. The nightmare scenario is an AI confidently giving a wrong or harmful answer to a customer, which can erode trust faster than an unresolved ticket. SaaS companies are well aware of this “hallucination” risk (when an AI makes up an answer). That’s why so much focus is placed on <strong data-start="19227" data-end="19259">guardrails and hybrid models</strong>. For instance, Zendesk’s new AI agents operate within strict guidelines: they use <strong data-start="19342" data-end="19441">retrieval techniques to base their answers on verified knowledge base content and company rules</strong>, and they show a “chain of thought” that developers can review to audit how the AI is reaching its conclusions. If the AI decides to execute an action (like refunding a transaction or making an account change), it’s confined by the procedures defined by the business – often needing a confirmation or presenting a preview of steps to an agent for approval. In Salesforce’s world, Einstein GPT’s outputs are grounded in the customer’s actual CRM data, and it operates in a <em data-start="20070" data-end="20083">closed loop</em> within the CRM so that sensitive data isn’t exposed externally. These measures are all about ensuring that AI-driven support stays <strong data-start="20254" data-end="20288">accurate, secure, and on-brand</strong>. It’s early days, and no one is claiming the systems are perfect. But each successful hand-off or each trusted automation builds confidence that more of the support process can safely be delegated to machines.</p>
        <p data-start="20500" data-end="22001">Then there’s the matter of the <strong data-start="20531" data-end="20549">“human touch.”</strong> Customer support, at its heart, is a people business. Many users still take comfort in knowing a real person has heard them and cares about their issue. Can an AI empathize? Can it build rapport? The latest chatbots do try – they can apologize politely and use a concerned tone. Yet, there is a conscious effort in the SaaS industry not to lose sight of the value of human empathy. Companies talk about maintaining a <strong data-start="20967" data-end="21021">balance between efficiency and personal connection</strong>. The most advanced support operations strive for <em data-start="21149" data-end="21177">“personalization at scale”</em> – a vision where AI helps tailor solutions for each customer, but <em data-start="21283" data-end="21290">feels</em> personal, not generic. In practical terms, this might mean AI handles the first few exchanges (and maybe the entire resolution) for a straightforward query, but if a customer is upset or the issue is sensitive, a human is looped in to offer apologies or reassurance in a way only a human can. Some companies are exploring hybrid responses – AI drafts the message, but <strong data-start="21659" data-end="21700">the human adds a personal line or two</strong> and double-checks the tone before hitting send, blending consistency with warmth. As support teams become “AI orchestrators,” training shifts to teaching agents not just how to solve problems, but how to <em data-start="21905" data-end="21916">work with</em> AI – knowing when to trust the suggestions and when to intervene with a human touch.</p>
        <h2 data-start="22003" data-end="22037">The New Normal for SaaS Support</h2>
        <p data-start="22039" data-end="23218">In the span of just a few years, the role of a SaaS support team is being reinvented. The traditional model – rows of agents feverishly typing replies – is evolving into something more agile and tech-powered. Today, a single support interaction might involve three parties: the customer, a frontline AI, and a human specialist on standby. The <strong data-start="22382" data-end="22433">implications for the SaaS industry are profound</strong>. Support has long been a major cost center for subscription software businesses; with generative AI, those costs could be trimmed significantly, or at least redeployed into more strategic areas. <strong data-start="22629" data-end="22662">Efficiency gains are tangible</strong> – faster response times, higher volumes handled – but so is the potential for improved quality. An AI that instantly searches a thousand past tickets can surface insights (and solutions) that a lone agent might miss. A well-trained model might suggest a workaround to a bug that even the product team hasn’t documented yet, simply because it “read” about a similar scenario in another case. In the best outcome, <strong data-start="23075" data-end="23167">AI support agents make SaaS companies more responsive and knowledgeable than ever before</strong>, which in turn keeps users happier and more loyal.</p>
        <p data-start="23220" data-end="24189">The competitive landscape will likely shift as well. Just as companies once vied on having the best features, they may soon compete on who offers the smartest, fastest support. If ChatGPT-like helpers become a standard part of the SaaS customer experience, users will come to expect instant, accurate answers 24/7. Late at night, when your database crashes, you might visit your SaaS provider’s help center and find not a list of articles, but a friendly AI chat bubble ready to walk you through a fix – or escalate you to a human on-call if it hits a wall. That kind of always-on, intelligent support could become a key selling point. It’s telling that a research firm like Gartner predicts that by 2028, <strong data-start="23926" data-end="24107">a third of enterprise software applications will include “agentic AI” – autonomous agents that make decisions – enabling 15% of all work decisions to be made without human input</strong>. Customer service is leading this charge.</p>
        <p data-start="24191" data-end="25478">Of course, the story is still unfolding. We’re in the early chapters of generative AI in customer support, and there will be bumps ahead – whether it’s an infamous AI goof that goes viral, or pushback from customers who just <em data-start="24416" data-end="24424">really</em> want to talk to a person. But the trajectory seems clear. As Patrick Radden Keefe might chronicle in one of his incisive narratives, an old order is yielding to a new one: the diligent support reps armed with playbooks and ticket queues are now sharing their desks with AI copilots and digital agents. In countless small interactions – a password reset here, a troubleshooting session there – the fabric of SaaS support is being rewoven by artificial intelligence. The companies that master this blend of technology and humanity stand to set a new standard for service: ultra-efficient <strong data-start="25011" data-end="25018">and</strong> deeply empathetic. In the end, the heart of customer support remains the same as it ever was – <em data-start="25114" data-end="25175">help the customer, solve the problem, make them feel valued</em>. The tools may be radically different, but if anything, they exist to double down on that mantra. With AI taking over the drudgery and supplementing human expertise, support teams can focus more than ever on truly caring for customers. And that, ironically, may be the most “human” improvement of all.</p>
    </article>
  </main>

  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <!-- <li id="Chayka"><a href="https://www.nytimes.com/2017/08/19/opinion/trump-nazism-republican-party-failing.html">Illustration</a> by Doug Chayka.</li> -->
      <li>Zendesk, <em data-start="25505" data-end="25563">“SaaS customer support: An introductory guide for 2025,”</em> Feb. 24, 2025.
      </li>
      <li>Hiver (Karishma Sehgal), <em data-start="25686" data-end="25771">“SaaS Customer Support in 2025: Tactics, Tools, and Examples That Drive Retention,”</em> 2025.
      </li>
      <li>Hiver, <em data-start="25867" data-end="25901">“SaaS Customer Support in 2025,”</em> on why support is critical for retention and adoption.
      </li>
      <li>Jeremy Watkin, <em data-start="26054" data-end="26069">CustomerThink</em>, <em data-start="26071" data-end="26138">“Macros Are an Essential Contact Center Tool… if Used Correctly,”</em> Nov. 2020.
      </li>
      <li>Gorgias (Ryan Baum), <em data-start="26253" data-end="26316">“Positive Scripting in Customer Service: How To Do It Right,”</em> June 28, 2024.
      </li>
      <li>OpenAI, <em data-start="26422" data-end="26480">“Zendesk uses OpenAI to build adaptive service agents…,”</em> Mar. 27, 2025.
      </li>
      <li>
        OpenAI, <em data-start="26586" data-end="26617">“Zendesk…proactive AI agents”</em> (Adrian McDermott interview).
      </li>
      <li>
        Intercom, <em data-start="26740" data-end="26812">“Generative AI for customer support: History, benefits and use cases,”</em> 2023.
      </li>
      <li>
        Intercom (fin.ai), Lightspeed case – AI resolves 65% of conversations.
      </li>
      <li>
        Salesforce Press Release, <em data-start="27041" data-end="27116">“Salesforce Announces Einstein GPT, World’s First Generative AI for CRM,”</em> Mar. 7, 2023.
      </li>
    </ol>

    <div>
      <p>Justin Chill &copy; 2025</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" alt="GitHub logo" class="icon">Source code</a></span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>

  <script type="text/javascript">
    var element = d3.select('figure').node();
    var width = element.getBoundingClientRect().width; // get width of article so graphic is responsive
    var size = 12;
    const formatDate = d3.timeFormat("%B %d, %Y");
    const formatPercent = d3.format(".0%");

    // Use Promises to async request data
    var promises = [d3.csv("data/NYTStock_Full Data_data.csv", function(d) {
      return { // Accessor function to convert strings to numbers, dates
        Date: new Date(d.Date), // convert column to Date
        Close: +d.Close,
        Growth: +d.Growth,
      }
    })];

    myDataPromises = Promise.all(promises);

    // After data is successfully fetched, generate viz
    myDataPromises.then(function(data) {
      // Define the data. There's gotta be a better way to do this:
      var stocks = data[0];

      var lineChart = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          paddingLeft: 24,
          paddingRight: 10,
          paddingBottom: 10
        },
        x: {
          tickSize: 0,
        },
        y: {
          tickSize: 0,
          // tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}` : `${d}`), // Show $ on first tick only
          tickFormat: (d) => `$${d}`,
          grid: true,
          ticks: 4,
          domain: [0, 60]
        },
        marks: [
          Plot.areaY(stocks, {
            x: "Date",
            y: "Close",
            fill: "url(#gradient)"
          }),
          Plot.line(stocks, {
            x: "Date",
            y: "Close",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
            },
            curve: "catmull-rom",
            strokeWidth: 3,
            sort: "Date",
            title: d => `${formatDate(d.Date)}\nClose: $${d.Close}\nGrowth: ${formatPercent(d.Growth)}`,
          }),
          Plot.text(stocks, Plot.selectFirst({
            text: d => `Election day, 2016\nClose: $${d.Close}`,
            frameAnchor: "bottom-left",
            fontSize: 14,
            lineHeight: 1.5,
            dx: 6,
            dy: -30,
            stroke: "white",
            strokeWidth: .5,
            fill: "currentColor"
          })),
          Plot.text(stocks, Plot.selectLast({
            text: d => `Close: $${d.Close}`,
            frameAnchor: "right",
            fontSize: 14,
            dx: -6,
            dy: -20,
            stroke: "white",
            strokeWidth: .5,
            fill: "currentColor"
          })),
        ]
      };

      document.getElementById("lineChart").appendChild(Plot.plot(lineChart));
    });
  </script>
</body>

</html>