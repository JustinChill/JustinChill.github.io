<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <title>Palmer's Penguins</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Penguins at Palmer Station Antarctica">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="keywords" content="penguins, chart, graph, data viz, Palmer's Penguins">
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="website" property="og:type">
  <meta content="Palmer's Penguins" property="og:title">
  <meta content="Penguins at Palmer Station Antarctica." property="og:description">
  <meta property="og:image" content="https://public.tableau.com/static/images/Pe/PenguinsatPalmerStationAntarcticaLTER/Week28/4_3_hd.png" data-rh="true">
  <meta content="1200" property="og:image:width">
  <meta content="630" property="og:image:height">
  <meta content="Penguins at Palmer Station Antarctica" property="og:image:alt">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/penguins.html">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Penguins at Palmer Station Antarctica">
  <meta name="twitter:description" content="Data visualization of penguins at Palmer Station Antarctica.">
  <meta name="twitter:image" content="https://public.tableau.com/static/images/Pe/PenguinsatPalmerStationAntarcticaLTER/Week28/4_3_hd.png">
  <meta name="twitter:image:width" content="800">
  <meta name="twitter:image:height" content="418">
  <meta name="twitter:image:alt" content="Penguins at Palmer Station Antarctica">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <style type="text/css">
    p img {
      float: right;
      border-radius: 4px;
      padding: var(--spacer-1);
    }
    svg[class*="plot"]{
      overflow: hidden;
    }
  </style>
</head>

<body>
  <nav class="nav">
    <div class="nav__list">
      <a href="index.html" class="nav__item">Home</a>
      <a href="blog.html" class="nav__item">Blog</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <div class="article-hero">
        <h2 class="article-category">Post</h2>
        <h1 class="article-title">Palmer's Penguins</h1>
        <h2 class="article-subtitle">Penguins at the Palmer Station Antarctica Long-Term Ecological Research site</h2>
      </div>
      <!-- <img src="https://impact.economist.com/ocean/images/macaroni-penguins-on-their-voyage?f=auto&w=1920" loading="lazy" alt="Macaroni Penguins on their voyage"> -->
      <figure id="map"></figure>
      <figcaption class="right">Research stations in Antarctica</figcaption>
      <p>The Palmer Penguins data contains size measurements, clutch observations, and blood isotope ratios for <strong>344</strong> Penguins of <strong>3</strong> penguin species observed on three islands in the Palmer Archipelago, Antarctica over a study period of three years. The <code>palmerpenguins</code> data is commonly used when introducing students to new data science concepts.</p>
      <p>The canonical paper from Gorman et al. presents the research in detail<a href="#gorman" aria-describedby="footnote-label" id="gorman-ref"></a>. Palmer's Penguins is an alternative to the <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/iris.html">Iris</a> sample dataset.</p>      
      <h2>Meet the penguins</h2>
      <img src="imgs/lter_penguins.png" alt="The Palmer Archipelago penguins. Artwork by @allison_horst.">
      <p>The data contains three penguin species and includes measurements of bill length, bill depth, flipper length and body mass.</p>
      <aside>Fun fact! The <a href="https://wiki.gentoo.org/wiki/FAQ">Gentoo</a> Linux distribution is named after this penguin species &#129299;</aside>
      <p>These data were collected from 2007 - 2009 by Dr.&nbsp;Kristen Gorman with the <a href="https://pal.lternet.edu/" class="external-link">Palmer Station Long Term Ecological Research Program</a>, part of the <a href="https://lternet.edu/" class="external-link">US Long Term Ecological Research Network</a>. The data were imported directly from the <a href="https://environmentaldatainitiative.org/" class="external-link">Environmental Data Initiative</a> (EDI) Data Portal, and are available for use by CC0 license (“No Rights Reserved”) in accordance with the <a href="https://pal.lternet.edu/data/policies" class="external-link">Palmer Station Data Policy</a>.<img src="imgs/penguin-bill.jpg" loading="lazy" class="float-right" alt="Inset clarifying that in the raw data, bill dimensions are recorded as 'culmen length' and 'culmen depth'. The culmen is the dorsal ridge atop the bill."></p>
      <p>At the Palmer Station, three species of Penguins were measured on various structural aspects like body mass, bill Length, bill depth and flipper length. PAL scientists have documented an 85 percent reduction in Adélie penguin populations along the western Antarctic Peninsula since 1974.</p>
      <h2>Penguins by Island</h2>
      <figure id="islands"></figure>
      <figcaption>Source: <a href="https://environmentaldatainitiative.org/">Environmental Data Initiative</a></figcaption>
      <p>The penguins were studied on three islands: Biscoe, Dream, and Torgersen.</p>

      <h2>Bill Length vs. Body Mass</h2>
      <figure id="facets" class=""></figure>
      <figcaption>Source: Structural size measurements and isotopic signatures</figcaption>
      <h2>Bill Length vs. Bill Depth</h2>
      <figure id="scatter" class=""></figure>
      <figcaption>Source: Structural size measurements and isotopic signatures</figcaption>

      <div class="videoContainer">
        <video controls="" height="360" id="sunVideo" poster="https://antarcticsun.usap.gov/science/images8/lteranniversary-banner.jpg" preload="none" width="100%">
          <source src="/science/images8/lteranniversary.mp4" type="video/mp4">
          <source src="https://antarcticsun.usap.gov/science/images8/lteranniversary.mp4" type="video/webm">
        </video>

        <div id="videoButton" style="visibility: visible;">&nbsp;</div>

        <div class="videoText visually-hidden">Produced by Lauren Lipuma for the U.S. Antarctic Program. This animation shows how the populations of Adélie, Chinstrap, and Gentoo penguins around Anvers Island have changed from 1980 to 2020. One penguin represents 500 breeding pairs. Data courtesy of Bill Fraser. Numbers of penguins are estimates.</div>
      </div>
      <h2>Penguin species</h2>
      <figure id="waffle" class=""></figure>
      <figcaption>Source: <a href="https://environmentaldatainitiative.org/">Environmental Data Initiative</a></figcaption>

      <figure id="density" class=""></figure>
      <h2>Simpson's Paradox</h2>
      <figure id="regression"></figure>
      <p>If you measure the relationship between culmen depth and length in a mixed population of penguins, it is <a href="https://observablehq.com/plot/marks/linear-regression">positively correlated</a> in each of the three species (bigger penguins with the longer culmens also tend to have the deeper ones); however, the Gentoo population has a smaller aspect ratio of depth against length, and the overall correlation across the three species is negative. This is called <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson’s paradox</a>, and it applies to any data that contains underlying populations with different properties or outcomes.</p>

      <h2></h2>
      <figure id="weightBars"></figure>
      <figcaption>Source: <a href="https://environmentaldatainitiative.org/">Environmental Data Initiative</a></figcaption>
      <p></p>

      <img src="https://impact.economist.com/ocean/images/more-penguins?f=auto&w=1920" loading="lazy" alt="Two king penguins face each other on a sandy beach near the ocean.">
      <h2>References</h2>
      <p>Individual data can be accessed directly via the <a href="https://environmentaldatainitiative.org/">Environmental Data Initiative</a>:</p>
      <ul>
        <li>
          <p>Palmer Station Antarctica LTER and K. Gorman, 2020. Structural size measurements and isotopic signatures of foraging among adult male and female Adélie penguins (<em>Pygoscelis adeliae</em>) nesting along the Palmer Archipelago near Palmer Station, 2007-2009 ver 5. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/98b16d7d563f265cb52372c8ca99e60f">doi.org</a>.</p>
        </li>
        <li>
          <p>Palmer Station Antarctica LTER and K. Gorman, 2020. Structural size measurements and isotopic signatures of foraging among adult male and female Gentoo penguin (<em>Pygoscelis papua</em>) nesting along the Palmer Archipelago near Palmer Station, 2007-2009 ver 5. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/7fca67fb28d56ee2ffa3d9370ebda689">doi.org</a>.</p>
        </li>
        <li>
          <p>Palmer Station Antarctica LTER and K. Gorman, 2020. Structural size measurements and isotopic signatures of foraging among adult male and female Chinstrap penguin (<em>Pygoscelis antarcticus</em>) nesting along the Palmer Archipelago near Palmer Station, 2007-2009 ver 6. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/c14dfcfada8ea13a17536e73eb6fbe9e">doi.org</a>.</p>
        </li>
      </ul>
      <img src="https://education.rstudio.com/blog/2020/07/palmerpenguins-cran/antarctica-map.png" alt="3 study sites on a map of Antarctic Peninsula">
    </article>
  </main>
  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <li id="gorman"><a href="https://doi.org/10.1371/journal.pone.0090081">Kristen Gorman, Tony Williams, William Fraser, <i>Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus Pygoscelis)</i> </a>.<a href="#gorman-ref" aria-label="Back to content">↩</a></li>
    </ol>

    <div>
      <p>Justin Chill &copy; 2025. Thanks&nbsp;for&nbsp;reading!</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" alt="GitHub logo" class="icon">Source code and feedback</a></span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.min.js" integrity="sha512-iBAeBWWWFb8HqSBcrqcz98iIpuVH1la39dEYHtyQ/pGpeCQTQVvLJOWAuhv2Q7JSHp9k7hWA7sGxU3hHJe+tFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/topojson@3.0.2/dist/topojson.min.js"></script>  

  <script>
    var element = d3.select('figure').node();
    var width = element.getBoundingClientRect().width; // get width of article so graphic is responsive
    var size = 12;

    // Use Promises to async request data
    // Todo remove "State laws" from .csv
    var promises = [d3.csv("data/penguins.csv", d3.autoType), d3.json("data/geo/land.json"),];

    myDataPromises = Promise.all(promises);

    // After data is successfully fetched, generate viz
    myDataPromises.then(function(data) {
      // Define the data. There's gotta be a better way to do this:
      var penguins = data[0];
      var land = data[1];

      var scatter = {
        width: width,
        style: {
          fontSize: size
        },
        grid: true,
        nice: true,
        color: {
          legend: true
        },
        marks: [
          Plot.dot(penguins, {
            x: "culmen_length_mm",
            y: "culmen_depth_mm",
            stroke: "species"
          }),
          Plot.density(penguins, {
            x: "culmen_length_mm",
            y: "culmen_depth_mm",
            fill: "species",
            fillOpacity: 0.05
          })
        ]
      };

      var facets = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        grid: true,
        nice: true,
        color: {
          legend: true
        },
        facet: {
          data: penguins,
          x: "species",
          label: null,
        },
        x: {
          nice: true
        },
        marks: [
          Plot.linearRegressionY(penguins, {
            x: "culmen_length_mm",
            y: "body_mass_g",
            stroke: "currentColor",
            ci: .99,
            strokeDasharray: [4, 8],
            strokeOpacity: .25
          }),
          Plot.dot(penguins, {
            x: "culmen_length_mm",
            y: "body_mass_g",
            stroke: "species",
            symbol: "sex",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
              fontSize: size
            },
          }),
        ]
      };

      var density = {
        height: 300,
        width: width,
        style: {
          fontSize: size,
          paddingLeft: 20
        },
        y: {
          axis: null
        },
        x: {
          nice: true,
          label: "Culmen length (mm)"
        },
        fy: {
          domain: ["FEMALE", "MALE"],
          label: null
        }, // excludes N/A
        color: {
          legend: true
        },
        facet: {
          data: penguins,
          y: "sex"
        },
        marks: [
          Plot.areaY(
            penguins,
            Plot.binX({
                y2: "proportion"
              }, // using y2 to avoid areaY’s implicit stacking
              {
                x: "culmen_length_mm",
                fill: "species",
                fillOpacity: 0.1,
                thresholds: 10,
                curve: "natural"
              }
            )
          ),
          Plot.ruleY([0]),
          Plot.lineY(
            penguins,
            Plot.binX({
              y: "proportion"
            }, {
              x: "culmen_length_mm",
              stroke: "species",
              thresholds: 10,
              curve: "natural"
            })
          )
        ]
      }

      var waffle = {
        width: width,
        style: {
          fontSize: size,
          paddingTop: 20
        },
        y: {
          nice: true,
          anchor: "left",
          insetTop: 10
        },
        marks: [
          Plot.waffleY(
            penguins,
            Plot.groupX({
              y: "count"
            }, {
              x: "species",
              fill: "species",
              unit: 8,
              sort: {
                x: "y"
              }
            })
          ),
          Plot.ruleY([0])
        ]
      }
      // https://public.tableau.com/app/profile/unmesh.panigrahy/viz/PenguinsatPalmerStationAntarcticaLTER/Week28

      var regression = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        y: {
          label: "Culmen length (mm)"
        },
        grid: true,
        color: {
          legend: true
        },
        marks: [
          Plot.dot(penguins, {
            x: "culmen_length_mm",
            y: "culmen_depth_mm",
            fill: "species"
          }),
          Plot.linearRegressionY(penguins, {
            x: "culmen_length_mm",
            y: "culmen_depth_mm",
            stroke: "species"
          }),
          Plot.linearRegressionY(penguins, {
            x: "culmen_length_mm",
            y: "culmen_depth_mm"
          })
        ]
      };

      var islands = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },

        symbol: {
          legend: true
        },
        facet: {
          data: penguins,
          x: "island"
        },
        // color: {legend: true}, // Legend is redundant if already covered by symbol legend!

        x: {
          label: "Flipper length (mm)"
        },
        y: {
          label: "Body mass (g)"
        },

        grid: true,
        marks: [
          Plot.dot(penguins, {
            x: "flipper_length_mm",
            y: "body_mass_g",
            fill: "species",
            symbol: "species",
            opacity: 0.7,
            r: 4
          })
        ],
      };

      var weightBars = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        color: {
          legend: true,
        },
        x: {
          label: "Penguin body mass (grams)"
        },
        y: {
          label: "Count"
        },
        marks: [
          Plot.rectY(penguins,
            Plot.binX({
              y: "count"
            }, {
              x: "body_mass_g",
              thresholds: 30, // Updates bin number for histogram
              fill: "species"
            }))
        ]
      };

      // Adapting map from https://observablehq.com/d/8b4d860e5c277bf3
      var projection = ({width, height}) => d3.geoAzimuthalEquidistant()
          .rotate([0, 90])
          .translate([width / 2, height / 2])
          .scale(width)
          .clipAngle(40);
      var locations = [
        {
          name: "Palmer Research Station",
          lat:  -64.7700000,
          lon:  -64.0500000,
          comment:
            "The Palmer Research Station is where the below penguin study took place.",
          dx: -80,
          dy: -20
        },
  {
    name: "Great Wall Station",
    lat: -62.21667,
    lon: -58.96444,
    comment:
      "The Great Wall Station is the \nfirst Chinese research station \nin Antarctica and opened on \n20 February 1985.",
    dx: -80,
    dy: -20
  },
  {
    name: "Zhongshan Station",
    lat: -69.37333,
    lon: 76.37778,
    comment: "Zhongshan Station is the second \nChinese research station in Antarctica \n nd was opened on February 26, 1989.",
    dx: 170,
    dy: -80
  },
  {
    name: "Kunlun Station",
    lat: -80.25,
    lon: 77,
    comment: "Kunlun Station is the southernmost \nof four Chinese research stations \nin Antarctica. ",
    dx: -50,
    dy: -130
  },
  {
    name: "Taishan Station",
    lat: -73.85,
    lon: 76.9667,
    comment: "Taishan station serve as a \nrelay point between Kunlun \nstation and Zhongshan station.",
    dx: 150,
    dy: 150
  },
  {
    name: "Ross Sea Station",
    lat: -74.91667,
    lon: 163.7,
    comment: "The Ross Sea Station is China's \nfifth Antarctic research station, \nexpected to be completed in 2024.",
    dx: -150,
    dy: 50
  }
];
      var d3_annotation = d3.annotation();

      // Takes an SVG and using d3 + d3-annotation adds an annotation to the svg
      function doAnnotation(targetSVG, annotation, annotationType, textWrap = 120) {
        const makeAnnotations = d3_annotation
          .editMode(false)
          .notePadding(4)
          .type(annotationType ?? d3_annotation.annotationLabel)
          .annotations([annotation]);

        const renderAnnotation = () => {
          const svg = d3.select(targetSVG).append("svg");
          svg.attr(
            "style",
            "font: initial;text-anchor: initial; fill: red; font-family: Arial; font-size: 15px;"
          );
          svg.call(makeAnnotations);
        };

        // need to wait a tick for the dom to be rendered
        window.requestAnimationFrame(renderAnnotation);
      };

      var map = {
        width: width,
        projection: projection,
        height: 550,
        inset: 2,
        marks: [
          Plot.sphere({
            fill: "#F5FBFF",
            stroke: "#222",
            strokeWidth: 0.2
          }),
          Plot.graticule({ opacity: 0.8 }),
          Plot.geo(land, { fill: "#fffffe", stroke: "#222", strokeWidth: 0.5 }),

          Plot.dot(locations, {
            x: "lon",
            y: "lat",
            r: 10,
            fill: "#DA70D6",
            fillOpacity: 0.6,
            stroke: "#222",
            strokeWidth: 1,
            tip: true,
            title: "comment"
          }),
          Plot.text(locations, Plot.selectFirst({
            x: "lon",
            y: "lat",
            dx: 12,
            dy: 12,
            text: "name",
            fill: "#222",
            stroke: "white",
            fillOpacity: 0.9,
            fontSize: size*1.2,
            frameAnchor: "middle",
          })),
          Plot.text(locations, {
            filter: d => d.name != "Palmer Research Station" && d.name != "Zhongshan Station",
            x: "lon",
            y: "lat",
            dy: 12,
            dx: 5,
            text: "name",
            fill: "#222",
            stroke: "white",
            fillOpacity: 0.95,
            fontSize: size*1.2,
            frameAnchor: "top",
          }),
          Plot.text(locations, {
            filter: d => d.name == "Zhongshan Station",
            x: "lon",
            y: "lat",
            dy: -12,
            // dx: 2,
            text: "name",
            fill: "#222",
            stroke: "white",
            fillOpacity: 0.95,
            fontSize: size*1.2,
            frameAnchor: "bottom",
          }),
          // Plot.arrow(locations, Plot.selectFirst({
          //   x1: "lon",
          //   y1: "lat",
          //   y2: "lon",
          //   // y2: d => d.lat+20,
          //   bend: true,
          //   stroke: "red",
          //   strokeWidth: 2,
          // })),
        ]
      };

      // Nice scatter plot to recreate: https://observablehq.com/d/7e3742f5f8e13db9

      document.getElementById("scatter").appendChild(Plot.plot(scatter));
      document.getElementById("facets").appendChild(Plot.plot(facets));
      document.getElementById("waffle").appendChild(Plot.plot(waffle));
      document.getElementById("density").appendChild(Plot.plot(density));
      document.getElementById("regression").appendChild(Plot.plot(regression));
      document.getElementById("islands").appendChild(Plot.plot(islands));
      document.getElementById("weightBars").appendChild(Plot.plot(weightBars));
      document.getElementById("map").appendChild(Plot.plot(map));
    });
  </script>
</body>

</html>