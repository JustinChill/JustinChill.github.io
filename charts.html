<!DOCTYPE html>
<html lang="en">
<head>
  <title>Charts</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css" />
  <script async src="script.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Charts and data">
  <meta name="author" content="Justin Chill">

  <style type="text/css">

    .plot text {
      color: #656568;
    }

    ul > li {
      position: relative;
      padding-left: 1em;
      list-style: none;
      text-align: left;
    }
    .alignLeft{
      text-align: left;
    }
    ol {
      padding-left: 1em;
    }
    ul > li:before{
      content: "";
      position: absolute;
      background-color: #cbd5e0;
      border-radius: 50%;
      width: .375em;
      height: .375em;
      top: .6875em;
      left: 0em;
    }
    article > h2{
      margin-top: 3rem;
    }
    article > h3{
      padding-top: 0;
      padding-bottom: .3em;
      margin-top: 1em;
      display: flex;
      align-items: center;
    }
    .logogrid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap:  2rem;
      justify-content: center;
      min-height: 360px;
      margin-bottom: 1rem;
    }
    .logogrid__item {
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: 50px;
    }
    .logogrid__img {
      -o-object-fit: cover;
      object-fit: cover;
      /*max-width: 120px;*/
      filter: grayscale(0) contrast(100%);
      transition: filter 0.25s ease;
    }
    .logogrid__img:hover {
      filter: grayscale(100%) contrast(50%);
    }
    article > p + h3{
      margin-top: 2rem;
    }

    article > figure{
      margin: 0 auto;
    }
    .wrapper {
      overflow: auto;
      padding: 0;
      margin: 0;
    }
    article > figcaption{
      margin: 1rem 0;
      text-align: right;
    }

    #civilizations [class*="-swatches-wrap"] span{
      font-size: 1rem;
    }

    @media screen and (max-width: 680px) {
      article > h2{
        margin-top: 1.2rem;
      }
      article > h3{
        margin-left: 0;
        margin-right: 0;
      }
      .plot text {
        /*font-size: calc(6px + (22 - 16) * ((100vw - 320px) / (1300 - 320)));*/
        padding: 1rem;
      }
      article > figure {
        grid-column: 2/7;
        margin: 0;
      }
      article > figcaption{
        grid-column: 2/7;
      }
      .logogrid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
      }
    }

    @media screen and (max-width: 1024px){
      article > h2{
        margin-top: 2rem;
      }
      .logogrid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
      }
    }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav__list">
      <a href="index.html" class="nav__item">Home</a>
      <a href="blog.html" class="nav__item">Blog</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>

      <section class="logogrid">
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-1.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-2.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-3.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-4.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-5.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-6.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-7.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-8.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-9.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-10.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-11.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-12.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-13.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-14.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-15.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-16.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-17.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-18.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-19.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-20.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-21.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-22.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-23.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-24.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-26.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-27.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-28.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-29.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-30.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-31.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-32.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-33.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-34.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-35.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-36.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-4.svg" class="logogrid__img" alt="Illustration of a graph"></div>
      </section>

      <div class="article-hero">
        <h2 class="article-category">Post</h2>
        <h1 class="article-title">Common charts and graphs</h1>
        <h2 class="article-subtitle"></h2>
      </div>

      <p>Presenting data in the form of a chart or graph makes identifying patterns and understanding difficult concepts easier. Visualizations of data can bring out insights to someone looking at the data for the first time, as well as convey findings to others who won’t see, or take the time to parse, the raw data.</p>

      <p>Deciding on which chart is best for your data will depend on multiple factors, such as:</p>

      <ul>
        <li><p>What are the types of metrics, features, or other variables that you plan on plotting? </p></li>
        <li><p>Who is the audience that you plan on presenting to – is it just an initial exploration for yourself, or are you presenting to a broader audience?</p></li>
        <li><p>What is the kind of conclusion that you want the reader to draw?</p></li>
      </ul>

      <p>In this article, we’ll look at frequently used charts and graphs to help you make the best choice for presenting your data.</p>

      <h2>Alluvial diagram</h2>
      <img src="imgs/Asylum_seekers.png" loading="lazy">
      <figcaption>Source: <a href="https://www.economist.com/graphic-detail/2015/05/12/seeking-safety">The Economist</a></figcaption>
      <p>The alluvial diagram is useful for showing changes over time across categories. Each group of stacked bars represents a variable while the size of each segment represents how many observations in the dataset belong to that segment. The colored flows between the bars represent a group of observations between each variable of the flow. The thickness of the flow indicates how many observations belong to that group. In the example above, countries are represented by each bar and the flow tracks refugees as they change countries. Alluvial diagrams are named after <a href="https://en.wikipedia.org/wiki/Alluvial_fan">alluvial fans</a>.</p>
      
      <h2>Area chart</h2>
      <h3>Apple Inc. (<small>AAPL</small>) Closing Stock Price</h3>
      <figure id="apple_area"></figure>
      <figcaption>Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      <p>An area chart, or area graph, is a variation on a basic line graph in which the area underneath the line is shaded to represent the total value of each data point. When several data series must be compared on the same graph, stacked area charts are used.</p>
      <p>This method of data visualization is useful for showing changes in one or more quantities over time, as well as showing how each quantity combines to make up the whole. Stacked area charts are effective in showing part-to-whole comparisons.</p>
      <h3>World electricity production, by source</h3>
      <figure id="electricity"></figure>
      <figcaption class="alignLeft">Data: <a href="https://ourworldindata.org/electricity-mix">Our World in Data</a></figcaption>
      <p>A stacked area chart stacks values so that the cumulative area represents 100%. These charts can help to show a progression and composition over time, and the 100% stacked area chart is meant to show the percentage that each component contributes when the cumulative total is not important.</p>
      <h2>Barplot</h2>
      <h3>English letter frequency</h3>
      <figure id="freq_letters"></figure>
      <figcaption>Data: <a href="http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html">Cornell</a></figcaption>
      <p>The classic bar chart, or bar graph, is another common and easy-to-use method of data visualization. In this type of visualization, one axis of the chart shows the categories being compared, and the other, a measured value. The length of the bar indicates how each group measures according to the value. The baseline usually starts at zero.</p>
      <h3>Global Emissions by Country</h3>
      <figure id="country_emissions"></figure>
      <figcaption>Data: <a href="https://www.iea.org/articles/global-energy-review-co2-emissions-in-2020">IEA</a></figcaption>
      <p>A variation on the regular vertical bar chart is the horizontal bar chart. This orientation is more useful for comparing categories.</p>
      <h2>Barcode chart</h2>
      <h3>Surface temperature anomalies</h3>
      <figure id="anomaly_barcode"></figure>
      <figcaption>Data: <a href="https://ourworldindata.org/grapher/hadcrut-surface-temperature-anomaly?tab=table">Our World in Data</a></figcaption>
      <p>A compact way to show a distribution. In a barcode chart, line segments represent individual data points along a single axis.</p>
      <h2>Baseline chart</h2>
      <h3>Stock Price Comparison</h3>
      <figure id="stocks_baseline"></figure>
      <figcaption>Market Data: <a href="https://www.wsj.com/market-data">Wall Street Journal</a></figcaption>
      <p>A baseline chart uses a reference point, which becomes the baseline, to compare all the other categories to. In business, the success of a project or product is often measured against a <strong>baseline</strong> number for costs, sales, or other variables. A project may exceed a baseline number or fail to meet it.</p>
      <h2>Beeswarm </h2>
      <figure id="beeswarm"></figure>
      <!-- <img src="https://flowingdata.com/wp-content/uploads/2021/06/hospital-billing-1536x1127.png" loading="lazy"> -->
      <p>Beeswarm plots are a fun, visually pleasing alternative to histograms that can be used when data is sufficiently small and you want to plot every point. A beeswarm chart is a one-dimensional chart that shows all the information on a single-axis (usually the X axis). It is similar to a strip plot, except that would-be overlapping points are separated such that each is visible. </p>
      <h2>Box and Whisker Plot</h2>
      <h3>Michaelson-Morley Speed of Light Data</h3>
      <figure id="morley"></figure>
      <figcaption>Data: <a href="http://stats4stem.weebly.com/r-morley-data.html">Morley dataset</a></figcaption>
      <p>A box and whisker plot, or box plot, provides a visual summary of data through its quartiles. A box plot is constructed from five values: the minimum value, the first quartile, the median, the third quartile, and the maximum value. We use these values to compare how close other data values are to them.</p>
      <p> First, a box is drawn from the first quartile to the third of the data set. A line within the box represents the median. “Whiskers,” or lines, are then drawn extending from the box to the minimum (lower extreme) and maximum (upper extreme). Outliers are represented by individual points that are in-line with the whiskers.</p>
      <p>This type of chart is helpful in quickly identifying whether or not the data is symmetrical or skewed, as well as providing a visual summary of the data set that can be easily interpreted.</p>
      <h2>Bubble chart</h2>
      <h3>Health and Wealth of Nations, 2007</h3>
      <figure id="gapminder"></figure>
      <figcaption>Data: <a href="https://www.gapminder.org/data/">GapMinder Foundation</a></figcaption>
      <p>A bubble chart is a variation of a scatter chart in which the data points are replaced with bubbles, and an additional dimension of the data is represented in the size of the bubbles. Just like a scatter chart, a bubble chart does not use a category axis — both horizontal and vertical axes are value axes. In addition to the x values and y values that are plotted in a scatter chart, a bubble chart also z (size) values.</p>
      <h2>Bullet chart</h2>
      <h3>Proportion of COVID-19 cases vs. share of population, by race</h3>
      <figure id="bullet"></figure>
      <figcaption>Data: <a href="https://covidtracking.com/race">The COVID Racial Data Tracker</a></figcaption>
      <p>A bullet graph is a variation of a bar graph that can act as an alternative to dashboard gauges to represent performance data. The main use for a bullet graph is to inform the viewer of how a business is performing in comparison to benchmarks that are in place for key business metrics.</p>
      <p>In a bullet graph, the darker horizontal bar in the middle of the chart represents the actual value, while the vertical line represents a comparative value, or target. If the horizontal bar passes the vertical line, the target for that metric has been surpassed. Additionally, the segmented colored sections behind the horizontal bar represent range scores, such as “poor,” “fair,” or “good.”</p>
      <h2>Bump chart</h2>
      <h3>Changes in state population, 1920 - 2020</h3>
      <img src="https://flowingdata.com/wp-content/uploads/2021/05/population-shift-1536x1084.png" loading="lazy">
      <figcaption>Image: <a href="https://www.washingtonpost.com/nation/interactive/2021/census-population-changes/">Washington Post</a></figcaption>
      <p>A bump chart is a chart that helps you identify the change in the performance rankings over time rather than the magnitude of the values of the elements (categories).</p>
      <h2>Cartogram</h2>
      <h3>Who can vote by mail?</h3>
      <img src="https://flowingdata.com/wp-content/uploads/2020/08/Cartogram-to-show-vote-by-mail-1536x1235.png" loading="lazy">
      <figcaption>Image: <a href="https://www.nytimes.com/interactive/2020/08/11/us/politics/vote-by-mail-us-states.html">New York Times</a></figcaption>
      <p>Cartograms distort the shape of geographic regions so that the area directly encodes a data variable. A common example is to redraw every country in the world sizing it proportionally to population or GDP. Can be done by circles, squares or distorted maps by manipulating the initial map.</p>
      <h2>Candlestick Chart</h2>
      <h3>Apple Inc. (AAPL) Stock Price</h3>
      <figure id="candlestick"></figure>
      <figcaption>Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      <p>A candlestick chart is a style of bar chart used to describe price movements of a security, derivative, or currency for a designated span of time. Each bar represents the range of price movement over a given time interval. The dataset for a candlestick chart contains low, high, open and close values. The high and low values are visualized as the top and bottom of each stick, where the open and close values are reflected in the square inside.</p>
      <h2>Chord diagram</h2>
      <a href="https://lotr.visualcinnamon.com/"><img src="https://uploads-ssl.webflow.com/5fa9d88da1855554db37b1e1/5fb1377b21d82ea1d953ef91_lotr_final.png" loading="lazy"></a>
      <figcaption>Created by <a href="https://lotr.visualcinnamon.com">Nadieh Bremer</a></figcaption>
      <p>This type of diagram visualizes the inter-relationships between entities. The connections between entities are used to display that they share something in common. This makes Chord Diagrams ideal for comparing the similarities within a dataset or between different groups of data.</p>
      <h2>Choropleth map</h2>
      <img src="imgs/ZIP3_zones.svg" loading="lazy">
      <figcaption>ZIP codes explained <a href="inf-hoe-graphic.html">here</a></figcaption>
      <p>A choropleth map is simply a shaded map. Specifically, it's a map that uses measured differences in shading or color or the placing of symbols inside defined areas on the map in order to indicate the average values of some property or quantity in those areas. Be careful with your color choices, as they can quickly change what the map shows.</p>
      <h2>Connected scatter plot</h2>
      <h3>Driving shifts into reverse</h3>
      <figure id="driving_line"></figure>
      <figcaption class="">Data: <a href="http://www.nytimes.com/imagepages/2010/05/02/business/02metrics.html">New York Times</a></figcaption>
      <p>Until recently, Americans have driven more each year than the previous one, with a few brief exceptions. In 1956, Americans of driving age drove about 4,000 miles a year, on average. Fifty years later, that figure had climbed above 10,000. A cross between a scatterplot and a time series, the connected scatter plot  . Show two variables over time.</p>
      <h2>Density plot</h2>
      <h3>Unemployment by industry</h3>
      <figure id="bls_line"></figure>
      <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      <p>A density plot visualizes the distribution of data over a continuous interval or time period. This chart is a variation of a histogram that uses kernel smoothing to plot values, allowing for smoother distributions by smoothing out the noise. The peaks of a density plot help display where values are concentrated over the interval.</p>
      <h3>Diverging bar chart</h3>
      <figure id="diverging"></figure>
      <figcaption>Data: <a href="https://www.census.gov/data/tables/time-series/demo/popest/2010s-state-total.html">Census.gov</a></figcaption>
      <p>A diverging bar chart is a bar chart that has the marks for some dimension members pointing up or right, and the marks for other dimension members pointing in the opposite direction (down or left, respectively). What’s unique about a diverging bar chart is the marks flowing down or left do not necessarily represent negative values. The divergent line can represent zero, but it can also be used to simply separate the marks for two dimension members, to represent a goal, or – as often seen with survey data – to show the break between desired and undesired responses.</p>
      <p>A drawback to using diverging bar charts is that it’s not as easy to compare the values across dimension members as it is with a grouped bar chart. If, on the other hand, your primary objective is to compare the trend of each individual dimension member, a divergent bar chart is a good option.</p>
      <h3>Difference chart</h3>
      <figure id="difference"></figure>
      <figcaption>Data: NOAA</figcaption>
      <p> A difference chart highlights the difference between two values, typically entries vs exits. The amount is encoded as height, and the sign (surplus vs. deficit) as a solid color. In the chart above, we compare the temperatures on the same day; days when San Francisco was warmer are <span style="border-bottom: 2px solid orange;">orange</span>, and colder days are <span style="border-bottom: 2px solid steelblue;">blue</span>.</p>
      <h2>Donut chart 🍩</h2>
      <!-- TODO -->
      <h3>United States Population, 2015</h3>
      <img src="imgs/donut_chart.svg" loading="lazy">
      <figcaption>Data: <a href="https://www.census.gov/data.html">U.S. Census</a></figcaption>
      <p>A donut chart is a pie chart with an area of the center cut out. It looks like a donut. That’s why it’s called a donut chart.</p>
      <p>Pie Charts are sometimes criticized for focusing readers on the proportional areas of the slices to one another and to the chart as a whole. This makes it tricky to see the differences between slices, especially when you try to compare multiple Pie Charts together. A Donut Chart somewhat remedies this problem by de-emphasizing the use of the area. Instead, readers focus more on reading the length of the arcs, rather than comparing the proportions between slices.</p>
      <h2>Dot density map</h2>
      <!-- <img src="https://flowingdata.com/wp-content/themes/fd-modern-5-9/images/chart-types/dot-density-map.png" loading="lazy"> -->
      <figure id="dotdensity"></figure>
      <figcaption>Data: <a href="Walmart.html">Walmart stores</a></figcaption>
      <p>The density mark shows the estimated density of two-dimensional point clouds. Contours guide the eye towards the local peaks of concentration of the data, much like a topographic map does with elevation. This is especially useful given overplotting in dense datasets, like the above map of Walmart locations in the USA.</p>
      <h2>Dot map</h2>
      <!-- <img src="https://flowingdata.com/wp-content/themes/fd-modern-5-9/images/chart-types/dot-map.png" loading="lazy"> -->
      <h3>World airports</h3>
      <figure id="dotmap"></figure>
      <figcaption>Data: <a href="https://observablehq.com/@d3/world-airports">World airports</a></figcaption>
      <p>Dot Maps are a way of detecting spatial patterns or the distribution of data over a geographical region, by placing equally sized points over a geographical region.</p>
      <h2>Dot plot</h2>    
      <h3>Surface temperature anomalies</h3>
      <figure id="anomaly_dot"></figure>
      <figcaption>Data: <a href="https://ourworldindata.org/grapher/hadcrut-surface-temperature-anomaly?tab=table">Our World in Data</a></figcaption>
      <p>A generalized form of the scatter plot, the dots can be placed in various coordinate systems on an x- and y-axis. A dot plot is similar to a histogram in that it displays the number of data points that fall into each category or value on the axis, thus showing the distribution of a set of data.</p>
      <h2>Frequency trails</h2>
      <h3>Google search trends, 2020</h3>
      <figure id="google_ridgeline"></figure>
      <figcaption>Data: <a href="https://trends.google.com/trends/?geo=US">Google</a></figcaption>
      <!-- <img src="https://flowingdata.com/wp-content/uploads/2019/12/Interactive-frequency-trails.png"> -->
      <p>Area or line chart value axes overlap to fit more in a space and add another visual aspect to the magnitude of peaks. Also known as a ridgeline chart or a joyplot.</p>
      <h2>Gantt chart</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/SVG/gantt_chart.svg" loading="lazy">
      <p>Commonly used as an organizational tool for project management, Gantt Charts display a list of activities (or tasks) with their duration over time, showing when each activity starts and ends. This makes Gantt Charts useful for planning and estimating how long an entire project might take. You can also see what activities are running in parallel to each other.</p>
      <p>Gantt charts are particularly common in project management, as they’re useful in illustrating a project timeline or progression of tasks. In this type of chart, tasks to be performed are listed on the vertical axis and time intervals on the horizontal axis. Horizontal bars in the body of the chart represent the duration of each activity.</p>
      <p>Utilizing Gantt charts to display timelines can be incredibly helpful, and enable team members to keep track of every aspect of a project. Even if you’re not a project management professional, familiarizing yourself with Gantt charts can help you stay organized.</p>
      <h2>Glyph chart</h2>
      <figure id="animals"></figure>
      <figcaption>Data: The zoo</figcaption>
      <!-- <img src="https://visme.co/blog/wp-content/uploads/2017/05/How-to-Create-Pictographs-and-Icon-Arrays-in-Visme-4.jpg"> -->
      <p>Glyph charts are a common form of visual design where a data set is depicted by a collection of visual objects referred to as <em>glyphs</em>. The design of glyphs can make use of many different visual channels such as shape, colour, texture, size, orientation, aspect ratio or curvature<a href="#glyph" aria-describedby="footnote-label" id="glyph-ref"></a>. This enables the depiction of multi-dimensional data attributes, such as time series data. Meanwhile, glyphs are normally recognisable individually, offering a means of visual fusion in multi-field visualization. 🤓</p>
      <h2>Grid map</h2>
      <h3>Percent change in population from 2010 to 2019</h3>
      <figure id="gridmap"></figure>
      <!-- <img src="imgs/gridmap.png" loading="lazy"> -->
      <figcaption></figcaption> <!-- Recreation: https://observablehq.com/@zanarmstrong/us-grid-map-and-observable-plot -->
      <p>Instead of using geographic boundaries, same-size cells are used to represent areas to provide equal visual attention to all.</p>
      <h2>Heatmap</h2>
      <figure id="popcorn"></figure>
      <figcaption>Source: <a href="popcorn.html">Steph Curry, NYT</a></figcaption>
      <p>Heatmaps visualize data through variations in coloring. When used in a tabular format, heatmaps are useful for cross-examining multivariate data, through placing variables in the rows and columns and coloring the cells within the table. Heatmaps are good for showing variance across multiple variables, revealing any patterns, displaying whether any variables are similar to each other, and for detecting if any correlations exist in-between them.</p>
      <p>There are many possible applications of heat maps. For example, if you want to analyze which time of day a retail store makes the most sales, you can use a heat map that shows the day of the week on the vertical axis and time of day on the horizontal axis. Then, by shading in the matrix with colors that correspond to the number of sales at each time of day, you can identify trends in the data that allow you to determine the exact times your store experiences the most sales. Or you can visualize popcorn quality by NBA arena.</p>
      <h2>Histogram</h2>
      <h3>Apple Inc. (AAPL) Trading Volume</h3>
      <figure id="example_histogram"></figure>
      <figcaption class="alignLeft">Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      <p>A histogram looks like a bar chart, but it reads differently. The baseline is continuous instead of discrete categories, which allows one to see distributions. Histograms help give an estimate as to where values are concentrated, what the extremes are and whether there are any gaps or unusual values. They are also useful for giving a rough view of the probability distribution.</p>
      <p>Histograms are especially useful for showing the frequency of a particular occurrence. For instance, if you’d like to show how many clicks your website received each day over the last week, you can use a histogram. From this visualization, you can quickly determine which days your website saw the greatest and fewest number of clicks.</p>
      <h2>Horizon graph</h2>
      <figure id="horizon_chart"></figure>
      <figcaption>Data: <a href="https://observablehq.com/@observablehq/plot-unemployment-horizon-chart">Bureau of Labor Statistics</a></figcaption>
      <!-- <img src="https://flowingdata.com/wp-content/uploads/2015/06/cost-horizon-reversed.png" loading="lazy"> -->
      <p>A horizon chart is like a combination area chart and heatmap. Shrink the area chart by slicing it horizontally, and then shift the slices to a baseline of zero.</p>
      <h2>Line chart</h2>
      <h3>My excitement levels as my girlfriend says...</h3>
      <figure id="example_line"></figure>
      <p>Typically used to show trends over time, the slope of the line between two points shows patterns of change. Line Graphs are drawn by first plotting data points on a Cartesian coordinate grid, then connecting a line between all of these points. Typically, the y-axis has a quantitative value, while the x-axis is a timescale or a sequence of intervals. Negative values can be displayed below the x-axis.</p>

      <p>The direction of the lines on the graph works as a nice metaphor for the data: an upward slope indicates where values have increased and a downward slope indicates where values have decreased. The line's journey across the graph can create patterns that reveal trends in a dataset.

      When grouped with other lines (other data series), individual lines can be compared to one another. However, avoid using more than 3-4 lines per graph, as this makes the chart more cluttered and harder to read. A solution to this is to divide the chart into smaller multiples (have a small Line Graph for each data series).</p>
      <h2>Mosaic plot</h2>
      <figure id="mosaic"></figure>
      <figcaption>Data: <a href="https://observablehq.com/@observablehq/plot-marimekko">Fictional sales</a></figcaption>
      <p>Also known as a Marimekko diagram, this chart uses the width and height of rectangles to represent separate variables. It can be useful to represent multidimensional data. The main flaws of Marimekko charts are that they can be hard to read, especially when there are many segments. Also, it's hard to accurately make comparisons between each segment, as they are not all arranged next to each other along a common baseline. Therefore, Marimekko charts are better suited for giving a more general overview of the data.
      </p>
      <h2>Network graph</h2>
      <h3>The complete ARPANET, December 1969</h3>
      <figure id="network"></figure>
      <figcaption>Data: <a href="http://mercury.lcs.mit.edu/~jnc/tech/arpageo.html">MIT</a></figcaption>
      <p>This type of visualization shows how things are interconnected through the use of nodes and link lines. Typically, nodes are drawn as dots or circles, but icons can also be used. Links are usually displayed as lines connecting nodes. However, in more elaborate network diagrams, not all of the nodes and links are created equally: additional variables can be shown by making the node size or link stroke weight proportional to an assigned value.</p>
      <p>There are many use cases for network diagrams, including depicting social networks, highlighting the relationships between employees at an organization, or visualizing product sales across geographic regions.</p>    
      <h2>Organogram</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/tree_diagram.png" loading="lazy">
      <p>An organogram is an organizational chart that shows the structure of an organization and the relationships and relative ranks of its parts and positions/jobs. A variation is a tree diagram, which shows the different elements of a field of knowledge or a group of languages.</p>
      <h2>Packed bubble chart</h2>
      <img src="https://flowingdata.com/wp-content/uploads/2020/12/Defining-essential-worker-1536x1476.png" loading="lazy">
      <figcaption>Data: <a href="https://www.nytimes.com/2020/12/05/health/covid-vaccine-first.html">New York Times</a></figcaption>
      <p>Circle size represents data like with a bubble chart, but there is typically no x-y axis. Instead, bubble position often represents grouping or is used to maximize space.</p>
      <h2>Parallel coordinates</h2>
      <h3>Cars from the 70s & 80s</h3>
      <img src="https://datavizcatalogue.com/methods/images/top_images/SVG/parallel_coordinates.svg" loading="lazy">
      <p>Parallel Coordinates Plots are ideal for comparing many variables together and seeing the relationships between them. In the above example, models of cars produced in the 1970s and '80s are compared across multiple variables. Chris Evans created a <a href="http://www.columbia.edu/~cme2126/datavisuals/bigdata_parallelcoordinates.html">more elaborate example</a> using the same data set.</p>
      <p>In a parallel coordinates plot, each variable is given its own axis and all the axes are placed in parallel to each other. Each axis can have a different scale, as each variable works off a different unit of measurement, or all the axes can be normalized to keep all the scales uniform. Values are plotted as a series of lines that connected across all the axes. This means that each line is a collection of points placed on each axis, that have all been connected together.</p>
      <h2>Parallel sets</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/parallel_sets.png" loading="lazy">
      <p>Parallel Set charts are similar to Sankey Diagrams in the way they show flow and proportions. However, Parallel Sets don’t use arrows and they divide the flow-path at each displayed line-set. Each line-set corresponds to a dimension/dataset, which its values/categories are represented in each line divide in that line-set. The width of each line and the flow-path that stems from it is determined by the proportional fraction of the category total. Each flow-path can be colored to show and compare the distribution between different categories.</p>
      <h2>Percentogram</h2>
      <figure id="percentogram"></figure>
      <figcaption>Data: <a href="https://statmodeling.stat.columbia.edu/2023/04/13/the-percentogram-a-histogram-binned-by-percentages-of-the-cumulative-distribution-rather-than-using-fixed-bin-widths/">Andrew Gelman</a></figcaption>
      <p>The “<a href="https://statmodeling.stat.columbia.edu/2023/04/13/the-percentogram-a-histogram-binned-by-percentages-of-the-cumulative-distribution-rather-than-using-fixed-bin-widths/">percentogram</a>” is a histogram binned by percentages of the cumulative distribution, rather than using fixed bin widths. Put simply, it is like a histogram or density plot in that is shows the overall shape of the distribution, where each bar is made to have the same area and to specifically represent a chosen percentage. A percentogram makes it easy to assess how much of a distribution is falling in particular ranges.</p>
      <h2>Pictogram</h2>
      <h3>Phish set list, NYE 2019</h3>
      <img src="imgs/phish.svg" loading="lazy">
      <figcaption>Data: <a href="https://observablehq.com/@mayagans/day-2-pictograms">Maya Gans</a></figcaption>
      <p>Pictogram, or pictograph, charts use icons to give a more engaging overall view of small sets of discrete data. Typically, the icons represent the data’s subject or category, for example, data on population would use icons of people. Each icon can represent one unit or any number of units (e.g. each icon represents 10). Data sets are compared side-by-side in either columns or rows of icons, to compare each category to one another.</p>
      <p>Pictogram charts are particularly useful for presenting simple data in a more visual and engaging way. These charts use icons to visualize data, with each icon representing a different value or category. For example, data about time might be represented by icons of clocks or watches. Each icon can correspond to either a single unit or a set number of units (for example, each icon represents 100 units).</p>
      <h2>Pie chart</h2>
      <h3>United States population, 2015</h3>
      <img src="imgs/pie_chart.svg" loading="lazy">
      <figcaption>Data: <a href="https://www.census.gov/data.html">U.S. Census</a></figcaption>
      <p>Pie charts are one of the most common and basic data visualization techniques, used across a wide range of applications. Pie charts are ideal for illustrating proportions, or part-to-whole comparisons.</p>
      <p>Pie Charts help show proportions and percentages between categories, by dividing a circle into proportional segments. Each arc length represents a proportion of each category, while the full circle represents the total sum of all the data, equal to 100%.</p>
      <p>Because pie charts are relatively simple and easy to read, they’re best suited for audiences who might be unfamiliar with the information or are only interested in the key takeaways. For viewers who require a more thorough explanation of the data, pie charts fall short in their ability to display complex information.</p>
      <h2>Proportion Plot</h2>
      <figure id="proportion_plot"></figure>
      <figcaption>Data: <a href="https://stephanieevergreen.com/proportion-plots/">Stephanie Evergreen</a></figcaption>
      <p>Pioneered by Stephanie Evergreen, proportion plots are useful to highlight differences between the share of a population across two metrics. Here we follow Richard Speigal’s <a href="https://www.linkedin.com/feed/update/urn:li:activity:6758306750174138368/">“Who owns Britain?</a>” chart, highlighting age class inequalities in Britain. Data: U.K. Office for National Statistics.</p>
      <h2>Pyramid chart</h2>
      <h3>Population of Qatar, 2019</h3>
      <figure id="qatar_pyramid"></figure>
      <figcaption>Data: <a href="https://population.un.org/wpp/Download/Standard/Population/">World Population Prospects, U.N., 2019</a></figcaption>
      <p>A Population Pyramid chart is a pair of back-to-back Histograms (for each sex) that displays the distribution of a population in all age groups and in both sexes. The X-axis is used to plot population numbers and the Y-axis lists all age groups.</p>
      <h2>Radar chart</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/radar_chart.png" loading="lazy">
      <p>Radar charts, also known as as spider chart, web chart, polar chart, or star plots, are a way of comparing multiple quantitative variables. This makes them useful for seeing which variables have similar values or if there are any outliers among each variable. Radar Charts are also useful for seeing which variables are scoring high or low within a dataset, making them ideal for displaying performance.</p>
      <h2>Sankey diagram</h2>
      <img src="https://flowingdata.com/wp-content/uploads/2018/03/Black-boys-dropping-income-levels-1090x582.png" loading="lazy">
      <figcaption>Data: <a href="https://www.nytimes.com/interactive/2018/03/19/upshot/race-class-white-and-black-men.html">New York Times</a></figcaption>
      <p>Sankey Diagrams display flows and their quantities in proportion to one another. Typically used to show the transfer of energy, money or materials, but they can be used to show the flow of any isolated process in a system. The width of the arrows or lines are used to show their magnitudes, so the bigger the arrow, the larger the quantity of flow. Flow arrows or lines can combine together or split through their paths on each stage of a process. Colour can be used to divide the diagram into different categories or to show the transition from one state of the process to another.</p>
      <h2>Scatter plot</h2>    
      <h3>The relative harm of drugs</h3>
      <figure id="drug_scatter"></figure>
      <figcaption class="alignLeft">Data: David Nutt for <a href="https://www.drugscience.org.uk">Drug Science</a></figcaption>
      <p>Also known as a scatter graph, point graph, X-Y plot, scatter chart or scattergram. A scatter plot displays data for two variables as represented by points plotted against the horizontal and vertical axis. This type of data visualization is useful in illustrating the relationships that exist between variables and can be used to identify trends or correlations in data.</p>
      <p>Scatter plots are most effective for fairly large data sets, since it’s often easier to identify trends when there are more data points present. Additionally, the closer the data points are grouped together, the stronger the correlation or trend tends to be.</p>
      <h2>Slope chart</h2>
      <h3>Change in total estimated annual energy production by energy source in California from 2009 to 2019</h3>
      <figure id="slope"></figure>
      <figcaption>Data: <a href="https://www.eia.gov/state/seds/">State Energy Data System (SEDS), US Energy Administration</a></figcaption>
      <p>Also known as a <i>slopegraph</i>, this type of chart shows change in rank between two (or a few) discrete points in time. Typically used to compare changes over time for a list of nouns (e.g. countries) located on an ordinal or interval scale (e.g. GDP). Credited to <a href="https://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003nk">Edward Tufte</a>.</p>
      <h2>Small multiples</h2>
      <h3>Comparing MPG by vehicle type</h3>
      <figure id="mpg"></figure>
      <figcaption class="alignLeft">Data: <a href="https://ggplot2.tidyverse.org/reference/mpg.html">ggplot2 Fuel Economy Data</a></figcaption>
      <!-- <img src="https://nuitrcs.github.io/intro_to_viz_workshop/files/2context.png"> -->
      <p>Small multiples use the same basic graphic or chart to display different slices of a data set. Small multiples can show rich, multi-dimensional data without trying to cram all that information into a single, overly-complex chart. Small multiples go by many names, including Trellis Chart, Lattice Chart, Grid Chart, and Panel Chart. I would even argue that sparklines are a simpler, smaller cousin of small multiples.</p>
      <h2>Spiral chart</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/PNG/spiral_plot.png" loading="lazy">
      <p>This type of visualisation plots time-based data along an <a href="https://en.wikipedia.org/wiki/Archimedean_spiral">Archimedean spiral</a>. The graph begins at the centre of a spiral and then progresses outwards. Spiral Plots are versatile and can use bars, lines or points to be displayed along the spiral path.</p>
      <h2>Spike map</h2>
      <figure id="spikemap"></figure>
      <figcaption>Data: <a href="https://api.census.gov/data/2016/acs/acs5/cprofile/examples.html">American Community Survey</a></figcaption>
      <!-- <p>Todo : https://observablehq.com/@observablehq/plot-spike </p> -->
      <h2>Square pie chart</h2>
      <figure id="waffle"></figure>
      <p>Square charts, also called waffle charts, are a form of pie charts that use squares instead of circles to represent percentages. Similar to basic circular pie charts, square pie charts take each percentage out of a total 100%. They are often 10 by 10 grids, where each cell represents 1%. Despite the name, circles, pictograms (such as of people), and other shapes may be used instead of squares. One major benefit to square charts is that smaller percentages, difficult to see on traditional pie charts, can be easily depicted.</p>
      <h2>Stacked area chart</h2>
      <h3>Unemployment by industry</h3>
      <figure id="bls_stacked"></figure>
      <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      <p>Stacked area graphs work in the same way as regular area graphs, except for the use of multiple data series that start each point from the point left by the previous data series. The entire graph represents the total of all the data plotted. Stacked Area Graphs also use the areas to convey whole numbers, so they do not work for negative values. Overall, they are useful for comparing multiple variables changing over an interval.</p>
      <h2>Stacked bar chart</h2>
      <h3>Unemployment by industry</h3>
      <figure id="bls_bar"></figure>
      <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      <p>Stacked Bar Graphs are used to show how a larger category is divided into smaller categories and what the relationship of each part has on the total amount.</p>
      <h2>Stem and Leaf plot</h2>
      <h3>Caltrain’s Palo Alto station schedule</h3>
      <figure id="stem_plot"></figure>
      <figcaption>Data: <a href="https://www.caltrain.com/stations/paloaltostation.html">Caltrain</a></figcaption>
      <p>A Stem and Leaf Plot is a special table where each data value is split into a "stem" (the first digit or digits) and a "leaf" (usually the last digit). The "stem" values are listed down, and the "leaf" values go right (or left) from the stem values. The "stem" is used to group the scores and each "leaf" shows the individual scores within each group.</p>
      <p>In the example above, the stem is the hour of the day and the leaf is the minute of when a Caltrain running Southbound (left) or Northbound (right) is scheduled to arrive. The color of each leaf encodes the type of train arriving.</p>
      <h2>Step chart</h2>    
      <h3>WeWork Valuation</h3>
      <figure id="wework"></figure>
      <figcaption>Data: <a href="https://craft.co/wework/funding-rounds">Craft.co</a></figcaption>
      <p>A step chart works like a line chart, but the values change immediately at the x-coordinate instead of being interpolated<a href="#interpolation" aria-describedby="footnote-label" id="interpolation-ref"></a> with a slope.</p>
      <h2>Streamgraph</h2>
      <h3>Unemployment by industry</h3>
      <figure id="streamgraph"></figure>
      <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      <!-- <img src="https://datavizcatalogue.com/methods/images/top_images/SVG/stream_graph.svg"> -->
      <p>Stream Graphs display the changes in data over time of different categories through the use of flowing, organic shapes that somewhat resemble a river-like stream. This makes Stream Graphs aesthetically pleasing and more engaging to look at. In a Stream Graph, the size of each individual stream shape is proportional to the values in each category.</p>
      <h2>Strip plot</h2>
      <h3>English letter frequency</h3>
      <figure id="example_dot"></figure>
      <figcaption>Data: <a href="http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html">Cornell</a></figcaption>
      <p>Dots are placed along a single continuous scale to show distribution along the corresponding variable.</p>
      <h2>Table</h2>
      <!--Source: https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-climate-averages/gcnk62de6-->
      <div class="wrapper" tabindex="0" role="region" aria-labelledby="tableCaption_01">
        <table class="simple">
          <caption id="tableCaption_01">Average climate data for the UK, 1990–2020</caption>
          <thead>
            <tr>
              <th scope="col">Month</th>
              <th scope="col">Maximum temperature (°C)</th>
              <th scope="col">Minimum temperature (°C)</th>
              <th scope="col">Days of air frost (days)</th>
              <th scope="col">Sunshine (hours)</th>
              <th scope="col">Rainfall (mm)</th>
              <th scope="col">Days of rainfall ≥1&nbsp;mm (days)</th>
              <th scope="col">Monthly mean wind speed at 10&nbsp;m (knots)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">January</th>
              <td>6.66</td>
              <td>1.21</td>
              <td>11.32</td>
              <td>47.51</td>
              <td>121.53</td>
              <td>15.43</td>
              <td>10.77</td>
            </tr>
            <tr>
              <th scope="row">February</th>
              <td>7.16</td>
              <td>1.13</td>
              <td>10.69</td>
              <td>71.93</td>
              <td>96.15</td>
              <td>13.18</td>
              <td>10.77</td>
            </tr>
            <tr>
              <th scope="row">March</th>
              <td>9.22</td>
              <td>2.19</td>
              <td>7.84</td>
              <td>109.24</td>
              <td>85.10</td>
              <td>12.68</td>
              <td>10.28</td>
            </tr>
            <tr>
              <th scope="row">April</th>
              <td>12.03</td>
              <td>3.75</td>
              <td>4.03</td>
              <td>155.38</td>
              <td>71.73</td>
              <td>11.59</td>
              <td>9.33</td>
            </tr>
            <tr>
              <th scope="row">May</th>
              <td>15.13</td>
              <td>6.25</td>
              <td>1.20</td>
              <td>192.21</td>
              <td>70.98</td>
              <td>11.24</td>
              <td>8.75</td>
            </tr>
            <tr>
              <th scope="row">June</th>
              <td>17.68</td>
              <td>9.08</td>
              <td>0.07</td>
              <td>171.48</td>
              <td>77.20</td>
              <td>11.51</td>
              <td>8.16</td>
            </tr>
            <tr>
              <th scope="row">July</th>
              <td>19.62</td>
              <td>11.02</td>
              <td>0.00</td>
              <td>173.39</td>
              <td>82.48</td>
              <td>12.25</td>
              <td>7.85</td>
            </tr>
            <tr>
              <th scope="row">August</th>
              <td>19.30</td>
              <td>10.97</td>
              <td>0.01</td>
              <td>161.64</td>
              <td>93.73</td>
              <td>12.89</td>
              <td>7.88</td>
            </tr>
            <tr>
              <th scope="row">September</th>
              <td>16.85</td>
              <td>9.04</td>
              <td>0.12</td>
              <td>127.49</td>
              <td>90.89</td>
              <td>12.08</td>
              <td>8.41</td>
            </tr>
            <tr>
              <th scope="row">October</th>
              <td>13.08</td>
              <td>6.42</td>
              <td>1.64</td>
              <td>91.82</td>
              <td>122.56</td>
              <td>14.83</td>
              <td>9.30</td>
            </tr>
            <tr>
              <th scope="row">November</th>
              <td>9.41</td>
              <td>3.56</td>
              <td>5.51</td>
              <td>57.94</td>
              <td>123.39</td>
              <td>15.81</td>
              <td>9.74</td>
            </tr>
            <tr>
              <th scope="row">December</th>
              <td>7.02</td>
              <td>1.42</td>
              <td>10.95</td>
              <td>42.71</td>
              <td>127.19</td>
              <td>15.60</td>
              <td>10.06</td>
            </tr>
          </tbody>
          <tfoot>
            <th scope="row">Annual</th>
            <td>12.79</td>
            <td>5.53</td>
            <td>53.36</td>
            <td>1402.73</td>
            <td>1162.93</td>
            <td>159.08</td>
            <td>9.27</td>
          </tfoot>
        </table>
      </div>
      <p>Visually plain and boring. Sometimes exactly what you want.</p>
      <h2>Timetable</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/timetable.png" loading="lazy">
      <p>Timetables are used as a referencing and management tool for scheduled events, tasks and actions to take place. Timetables are commonly used to display the arrival and departure time of trains and other forms of transportation.</p>
      <h2>Ternary plot</h2>
      <!-- Todo: https://observablehq.com/@fil/ternary-plot -->
      <img src="imgs/ternary.svg" loading="lazy">
      <p>A ternary plot, ternary graph, or triangle plot graphically depicts the ratios of the three variables as positions in an equilateral triangle.</p>
      <h2>Timeline</h2>
      <h3>World History Timeline</h3>
      <figure id="civilizations"></figure>
      <figcaption>Data: <a href="http://www.essential-humanities.net/history-overview/world-history-timeline/">Essential Humanities</a></figcaption>
      <p>Timelines are the most effective way to visualize a sequence of events in chronological order. They’re typically linear, with key events outlined along the axis. Timelines are used to communicate time-related information and display historical data.</p>
      <p>Timelines allow you to highlight the most important events that occurred, or need to occur in the future, and make it easy for the viewer to identify any patterns appearing within the selected time period. While timelines are often relatively simple linear visualizations, they can be made more visually appealing by adding images, colors, fonts, and decorative shapes.</p>
      <h2>Treemap</h2>
      <img src="imgs/treemap.svg" loading="lazy">
      <p>Ben Shneiderman originally developed Treemaps as a way of visualising a vast file directory on a computer, without taking up too much space on the screen. This makes Treemaps a more compact and space-efficient option for displaying hierarchies, that gives a quick overview of the structure. Treemaps are also great at comparing the proportions between categories via their area size.</p>
      <img src="https://images.datacamp.com/image/upload/v1692817220/image3_852926c2da.png" loading="lazy">
      <h2>Variable width bar chart</h2>
      <h3>Commute time to work</h3>
      <figure id="irregular"></figure>
      <figcaption class="alignLeft">Data: <a href="https://www.census.gov/prod/2004pubs/c2kbr-33.pdf">US 2000 census</a></figcaption>
      <p>The vertical height is the same as a regular bar chart. The widths of bars show another dimension for each category. The two dimensions multiplied (area) should mean something.</p>
      <h2>Venn diagram</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/SVG/venn_diagram.svg" loading="lazy">
      <p>A Venn Diagram is a diagram that visually displays all the possible logical relationships between a collection of sets. Each set is typically represented with a circle. When sets overlap, it’s known as the intersection area. This is where entities that have all the qualities of the overlapping sets.</p>
      <h2>Waterfall Chart</h2>
      <img src="https://www.automateexcel.com/excel/wp-content/uploads/2020/10/waterfall-chart-free-template.png" loading="lazy">
      <p>A waterfall chart is a visual representation that illustrates how a value changes as it’s influenced by different factors, such as time. The main goal of this chart is to show the viewer how a value has grown or declined over a defined period. For example, waterfall charts are popular for showing spending or earnings over time.</p>
      <h2>Word clouds</h2>
      <p>A word cloud, or tag cloud, is a visual representation of text data in which the size of the word is proportional to its frequency. The more often a specific word appears in a dataset, the larger it appears in the visualization. In addition to size, words often appear bolder or follow a specific color scheme depending on their frequency.</p>
      <img src="https://images.datacamp.com/image/upload/v1692817285/image9_3a0ec1443d.png" loading="lazy">
    </article>
  </main>

  <!-- Todo: find better way to define SVG gradient, as in https://observablehq.com/@observablehq/plot-area-chart-with-gradient -->
  <svg
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <linearGradient id="gradient" gradientTransform="rotate(90)">
      <stop offset="20%" stop-color="rgba(0, 0, 0, .75)" stop-opacity="0.5" />
      <stop offset="100%" stop-color="LightSkyBlue" stop-opacity="0" />
    </linearGradient>
  </defs>
</svg>

<footer>
  <h2 id="footnote-label">Footnotes</h2>
  <ol>
    <li id="glyph">For a deep dive on glyph and pictograph charts, check out <a href="https://vis.uib.no/wp-content/papercite-data/pdfs/Borgo13GlyphBased.pdf">Glyph-based Visualization: Foundations, Design Guidelines, Techniques and Applications</a>. <a href="#glyph-ref" aria-label="Back to content">↩</a></li>
    <li id="interpolation"><b>Interpolation</b> is the process of calculating an approximate value based on values that are already known. Learn more <a href="https://www.merriam-webster.com/dictionary/interpolation">here</a>.<a href="#interpolation-ref" aria-label="Back to content">↩</a></li>
  </ol>
  <div>
    <p>Justin Chill © 2024. Thanks for reading!</p>
    <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" class="icon">Source code and feedback</a></span>    
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/d3"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>

<script type="text/javascript">
  var element = d3.select('p').node();
  var width = element.getBoundingClientRect().width; // get width of article so graphic is responsive  
  var size = width > 450 ? ".9rem" : ".5rem";
  var backgroundColor = "rgba(242,245,248,1)";

  var nodes = [
    { id: "SRI", x: 0, y: 10 },
    { id: "UCSB", x: 1, y: 1 },
    { id: "UCLA", x: 8, y: 0 },
    { id: "UTAH", x: 36, y: 17 }
    ];

  var links = [ ["SRI", "UTAH"], ["SRI", "UCSB"], ["SRI", "UCLA"], ["UCLA", "UCSB"] ];

  var ex_lvls = [{ "Phrase":"Hey baby,", "level":15},
    { "Phrase":"do you want", "level":25},
    { "Phrase":"to have", "level":40},
    { "Phrase":"sex...", "level":75},
    { "Phrase":"...tuplets?", "level":5}];

  var wework = [
  // https://craft.co/wework/funding-rounds
    [0.097, '01/04/2009', 'A'],
    [0.440, '01/11/2010', 'B'],
    [1.5, '01/07/2011', 'C'],
    [4.8, '01/07/2011', 'D-1'],
    [5, '01/05/2012', 'D-2'],
    [10, '01/05/2015', 'E'],
    [15, '01/06/2015', 'F'],
    [21, '01/08/2017', 'G'],
  [47, '01/08/2019', '‘The epic SoftBank round’'], // https://www.businesswire.com/news/home/20190108005751/en/WeWork-Closes-6-Billion-Investment-SoftBank
  [7.3, '12/31/2019'],
  [2.9, '05/20/2020'],
  [2.9, new Date()]
  ].map(([val, d, label]) => ({ value: val, date: new Date(d), label }));

  var animals = [
    { animal: "pigs", country: "Great Britain", count: 1354979 },
    { animal: "cattle", country: "Great Britain", count: 3962921 },
    { animal: "sheep", country: "Great Britain", count: 10931215 },
    { animal: "pigs", country: "United States", count: 6281935 },
    { animal: "cattle", country: "United States", count: 9917873 },
    { animal: "sheep", country: "United States", count: 7084151 }
    ];

  var top20 = [{"country":"China","value":10174.681},{"country":"United States of America","value":5284.697},{"country":"India","value":2616.449},{"country":"Russian Federation","value":1678.367},{"country":"Japan","value":1106.664},{"country":"Iran","value":779.527},{"country":"Germany","value":701.955},{"country":"Indonesia","value":617.513},{"country":"South Korea","value":611.263},{"country":"Saudi Arabia","value":582.15},{"country":"Canada","value":576.65},{"country":"South Africa","value":478.608},{"country":"Brazil","value":465.716},{"country":"Mexico","value":438.498},{"country":"Australia","value":411.016},{"country":"Turkey","value":405.126},{"country":"United Kingdom","value":369.878},{"country":"Italy","value":337.086},{"country":"France","value":323.747},{"country":"Poland","value":322.627}];

  var alphabet = [{"letter":"E","frequency":0.12702},{"letter":"T","frequency":0.09056},{"letter":"A","frequency":0.08167},{"letter":"O","frequency":0.07507},{"letter":"I","frequency":0.06966},{"letter":"N","frequency":0.06749},{"letter":"S","frequency":0.06327},{"letter":"H","frequency":0.06094},{"letter":"R","frequency":0.05987},{"letter":"D","frequency":0.04253},{"letter":"L","frequency":0.04025},{"letter":"C","frequency":0.02782},{"letter":"U","frequency":0.02758},{"letter":"M","frequency":0.02406},{"letter":"W","frequency":0.0236},{"letter":"F","frequency":0.02288},{"letter":"G","frequency":0.02015},{"letter":"Y","frequency":0.01974},{"letter":"P","frequency":0.01929},{"letter":"B","frequency":0.01492},{"letter":"V","frequency":0.00978},{"letter":"K","frequency":0.00772},{"letter":"J","frequency":0.00153},{"letter":"X","frequency":0.0015},{"letter":"Q","frequency":0.00095},{"letter":"Z","frequency":0.00074}];

  var mekko = [{"year":2013,"territory":"Southeast","total":860126.27},{"year":2015,"territory":"Southeast","total":590351.26},{"year":2014,"territory":"Southeast","total":554975.04},{"year":2013,"territory":"Southwest","total":514814.11},{"year":2013,"territory":"Mideast","total":509158.51},{"year":2013,"territory":"Plains","total":499981.42},{"year":2013,"territory":"Great Lakes","total":448777.43},{"year":2015,"territory":"Plains","total":426599.52},{"year":2015,"territory":"Great Lakes","total":426204.18},{"year":2015,"territory":"Mideast","total":422307.31},{"year":2016,"territory":"Southeast","total":398957.56},{"year":2013,"territory":"Far West","total":391021.82},{"year":2015,"territory":"Southwest","total":356559.44},{"year":2014,"territory":"Mideast","total":348336.13},{"year":2014,"territory":"Plains","total":335422.77},{"year":2014,"territory":"Southwest","total":330156.18},{"year":2015,"territory":"Far West","total":311311.14},{"year":2016,"territory":"Mideast","total":309321.7},{"year":2016,"territory":"Plains","total":249464.6},{"year":2014,"territory":"Far West","total":238638.61},{"year":2014,"territory":"Great Lakes","total":235570.98},{"year":2016,"territory":"Far West","total":233609.7},{"year":2016,"territory":"Southwest","total":227107.47},{"year":2016,"territory":"Great Lakes","total":209591.94},{"year":2015,"territory":"Rocky Mountain","total":196060.13},{"year":2013,"territory":"Rocky Mountain","total":195866.61},{"year":2014,"territory":"Rocky Mountain","total":106174.16},{"year":2016,"territory":"Rocky Mountain","total":83640.41}];

  var energy = [{"year":2019,"decade":"2010-2019","value":31439,"source":"Biomass"},{"year":2009,"decade":"2000-2009","value":7244,"source":"Biomass"},{"year":2019,"decade":"2010-2019","value":139275,"source":"Wood and Waste"},{"year":2009,"decade":"2000-2009","value":152041,"source":"Wood and Waste"},{"year":2019,"decade":"2010-2019","value":968857,"source":"Renewable Energy"},{"year":2009,"decade":"2000-2009","value":487942,"source":"Renewable Energy"},{"year":2019,"decade":"2010-2019","value":0,"source":"Coal"},{"year":2009,"decade":"2000-2009","value":0,"source":"Coal"},{"year":2019,"decade":"2010-2019","value":920142,"source":"Oil"},{"year":2009,"decade":"2000-2009","value":1202120,"source":"Oil"},{"year":2019,"decade":"2010-2019","value":168799,"source":"Nuclear"},{"year":2009,"decade":"2000-2009","value":332218,"source":"Nuclear"},{"year":2019,"decade":"2010-2019","value":220844,"source":"Natural Gas"},{"year":2009,"decade":"2000-2009","value":310439,"source":"Natural Gas"}];

  var population = [{"2010":37254523,"2019":39512223,"State":"California"},{"2010":25145561,"2019":28995881,"State":"Texas"},{"2010":18801310,"2019":21477737,"State":"Florida"},{"2010":19378102,"2019":19453561,"State":"New York"},{"2010":12702379,"2019":12801989,"State":"Pennsylvania"},{"2010":12830632,"2019":12671821,"State":"Illinois"},{"2010":11536504,"2019":11689100,"State":"Ohio"},{"2010":9687653,"2019":10617423,"State":"Georgia"},{"2010":9535483,"2019":10488084,"State":"North Carolina"},{"2010":9883640,"2019":9986857,"State":"Michigan"},{"2010":8791894,"2019":8882190,"State":"New Jersey"},{"2010":8001024,"2019":8535519,"State":"Virginia"},{"2010":6724540,"2019":7614893,"State":"Washington"},{"2010":6392017,"2019":7278717,"State":"Arizona"},{"2010":6547629,"2019":6949503,"State":"Massachusetts"},{"2010":6346105,"2019":6833174,"State":"Tennessee"},{"2010":6483802,"2019":6732219,"State":"Indiana"},{"2010":5988927,"2019":6137428,"State":"Missouri"},{"2010":5773552,"2019":6045680,"State":"Maryland"},{"2010":5686986,"2019":5822434,"State":"Wisconsin"},{"2010":5029196,"2019":5758736,"State":"Colorado"},{"2010":5303925,"2019":5639632,"State":"Minnesota"},{"2010":4625364,"2019":5148714,"State":"South Carolina"},{"2010":4779736,"2019":4903185,"State":"Alabama"},{"2010":4533372,"2019":4648794,"State":"Louisiana"},{"2010":4339367,"2019":4467673,"State":"Kentucky"},{"2010":3831074,"2019":4217737,"State":"Oregon"},{"2010":3751351,"2019":3956971,"State":"Oklahoma"},{"2010":3574097,"2019":3565287,"State":"Connecticut"},{"2010":2763885,"2019":3205958,"State":"Utah"},{"2010":3046355,"2019":3155070,"State":"Iowa"},{"2010":2700551,"2019":3080156,"State":"Nevada"},{"2010":2915918,"2019":3017825,"State":"Arkansas"},{"2010":2967297,"2019":2976149,"State":"Mississippi"},{"2010":2853118,"2019":2913314,"State":"Kansas"},{"2010":2059179,"2019":2096829,"State":"New Mexico"},{"2010":1826341,"2019":1934408,"State":"Nebraska"},{"2010":1852994,"2019":1792065,"State":"West Virginia"},{"2010":1567582,"2019":1787147,"State":"Idaho"},{"2010":1360301,"2019":1415872,"State":"Hawaii"},{"2010":1316470,"2019":1359711,"State":"New Hampshire"},{"2010":1328361,"2019":1344212,"State":"Maine"},{"2010":989415,"2019":1068778,"State":"Montana"},{"2010":1052567,"2019":1059361,"State":"Rhode Island"},{"2010":897934,"2019":973764,"State":"Delaware"},{"2010":814180,"2019":884659,"State":"South Dakota"},{"2010":672591,"2019":762062,"State":"North Dakota"},{"2010":710231,"2019":731545,"State":"Alaska"},{"2010":601723,"2019":705749,"State":"District of Columbia"},{"2010":625741,"2019":623989,"State":"Vermont"},{"2010":563626,"2019":578759,"State":"Wyoming"}];

  var civilizations = [{"civilization":"Aegean civilization","start":-2000,"end":-1200,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"ANCIENT WORLD"},{"civilization":"Age of pre-colonial civilization (Christian, Islamic, and traditional kingdoms)","start":650,"end":1880,"startLabel":null,"endLabel":null,"region":"Sub-Saharan Africa","timeline":"MEDIEVAL WORLD"},{"civilization":"Age of Turkic empires","start":500,"end":1200,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"MEDIEVAL WORLD"},{"civilization":"Age of united Caliphate","start":650,"end":900,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"MEDIEVAL WORLD"},{"civilization":"Ancient Andean region","start":-1000,"end":500,"startLabel":null,"endLabel":null,"region":"pre-colonial Americas","timeline":"ANCIENT WORLD"},{"civilization":"Ancient China","start":-2000,"end":500,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"ANCIENT WORLD"},{"civilization":"Ancient Steppe empires","start":-1000,"end":500,"startLabel":null,"endLabel":null,"region":"the Steppe","timeline":"ANCIENT WORLD"},{"civilization":"British India","start":1800,"end":1945,"startLabel":null,"endLabel":"WWII","region":"South Asia","timeline":"MODERN WORLD"},{"civilization":"Classic age of Mesoamerica","start":100,"end":900,"startLabel":null,"endLabel":null,"region":"pre-colonial Americas","timeline":"ANCIENT WORLD"},{"civilization":"Colonial Africa","start":1880,"end":1980,"startLabel":null,"endLabel":null,"region":"Sub-Saharan Africa","timeline":"MODERN WORLD"},{"civilization":"Colonial United States","start":1500,"end":1776,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Early Islamic period","start":1200,"end":1500,"startLabel":null,"endLabel":null,"region":"South Asia","timeline":"MEDIEVAL WORLD"},{"civilization":"Early modern China","start":1500,"end":1918,"startLabel":null,"endLabel":"WWI","region":"East Asia","timeline":"MODERN WORLD"},{"civilization":"Early modern Europe","start":1500,"end":1800,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Early Nubian civilization","start":-2000,"end":-1000,"startLabel":null,"endLabel":null,"region":"Sub-Saharan Africa","timeline":"ANCIENT WORLD"},{"civilization":"Egyptian civilization","start":-3000,"end":-550,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"First Persian Empire","start":-550,"end":-330,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Formative age of Mesoamerica","start":-1500,"end":100,"startLabel":null,"endLabel":null,"region":"pre-colonial Americas","timeline":"ANCIENT WORLD"},{"civilization":"Formative Japan (age of Yamato rule)","start":500,"end":800,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"MEDIEVAL WORLD"},{"civilization":"Formative US","start":1776,"end":1865,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Fractured Islamic world","start":900,"end":2018,"startLabel":null,"endLabel":"present","region":"Middle East","timeline":"MODERN WORLD"},{"civilization":"Great power US","start":1865,"end":1945,"startLabel":null,"endLabel":"WWII","region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Greek age","start":-1200,"end":0,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"ANCIENT WORLD"},{"civilization":"Heian age","start":800,"end":1200,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"MEDIEVAL WORLD"},{"civilization":"Imperial Japan","start":1870,"end":1945,"startLabel":null,"endLabel":"WWII","region":"East Asia","timeline":"MODERN WORLD"},{"civilization":"Indian kingdom age","start":-500,"end":1200,"startLabel":null,"endLabel":null,"region":"South Asia","timeline":"ANCIENT WORLD"},{"civilization":"Indus civilization","start":-2500,"end":-1500,"startLabel":null,"endLabel":null,"region":"South Asia","timeline":"ANCIENT WORLD"},{"civilization":"Inter-Persian period","start":-330,"end":200,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Kush","start":-1000,"end":300,"startLabel":null,"endLabel":null,"region":"Sub-Saharan Africa","timeline":"ANCIENT WORLD"},{"civilization":"Medieval Andean region","start":500,"end":1530,"startLabel":null,"endLabel":null,"region":"pre-colonial Americas","timeline":"MEDIEVAL WORLD"},{"civilization":"Medieval China","start":500,"end":1500,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"MEDIEVAL WORLD"},{"civilization":"Medieval Europe","start":500,"end":1500,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"MEDIEVAL WORLD"},{"civilization":"Mesopotamian civilization","start":-3500,"end":-550,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Modern Africa","start":1980,"end":2018,"startLabel":"WWII","endLabel":"present","region":"Sub-Saharan Africa","timeline":"MODERN WORLD"},{"civilization":"Modern Europe","start":1800,"end":2018,"startLabel":null,"endLabel":"present","region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Modern India","start":1945,"end":2018,"startLabel":null,"endLabel":"present","region":"South Asia","timeline":"MODERN WORLD"},{"civilization":"Modern Japan","start":1945,"end":2018,"startLabel":null,"endLabel":"present","region":"East Asia","timeline":"MODERN WORLD"},{"civilization":"Mongol Empire","start":1200,"end":1300,"startLabel":null,"endLabel":null,"region":"the Steppe","timeline":"MEDIEVAL WORLD"},{"civilization":"Mughal Empire","start":1500,"end":1800,"startLabel":null,"endLabel":null,"region":"South Asia","timeline":"MODERN WORLD"},{"civilization":"Peak of Aksum","start":300,"end":650,"startLabel":null,"endLabel":null,"region":"Sub-Saharan Africa","timeline":"MEDIEVAL WORLD"},{"civilization":"People's Republic of China","start":1945,"end":2018,"startLabel":"WWII","endLabel":"present","region":"East Asia","timeline":"MODERN WORLD"},{"civilization":"Postclassic age of Mesoamerica","start":900,"end":1520,"startLabel":null,"endLabel":null,"region":"pre-colonial Americas","timeline":"MEDIEVAL WORLD"},{"civilization":"Ptolemaic Egypt","start":-330,"end":0,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Republic of China","start":1918,"end":1945,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"MODERN WORLD"},{"civilization":"Roman > Byzantine Egypt","start":0,"end":650,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Roman Empire","start":0,"end":500,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"ANCIENT WORLD"},{"civilization":"Roman Republic","start":-500,"end":0,"startLabel":null,"endLabel":null,"region":"Europe (and colonial offshoots)","timeline":"ANCIENT WORLD"},{"civilization":"Second Persian Empire","start":-200,"end":650,"startLabel":null,"endLabel":null,"region":"Middle East","timeline":"ANCIENT WORLD"},{"civilization":"Shogunate","start":1200,"end":1870,"startLabel":null,"endLabel":null,"region":"East Asia","timeline":"MEDIEVAL WORLD"},{"civilization":"Superpower US","start":1945,"end":2021,"startLabel":null,"endLabel":"present","region":"Europe (and colonial offshoots)","timeline":"MODERN WORLD"},{"civilization":"Vedic age","start":-1500,"end":-500,"startLabel":null,"endLabel":null,"region":"South Asia","timeline":"ANCIENT WORLD"}];

  var sales = [{"market":"Auburn, AL","segment":"Almond lovers","value":3840},{"market":"Auburn, AL","segment":"Berry buyers","value":1920},{"market":"Auburn, AL","segment":"Carrots-n-more","value":960},{"market":"Auburn, AL","segment":"Delicious-n-new","value":400},{"market":"Birmingham, AL","segment":"Almond lovers","value":1600},{"market":"Birmingham, AL","segment":"Berry buyers","value":1440},{"market":"Birmingham, AL","segment":"Carrots-n-more","value":960},{"market":"Birmingham, AL","segment":"Delicious-n-new","value":400},{"market":"Gainesville, FL","segment":"Almond lovers","value":640},{"market":"Gainesville, FL","segment":"Berry buyers","value":960},{"market":"Gainesville, FL","segment":"Carrots-n-more","value":640},{"market":"Gainesville, FL","segment":"Delicious-n-new","value":400},{"market":"Durham, NC","segment":"Almond lovers","value":320},{"market":"Durham, NC","segment":"Berry buyers","value":480},{"market":"Durham, NC","segment":"Carrots-n-more","value":640},{"market":"Durham, NC","segment":"Delicious-n-new","value":400}];

  // Civilization chart
  formatYear = year => year < 0 ? `${-year} BC` : `${year} AD` // formatYear uses a ternary operator to dynamically format the year in the data. Such a cool d3 thing! 😎

  var civ_options = {
    width: width,
    style:{fontSize: size, textTransform: "capitalize"},
    marginLeft: 10,
    marginRight: 5,
    marginTop: 30,
    marginBottom: 20,
    x: {
      axis: "both",
      grid: true,
      clamp: true,
      tickFormat: formatYear
    },
    y: {
      axis: null,
      domain: d3.sort(civilizations, d => d.start).map(d => d.civilization)
    },
    color: {
      reverse: true,
      scheme: "BuRd",
      legend: true,
    },
    marks: [
      Plot.barX(civilizations, {
        x1: "start",
        x2: "end",
        insetTop: 2,
        insetBottom: 2, // Makes the bars slightly thinner
        fill: "region",
        tip: {
          opacity: 0.9,
          textPadding: 10,
          lineHeight: 1.65,
        },
        title: (d) =>
          `${d.civilization}\nStart: ${formatYear(d.start)}\nEnd: ${formatYear(d.end)}\nRegion: ${d.region}`,
          y: "civilization"
        }),
      Plot.text(civilizations.filter(d => (d.civilization == "Mesopotamian civilization" || d.civilization == "Egyptian civilization")), {
        x: "end", // Show label on right when start date is > -3000 years
        y: "civilization",
        text: "civilization",
        textAnchor: "start",
        dx: 10
      }),
      Plot.text(civilizations.filter(d => (d.civilization !== "Mesopotamian civilization" && d.civilization !== "Egyptian civilization")), {
          x: "start", // Show label on right when start date is > -3000 years
          y: "civilization",
          text: "civilization",
          textAnchor: "end",
          dx: -6
        }),
      ]
  };

  var country_emissions = {
    width: width,
    marginLeft: width > 450 ? 180 : 90,
    marginRight: width > 450 ? 100 : 20,
    marginBottom: 0,
    style:{
      fontSize: size,
      backgroundColor: backgroundColor,
      padding: 10,
    },
    color: {
      range: ["#969696", "#4e79a7"]
    },
    x: {
      axis: "top",
      ticks: 0,
      label: "Metric Tonne Carbon Dioxide Equivalent (MtCO₂) annually",
      labelOffset: 15,
    },
    y: {
      domain: d3.sort(top20, d => -d.value).map(d => d.country),
      tickSize: 0,
      label: null
    },
    marks: [
      Plot.barX(top20, {
        x: "value",
        y: "country",
        inset:2,
        fill: d => d.value < 2000 ? "" : "country",
      }),
      Plot.text(top20, {
        x: "value", 
        y: "country", 
        text: d => d3.format(",.0f")(d.value), 
        textAnchor: "start",
        fontSize: 12,
        dx: 6, 
        dy: 0,
      }),
      ]
  };

  var emoji = ({ cattle: "🐄", sheep: "🐑", pigs: "🐖" });
  var animals = {
    width: width,
    style: {textTransform: "capitalize", fontSize: size},
    height: 380,
    marginLeft: width/10,
    marginRight: width/5,
    marginTop: 30,
    y: {label: null, tickSize: 0, tickFormat: d => d + ":",},
    fy: {paddingInner: 0.27, label: null},
    marks: [
      Plot.text(animals, {
        frameAnchor: "left",
        fontSize: width > 450 ? 30 : 15,
        text: (d) => `${emoji[d.animal]} `.repeat(Math.round(d.count / 1e6)),
        dx: 20,
        y: "animal",
        fy: "country",
      }),
      Plot.axisFy({ fontSize: 18, frameAnchor: "top", dy: -18 })
      ],
  };

  // Todo: replace with https://observablehq.com/@observablehq/plot-slope-chart ? 
  // Todo: and add https://observablehq.com/@observablehq/plot-cancer-survival-rates as second slop example 
  var slope = {
    width: width,
    marginLeft: width/10,
    marginRight: width/5,
    height: 380,
    marginTop: 30,
    marginBottom: 20, 
    insetLeft: width > 500 ? -100 : -90,
    style:{fontSize: size},
    x: {
      tickFormat: "",
      type: "point", 
      axis: "top", 
      label: null,
    },
    y: {
      tickSize: 0,
      ticks: 6,
      label: "Billion BTUs", 
      labelAnchor: "top",
      // labelOffset: 100,
      anchor: "left",
      grid: true,
    },
    marks: [
      Plot.line(energy, {
        x: "year",
        y: "value",
        z: "source",
        stroke: "source",
      }),
      Plot.text(energy,
        Plot.selectFirst({
          x: "year",
          y: "value",
          z: "source",
          fontSize: width > 450 ? 12 : 9,
          text: d => `${d.source} (${d3.format(",")(d.value)} Billion BTUs)`,textAnchor: "start", dx: 10
        })
        ),
      ]
  };

  lookup = new function(){
    const index = new Map(nodes.map(d => [d.id, d]));
    return id => index.get(id);
  };
  function project([id1, id2]) {
    const {x: x1, y: y1} = lookup(id1);
    const {x: x2, y: y2} = lookup(id2);
    return {x1, y1, x2, y2};
  };

  var network = {
    inset: 10,
    marginLeft: 10,
    marginRight: 10,
    marginTop: 10,
    marginBottom: 10,
    x: {axis: null},
    y: {axis: null},
    marks: [
      Plot.link(links.map(project), {
        x1: "x1", y1: "y1", x2: "x2", y2: "y2"
      }),
      Plot.dot(nodes, {x: "x", y: "y", fill: "black"}),
      Plot.text(nodes, {x: "x", y: "y", text: "id", dy: 16, dx: -12})
      ],
    width: 300,
    height: 220
  };

  var wework = {
    width: width,
    style:{fontSize: size},
    marginLeft: width/33,
    marginRight: width/100,
    marginTop: 30,
    marginBottom: 20,
    y: {
      grid: true,
      tickFormat: d=> `$${d}B`,
      label: "Value ↑",
      tickSize: 0,
    },
    marks: [
      Plot.axisY({
        tickSize: 0, // don’t draw ticks
        dx: 2, // offset right
        dy: -4, // offset up
        lineAnchor: "bottom", // draw labels above grid lines
        tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}B` : `${d}B`) // Show $ on first tick only
      }),
      Plot.lineY(wework, {x: "date", y: "value", curve: "step-after", strokeWidth: 2, stroke: "steelblue"}),
      Plot.ruleY([0]),
      Plot.text(wework.filter(d => (d.label !== "E" && d.label !== "C")), {x: "date", y: "value", text: "label", dx: 0, dy: -12}),
      Plot.text(wework.filter(d => (d.label === "E" || d.label === "C")), {x: "date", y: "value", text: "label", dx: -12, dy: -1}),
      Plot.dot(wework, {x: "date", y: "value", r: width < 500 ? 3 : 4, fill: "white", stroke: "black", title: d => d3.format("$")(d.value)+`B`, })
      ]
  };

  var example_dot = {
    width: width,
    style: {fontSize: size},
    marginTop: 20,
    marginLeft: 0,
    marginRight: 0,
    x: {
      label: null,
    },
    marks: [
      Plot.dot(alphabet, {x: "letter", r: d => d.frequency * 1, fill: "letter", title: d => d3.format(".0%")(d.frequency), tip: true,})
      ]
  };

  var example_line = {
    width: width,
    style:{fontSize: size},
    marginLeft: width/24,
    marginRight: width/33,
    marginTop: 20,
    marginBottom: 10,
    y: {
      grid: true,
      nice: true,
      domain: [0, 100],
      label: "↑ Excitement level",
      anchor: "left",
      tickSize: 0,
    },
    x:{
      domain: d3.sort(ex_lvls, d => -d.Phrase).map(d => d.Phrase),
      axis: null,
    },
    marks: [
      Plot.line(ex_lvls, {x: "Phrase", y: "level", stroke: "hsl(22, 82%, 39%)", strokeWidth: 2.5}),
      Plot.dot(ex_lvls, {x: "Phrase", y: "level", fill: "hsl(22, 82%, 39%)"}),
      Plot.text(ex_lvls.filter(d => (d.level <= 70)), {x: "Phrase", y: "level", text: "Phrase", dy: 18, dx: 14, fontSize: size*1.2}),
      Plot.text(ex_lvls.filter(d => (d.level >= 70)), {x: "Phrase", y: "level", text: "Phrase", dy: -12, dx: 2,fontSize: size*1.2}),
          // Plot.ruleY([0,100]),  
      ]
  };

  // Draw the plot (data local on page)
  document.getElementById("civilizations").appendChild(Plot.plot(civ_options));
  document.getElementById("wework").appendChild(Plot.plot(wework));
  document.getElementById("slope").appendChild(Plot.plot(slope));
  document.getElementById("animals").appendChild(Plot.plot(animals));
  document.getElementById("example_dot").appendChild(Plot.plot(example_dot));
  document.getElementById("network").appendChild(Plot.plot(network));
  document.getElementById("country_emissions").appendChild(Plot.plot(country_emissions));
  document.getElementById("example_line").appendChild(Plot.plot(example_line));

  var boxY = function boxY(data, {
    x = null,
    y = {transform: x => x},
    fill = "#ccc",
    stroke = "currentColor",
  } = {}) {
    const group = x == null ? Plot.groupZ : Plot.groupX;
    return Plot.marks(
      Plot.ruleX(data, group({y1: iqr1, y2: iqr2}, {x, y, stroke})),
      Plot.barY(data, group({y1: quartile1, y2: quartile3}, {x, y, fill})),
      Plot.tickY(data, group({y: "median"}, {x, y, stroke, strokeWidth: 2})),
      Plot.dot(data, Plot.map({y: outliers}, {x, y, z: x, stroke}))
      );
  };
  var outliers = function outliers(values) {
    const r1 = iqr1(values);
    const r2 = iqr2(values);
    return values.map(v => v < r1 || v > r2 ? v : NaN);
  };

  var iqr1 = V => {
    const hi = quartile1(V);
    const lo = hi - 1.5 * (quartile3(V) - hi);
    return d3.min(V, v => lo <= v && v <= hi ? v : NaN);
  };

  var iqr2 = V => {
    const lo = quartile3(V);
    const hi = lo + 1.5 * (lo - quartile1(V));
    return d3.max(V, v => lo <= v && v <= hi ? v : NaN);
  };

  var quartile1 = V => d3.quantile(V, 0.25);
  var quartile3 = V => d3.quantile(V, 0.75);

  // Formatting functions
  formatChange = new function() {
    const format = d3.format("+d");
    return x => format((x - 1) * 100);
  };

  formatCurrency = new function() {
    const format = d3.format("$.2f");
    return x => format(x);
  };

  formatPercent = new function() {
    const format = d3.format(".2%");
    return x => format(x);
  };

  formatWhole = new function() {
    const format = d3.format(",");
    return x => format(x);
  };

  formatLog = new function() {
    const format = d3.format(".2s");
    return x => format(x);
  };


  parseTime = new function() {
    const format = d3.timeParse("%Y");
    return x => format(x);    
  }; 

  const formatTime = d3.timeFormat("%Y");
  const formatDate = d3.timeFormat("%B %d, %Y");

  // Use Promises to async request data
  var promises = [d3.json("data/drugs.json"), d3.csv("data/aapl.csv",d3.autoType),d3.csv("data/global-temps.csv",d3.autoType), d3.csv("https://gist.githubusercontent.com/JesseCHowe/099f4b8e1a029c0b4af35b1edc1989f7/raw/8c18ed9a0940c734d423c3f2699ee063279533ec/morley.csv",d3.autoType), d3.csv("data/stocks.csv",d3.autoType),d3.csv("data/units.csv",d3.autoType),d3.json("data/qatar.json"),d3.csv("https://raw.githubusercontent.com/plotly/datasets/master/gapminderDataFiveYear.csv",d3.autoType),d3.csv("data/driving.csv",d3.autoType),d3.csv("data/bls.csv",d3.autoType),d3.csv("data/caltrain.csv"),d3.csv("data/mpg.csv",d3.autoType), d3.csv("data/electricity.csv",d3.autoType),d3.json("data/dogdata.json"), d3.csv("data/google-trends-2020.csv",d3.autoType),d3.csv("data/covid.csv", d3.autoType),d3.csv("data/commute.csv", d3.autoType),d3.csv("data/world-airports.csv", d3.autoType),d3.json("data/geo/land.json"),d3.json("data/geo/statemesh.json"),d3.json("data/geo/nation.json"),d3.csv("data/walmarts.csv",d3.autoType), d3.csv("data/popcornCriteria.csv",d3.autoType),d3.csv("data/state-population-2010-to-2019.csv",d3.autoType),d3.csv("data/geo/us-state-grid.csv",d3.autoType),d3.csv("data/bls_industries.csv",d3.autoType), d3.csv("data/weather.csv",d3.autoType), ];

  // You can request multiple srcs in a promise
  myDataPromises = Promise.all(promises);

  // After data is successfully fetched, generate viz
  myDataPromises.then(function(data) {
    // Define the data. There's gotta be a better way to do this:
    var drugs = data[0];
    var aapl = data[1];
    var hadcrut = data[2];
    var morley = data[3];
    var stocks = data[4];
    var units = data[5];
    var qatar = data[6];
    var gapminder = data[7];
    var driving = data[8];
    var bls = data[9];
    var caltrain = data[10];
    var mpg = data[11];
    var electric = data[12];
    var dogdata = data[13];
    var google = data[14];
    var covid = data[15];
    var commute = data[16];
    var airports = data[17];
    var land = data[18];
    var statemesh = data[19];
    var nation = data[20];
    var walmarts = data[21];
    var popcorndata = data[22];
    var statepop = data[23];
    var stategrid = data[24];
    var industries = data[25];
    var weather = data[26];

    var sortedData = popcorndata.filter(function(d,i){
       return i < 30; // Top 5 teams
     });

    var popcorn = {
      style:{fontSize: size},
      width: width,
      marginLeft: width/4,
      marginRight: width/40,
      marginTop: 80,
      marginBottom: 80,
      aspectRatio: 2.5,
      padding: 0,
      x: {
        axis: "both", 
        label: null, 
        tickSize: 0,  
        tickRotate: 35,
        fontSize: 16,
      },
      y: {
        domain: sortedData.map(d => d.Team), 
        label: null,
        tickSize: 0,
        axis: null,
      },
      color: {legend: true, scheme: "oranges", zero: true,style:{fontSize: size},}, // Need to pass style{} twice, once for X axis, once for legend axis
      marks: [
        Plot.frame({stroke: "#ccc", anchor: "top"}),
        Plot.text(sortedData, {y: "Team",dx: -10, dy: width > 450 ? -2 : -2, text: (d) => `${d.Team}`, frameAnchor: "left",textAnchor: "end", lineAnchor: "bottom", fontWeight: "bold", fontSize: width > 450 ? 16 : ".5rem",}), // Team name
        Plot.text(sortedData, {y: "Team",dx: -10, dy: width > 450 ? 4 : 2, text: (d) => `${d.Arena}`, frameAnchor: "left", textAnchor: "end", lineAnchor: "top", fontSize: width > 450 ? 14 : ".5rem", fontWeight: "normal"}), // Arena name
        Plot.cell(sortedData.filter(d => (d.Criteria != "Total Score")), {y: "Team", x: "Criteria", fill: "Score", inset: .85, channels: {Arena: "Arena",}, tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.5,
          },}), 
        Plot.cell(sortedData.filter(d => (d.Criteria == "Total Score")), {y: "Team", x: "Criteria", fill: "white", inset: .85,}),
        Plot.text(sortedData.filter(d => (d.Criteria != "Total Score")), {y: "Team", x: "Criteria", text: "Score", fill: "white", fontSize: width > 450 ? 18 : ".8rem", fontWeight: "bold"}),
        Plot.text(sortedData.filter(d => (d.Criteria == "Total Score")), {y: "Team", x: "Criteria", text: "Score", fill: "black", fontSize: width > 450 ? 18 : ".8rem", fontWeight: "bold"}),
        ]

    };

    var electricity = {
      width: width,
      marginLeft: width/20,
      marginRight: width > 450 ? width/8 : width/5,
      style:{fontSize: size, textTransform: "capitalize"},
      color: {
        scheme: "BuRd"
      },
      x: {
        tickPadding: 10,
        label: null,
        grid: true,
        tickSize: 0,
      },
      y: {
        tickFormat: "%",
        ticks: 5,
        tickSize: 0,
        nice: true,
        clamp: true,
        grid: true,
        label: null
      },
      marks: [
        Plot.ruleY([0]),
        Plot.gridX(),
        Plot.areaY(electric, Plot.stackY({
          x: "year", 
          y: "percentage", 
          fill: "source", 
          tip: {
            format: {
              y: (d) => formatPercent(d),
              x: (d) => formatTime(d),
              stroke: false
            },
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.65,
          },
          opacity: .85,
          order: ['Coal', 'Gas', 'Oil', 'Nuclear', 'Hydroelectric', 'Wind', 'Solar', 'Other renewables'],
          offset: "expand"})),      
        Plot.text(electric, Plot.selectLast(Plot.stackY({
          x: "year",
          y: "percentage",
          z: "source",
          order: ['Coal', 'Gas', 'Oil', 'Nuclear', 'Hydroelectric', 'Wind', 'Solar', 'Other renewables'], 
          offset: "expand",
          fill: "source",
          text: d => d.source == 'Other renewables' ? "- Other" : '- '+ d.source,
          rotate: 5,
          fontSize: 16,
          fontWeight: "bold",
          textAnchor: "start", dx: 4, dy: 3
        }))),
        ],
    };

    var apple_area = {
      width: width,
      style:{fontSize: size},
      marginLeft: width/33,
      marginRight: width/100,
      marginTop: 20,
      y: {
        grid: true,
        anchor: "left"
      },
      marks: [
        Plot.areaY(aapl, {x: "Date", y: "Close", fill: "url(#gradient)"}),
        Plot.lineY(aapl, {x: "Date", y: "Close", title: d => formatCurrency(d.Close), stroke: "rgba(0, 0, 0, .75)", tip: true,}),
        Plot.dot(aapl, Plot.selectLast({x: "Date", y: "Close", fill: "white", stroke: "rgba(0, 0, 0, .75)"})),
        Plot.text(aapl, Plot.selectLast({x: "Date", y: "Close", text: d => formatCurrency(d.Close), dy: -12, dx: -12, fontSize: 14})),
        Plot.axisY({
          tickSize: 0, // don’t draw ticks
          dx: 2, // offset right
          dy: -6, // offset up
          lineAnchor: "bottom", // draw labels above grid lines
          tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}` : d) // Show $ on first tick only
        }),
        ],
    };

    const tinyapple = aapl.slice(-90);

    var beeswarm = {
      width: width,
      marginTop: 20,
      marginLeft: width/33,
      marginRight: width/33,
      marginBottom: 30,
      style:{
        fontSize: size,
        backgroundColor: 'rgba(242,245,248,1)',
        padding: 10,
        textTransform: "capitalize",
      },
      color: {
        legend: false,
      },
      x: {
        zero: true,
        tickSize: 0,
        label: null,
        lineWidth: 8,
      },
      y: {
        anchor: "left",
        label: "mpg",
        grid: true,
        round: true,
        nice: true,
        ticks: 4,
        tickSize: 0,
      },
      fx: {
        label: null,
      },
      marks: [
        Plot.dot(mpg, Plot.dodgeX("middle", {
          fx: "class", 
          y: "hwy", 
          tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.65,
          },
          fill: "manufacturer"
        })),
        ],
    };

    var candlestick = {
      width: width,
      marginLeft: width/33,
      marginRight: width/100,
      marginBottom: 10,
      marginTop: 30,
      style:{fontSize: size},
      grid: true,
      inset: 4,
      y: {
        label: "↑ Apple stock price ($)",
        tickFormat: "$f",
        anchor: "left",
        tickSize: 0,
        nice: true,
      },
      x:{
        nice: true,
        tickSize: 0,
        nice: true,
      },
      color: {
        range: ["#e41a1c", "#000000", "#4daf4a"]
      },
      marks: [
        Plot.axisY({
          tickSize: 0, // don’t draw ticks
          dx: 2, // offset right
          dy: -4, // offset up
          lineAnchor: "bottom", // draw labels above grid lines
          tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}` : d) // Show $ on first tick only
        }),
        Plot.ruleX(tinyapple, {
          x: "Date",
          y1: "Low",
          y2: "High"
        }),
        Plot.ruleX(tinyapple, {
          x: "Date",
          y1: "Open",
          y2: "Close",
          stroke: d => Math.sign(d.Close - d.Open),
          strokeWidth: 4,
          strokeLinecap: "round",
        })
        ]
    };

    var freq_letters = {
      width: width,
      style:{fontSize: size},
      marginLeft: width/33,
      marginRight: width/100,
      x: {
        label: null,
        tickSize: 0,
      },    
      y: {
        label: "↑ Frequency (%)",
        grid: true,
        tickSize: 0,
        tickFormat: "%",
        ticks: 6,
        tickSize: 0,
        nice: true,
        clamp: true,
      },
      color: {
        domain: ["frequent", "not"],
        range: ["hsl(168, 78%, 41%)", "rgba(204,204,204,.8)"],
      },
      marks: [
      // Transform data example, ternary operator example for style
        Plot.barY(alphabet, {x: "letter", y: d => d.frequency, fill: d => d.frequency >.08 ? "frequent" : "not", title: d => "Letter "+(d.letter) + "\n" + formatPercent(d.frequency), tip: {
          opacity: 0.9,
          textPadding: 10,
          lineHeight: 1.5,
        },}),
        Plot.ruleY([0], {stroke: "hsl(0, 0%, 88%)"})
        ]
    };

    var drug_bar = {
      width: width,
      style:{fontSize: size},
      x: {
        label: null,
        tickSize: 0,
        tickRotate: -35,
      },
      color: {
        domain: ["small", "big"],
        range: ["hsl(168, 78%, 41%)", "hsl(0, 0%, 88%)"]
      },
      y: {
        grid: true,
        tickFormat: "",
        ticks: 8,
      },
      marks: [
        Plot.barY(drugs, { x: "Drug", y: "Pleasure", title: "Drug", fill: d => d.Pleasure > 2.4 ? "small" : "big"}),
        Plot.text(drugs, {x: "Drug", y: "Pleasure", text: d => (d.Pleasure).toFixed(1), dy: -5}),]
    };

    var anomaly_barcode = { 
      width: width,
      style:{fontSize: size},
      marginBottom: 20,
      marginTop: 30,
      marginLeft: width/100,
      marginRight: width/100,
      x: {
        round: true,
      },
      color: {
        type: "diverging",
        scheme: "BuRd",
        legend: true,
        label: "Temperature Change (℃) →",
        tickFormat: "+f",
        tickSize: 0,
        style: {fontSize: size},
      },
      marks: [
        Plot.barX(hadcrut, {
          x1: d => d.date, // start of current year
          x2: d => d3.utcYear.offset(d.date), // start of next year
          fill: "value",
          tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.5,
          },
          title: (d) =>
          `${d3.timeFormat("%B %d, %Y")(d["date"])} \nAnomaly: ${d3.format("+.3f")(d["value"])}℃`,
        }),
        ],
    };

    var stocks_baseline = {
      width: width,
      style:{fontSize: size, backgroundColor: backgroundColor, padding: 10},
      margin: width > 450 ? 40 : 30,
      inset: 5,
      color: {
        scheme: "BuRd"
      },
      y: {
        type: "log",
        label: "Change in price (%)",
        grid: true,
        anchor: "left",
        tickSize: 0,
        tickPadding: 6,
        tickFormat: formatChange,
      },
      marks: [
        Plot.ruleY([1]),
        Plot.line(stocks, Plot.normalizeY({
          x: "Date", 
          y: "Close",
          stroke: "Symbol",
          tip: {
            format: {
              x: (d) => formatTime(d),
              y: (d) => formatPercent(d),
            },
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.5,
          }
        })),
        Plot.text(stocks, Plot.selectLast(Plot.normalizeY({
          x: "Date",
          y: "Close",
          z: "Symbol",
          fill: "Symbol",
          text: "Symbol",
          textAnchor: "start",
          fontSize: width > 450 ? 14 : 12,
          fontWeight: 700,
          dx: 3
        })))
        ]
    };

    var anomaly_dot = {
      width: width,
      style: {fontSize: size},
      marginLeft: width/20,
      marginRight: width/100,
      marginTop: 30,
      marginBottom: 20,
      grid: true,
      inset: 4,
      y: {
        nice: true,
        tickFormat: d => d3.format("+.1f")(d) + " ℃",
        label: null,
        tickSize: 0,
        ticks: 4
      },
      x:{
        nice: true,
        tickSize: 0,
      },
      color: {
        scheme: "BuRd",
        range: [0,1.3], // clamping the color scheme so that blue appears below the x axis, red above
        reverse: false,
        legend: true,
        label: "Temperature Change (℃) →",
        tickFormat: "+f",
        tickSize: 0,
        style: {fontSize: size},
      },
      marks: [
        Plot.ruleY([0], {stroke:"rgba(0,0,0,.6)"}),
        Plot.dot(hadcrut, {
          x: "date", 
          y: "value", 
          r: width < 500 ? 1 : 3, 
          opacity: .9, 
          stroke: "value",
          fill: "value", 
          tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.5,
          },
          title: (d) => `${d3.timeFormat("%B %d, %Y")(d["date"])} \nTemp: ${d3.format("+.2f")(d["value"])}℃`, 
        }),
        Plot.lineY(hadcrut, Plot.windowY(12, {x: "date", y: "value", stroke: "currentColor"}))
        ]
    };

    var google_ridgeline = {
      width: width,
      marginRight: width/100,
      x: {
        axis: "top",
        label: null,
        tickFormat: "%B",
        nice: true,
        fontSize: width > 450 ? 14 : 10,
      },
      y: {
        axis: null,
      },
      fy: {
        round: true,
        label: null
      },
      facet: {
        data: google,
        y: "search",
        marginLeft: width > 450 ? width/10 : width/3,
      },
      color: {
        scheme: "tableau10",
        reverse: true,
      },
      marks: [
        Plot.areaY(google, {x: "week", y: "interest", fill: "search", fillOpacity: 0.42, sort: {fy: "y", reduce: "max-index"}}),
        Plot.line(google, {x: "week", y: "interest", stroke: "white", title: (d) => `${d.search}\n${d3.timeFormat("%B %d, %Y")(d["week"])} \nRanking: ${d.interest}`, strokeWidth: 1, tip: {
          opacity: 0.8,
          textPadding: 10,
          lineHeight: 1.5,
        },}),
        Plot.ruleY([0],{stroke:"rgba(204,204,204,.8)"}),
        ]
    };

    var morley = {
      width: width,
      style:{fontSize: size},
      marginLeft: width/20,
      marginRight: width/100,
      marginBottom: 20,
      marginTop: 20,
      y: {
        nice: true,
        clamp: true,
        inset: 6,
        tickSize: 0,
        anchor: "left"
      },
      x:{ label:"Experiment", labelOffset: 40, labelAnchor: "center"},
      marks: [
        boxY(morley, {x: "Expt", y: "Speed", fill:"hsl(43, 89%, 70%)"})
        ]
    };

    var gapminder = { 
      width: width,           
      style:{fontSize: size, textTransform: "capitalize"},
      inset: 2,
      marginLeft: width/33,
      marginRight: width/100,
      marginTop: 20,
      marginBottom: 20,
      y: {
        // grid: true,
        label: "Life Expectency",        
        ticks: 4,
        tickFormat: formatWhole,
        anchor: "left"
      },
      x: { 
        type: "log",
        tickFormat: formatLog,
        label: "GDP Per Capita (log)",
        tickFormat: "~s",
        className: "axis-x",
        labelOffset: -10,
      },
      marks: [
        Plot.dot(gapminder.filter(d => (d.year === 2007)), {
          x: "gdpPercap", 
          y: "lifeExp", 
          r: "pop", 
          fill: "continent",
          channels: {
            country: "country",
          }, 
          tip: {
            format: {
              y: (d) => d + ` years`,
              x: "$~s",
            },
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.65,
          }}),
        Plot.ruleY([40],{stroke:"rgba(204,204,204,.8)"}),
        Plot.ruleX([250],{stroke:"rgba(204,204,204,.8)"}),
        ]
    };

    // https://observablehq.com/@observablehq/plot-bullet-graph
    var bullet = {
      width: width,
      marginLeft: width/100,
      marginRight: width/100,
      marginTop: 30,
      marginBottom: 30,
      style:{fontSize: size-2, textTransform: "capitalize"},
      x: {
        axis: "top",
        grid: true,
        ticks: d3.range(0, 51, 10),
        tickFormat: (d) => (d === 50 ? `${d}%` : `${d}`),
        tickSize: 0
      },
      y: {
        label: null,
        domain: ["80+", "65-79", "50-64", "35-49", "18-34", "0-17" ]
      },
      facet: {
        data: covid,
        x: "race",
        label:
          "Proportion of COVID-19 cases (color) vs. share of population (gray), by race and age"
      },
      color: { scheme: "dark2" },
      marks: [
        Plot.barX(covid, {
          x: "population_percent",
          y: "age",
          fill: "#ddd",
          insetTop: 2,
          insetBottom: 2
        }),
        Plot.barX(covid, {
          x: "cases_percent",
          y: "age",
          fill: "race",
          sort: { fx: "x", reverse: true },
          insetTop: 6,
          insetBottom: 6,
          tip: {
            format: {
              // y: (d) => d + ` years`,
              x: ".2%",
            },
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.65,
          }
        })
      ]
    };

    var dotdensity = {
      width: width,
      marginLeft: width/33,
      marginRight: width/100,
      style:{fontSize: size, background: 'none', textTransform: 'capitalize'},   
      padding: 0.05,
      projection: "albers",
      color: {
        type: "quantize",
        scheme: "GnBu",
        unknown: "#ddd",
        label: "Decade store built",
        legend: true,
        tickSize: 0,
        style: {fontSize: size},
      },

      marks: [
        Plot.geo(nation, {strokeOpacity: 0.9, fill: "#222", opacity: .05}),
        Plot.geo(statemesh, {strokeOpacity: 0.7}),
        Plot.density(walmarts, {
          x: "longitude",
          y: "latitude",
          bandwidth: 3,
          fill: (d) => d.date.getUTCFullYear(),
          opacity: .15
        }),
        Plot.dot(walmarts, {
          x: "longitude", 
          y: "latitude", 
          r: 2, 
          fill: (d) => d.date.getUTCFullYear(),
          opacity: .55,
          tip: {
            format: {
              fill: formatTime,
            },
            opacity: 0.85,
            textPadding: 10,
          },
        }),
        ]
    };

    var dotmap = {
      width: width,
      aspectRatio: 1,
      style:{fontSize: size},
      marginLeft: 0,
      marginRight: 0,
      projection: "equal-earth",
      marks: [
        Plot.graticule(),
        Plot.sphere(),
        Plot.geo(land, {fill: "#ccc"}),
        Plot.delaunayMesh(airports, {x: "longitude", y: "latitude", opacity: 0.4, stroke: "black"}),
        Plot.dot(airports, {fill: "steelblue", opacity:.85, r: 2, x: "longitude", y: "latitude", title: "name", tip: true}),
        ],
    };

    var driving_line = {
      style:{fontSize: size},
      width: width,
      height: 500,
      inset: 10,
      marginLeft: 20,
      marginRight: 10,
      marginTop: 10,
      marginBottom: 10,
      grid: true,
      x: {
        label: "Miles driven per capita each year →",
        labelOffset: 50,
        labelAnchor: "left"
      },
      y: {
        label: "↑ Cost of gasoline ($ per gallon)",
        tickFormat: formatCurrency,
        ticks: 6,
      },
      marks: [
        Plot.line(driving, {x: "miles", y: "gas", curve: "catmull-rom", strokeWidth: 2}),
        Plot.dot(driving, {x: "miles", y: "gas", fill: "white", stroke: "black",title: (d) =>
          `${d3.timeFormat("%B %d, %Y")(d["year"])} \nGas price: ${d3.format("$.2f")(d["gas"])} \nMiles: ${d3.format(",.2r")(d["miles"])}`,}),
        Plot.text(driving.filter(d => (d.year == 1956)), {x: "miles", y: "gas", text: width > 400 ? d => "Annual\naverage" : "", dx: -24, dy: 18, fontSize: 10, fontWeight: 900}),
        Plot.text(driving.filter(d => (d.year == 1956)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+1)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, dy: -2, fontSize: 10}),      
        Plot.text(driving.filter(d => (d.year == 1956+2)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -4, dy: 10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+3)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, dy: -10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+3)), {x: "miles", y: "gas", dx: 12, dy: 90, fontSize: 12, fontWeight: 900, text: d => "↑ Price of\na gallon\nof gasoline"}),
        Plot.text(driving.filter(d => (d.year == 1956+3)), {x: "miles", y: "gas", dx: 12, dy: 130, fontStyle: "italic", textAlign: "left", fontSize: 10, fontWeight: 300, lineHeight: 1.3, text: d => "Annual average for\nregular grade gas,\nadjusted for inflation."}),
        Plot.text(driving.filter(d => (d.year == 1956+4)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 16, 
          dy: -4, fontSize: 10}),
      // Plot.text(driving.filter(d => (d.year == 1956+5)), {x: "miles", y: "gas", text: d => "'61", dx: -2, 
      //   dy: 10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+6)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+7)), {x: "miles", y: "gas", text: width > 400 ? d => (d.year).toFixed(0) : "", dx: -4, 
          dy: 9, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+8)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 2, 
          dy: 10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+9)), {x: "miles", y: "gas", text: d => "'65", dx: 0, 
          dy: 10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+9)), {x: "miles", y: "gas", text: width > 400 ? d => "Cheap gas,\nlonger commutes" : "", dx: 40, dy: -50, fontSize: 12, fontWeight: 900}),
        Plot.text(driving.filter(d => (d.year == 1956+10)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, 
          dy: -9, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+11)), {x: "miles", y: "gas", text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+12)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 18, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+13)), {x: "miles", y: "gas", text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 18, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+14)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 18, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+15)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+16)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+16)), {x: "miles", y: "gas", text: width > 400 ? d => "The Arab\noil embargo" : "", dx: 60, dy: -50, fontSize: 12, fontWeight: 900}),
        Plot.text(driving.filter(d => (d.year == 1956+17)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+18)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: -18,
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+19)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+20)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+21)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: -10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+22)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+23)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+24)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+25)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+26)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+26)), {x: "miles", y: "gas", text: d => "Energy crisis", dx: width > 400 ?40 : 60, dy: -50, fontSize: 12, fontWeight: 900}),
        Plot.text(driving.filter(d => (d.year == 1956+27)), {x: "miles", y: "gas",  text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+28)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+29)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+30)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+31)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, 
          dy: -10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+32)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+33)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: -16, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+34)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: -12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+35)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+36)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+37)), {x: "miles", y: "gas",  text: width > 400 ? d => (d.year).toFixed(0) : "", dx: -18, dy: 1, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+40)), {x: "miles", y: "gas", text: width > 400 ? d => "Record low prices" : "", dx: -6, dy: -80, fontSize: 12, fontWeight: 900}),
        Plot.text(driving.filter(d => (d.year == 1956+38)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+39)), {x: "miles", y: "gas", text: width > 400 ? d => (d.year).toFixed(0) : "", dx: 0, dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+40)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: -10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+41)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+42)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+43)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+44)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -2, 
          dy: -10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+45)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+46)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 4, 
          dy: 10, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+47)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 18, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+48)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+49)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+50)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+51)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 16, 
          dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+52)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+53)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: 0, 
          dy: 12, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+54)), {x: "miles", y: "gas", text: d => (d.year).toFixed(0), dx: -18, dy: 0, fontSize: 10}),
        Plot.text(driving.filter(d => (d.year == 1956+54)), {x: "miles", y: "gas", text: d => "The swing backwards", dx: width > 400 ? -80 : -60, dy: -95, fontSize: 12, fontWeight: 900, style: {background:"white"}}),
        Plot.text(driving.filter(d => (d.year == 1956+54)), {x: "miles", y: "gas", dx: width > 400 ? -80 : -60, dy: -55, fontSize: 10, lineHeight: 1.3, fontWeight: 300, text: d => "The average number of\nmiles that Americans\ndrive annually begins to\nfall, so the chart appear\nto turn around."}),
        ]
};

bands = 7;
step = d3.max(industries, (d) => d.unemployed) / bands;

var horizon_chart = {
  width: width,
  height: width,
  axis: null,
  y: {domain: [0, step]},
  color: {scheme: "YlGnBu", legend: true, label: "Unemployement rate"},
  facet: {data: industries, y: "industry"},
  marks: [
    d3.range(bands).map((i) => Plot.areaY(industries, {x: "date", y: (d) => d.unemployed - i * step, fill: i, clip: true})),
    Plot.text(industries, Plot.selectFirst({text: "industry", frameAnchor: "top-left", dx: 6, dy: 6})),
    Plot.frame()
    ]
};

var bls_line = {
  width: width,
  marginLeft: width/20,
  marginRight: width > 450 ? width/10 : width/5,
  marginTop: 40,
  style:{fontSize: size, textTransform: "capitalize"},
  y: {
    label: "Unemployed (thousands)",
    nice: true,
    clamp: true,
    anchor: "left",    
  },
  x: {
    nice: false,
    clamp: true,
    grid: true,
    tickSize: 0,
  },
  marks: [
    Plot.axisY({
      tickSize: 0, // don’t draw ticks
      dx: 2, // offset right
      dy: -6, // offset up
      lineAnchor: "bottom", // draw labels above grid lines
    }),
    Plot.areaY(bls, {x: "date", y2: "unemployed", z: "industry", fillOpacity: 0.1}),
    Plot.lineY(bls, {x: "date", y: "unemployed", z: "industry", strokeWidth: 1, tip: {
      format: {
        x: (d) => formatDate(d),
      },
      opacity: 0.85,
      textPadding: 10,
    },}),
    Plot.text(bls, Plot.selectLast({filter: d => d.industry !== "Agriculture", x: "date", y: "unemployed", z: "industry", text: "industry", textAnchor: "start", rotate: width > 450 ? 0 : 45, dx: 3, fontSize: width > 450 ? 12 : 8}))
    ]
};

var bls_stacked = {
  width: width,
  marginLeft: width/20,
  marginRight: width/10,
  marginTop: 20,
  marginBottom: 20,
  style:{fontSize: size, textTransform: "capitalize"},
  y: {
    grid: true,
    label: "Unemployed (thousands)",
    ticks: 8,
    tickSize: 0,
    anchor: "left",
  },
  x: {
    tickFormat: "%Y",
    tickSize: 0,
  },
  color: {
    scheme: "Set2",
    reverse: true,
    unknown: "currentColor",
  },
  marks: [
    Plot.axisY({
      tickSize: 0, // don’t draw ticks
      dx: 2, // offset right
      dy: -4, // offset up
      lineAnchor: "bottom", // draw labels above grid lines
    }),
    Plot.areaY(bls, Plot.stackY({x: "date", y: "unemployed", fill: "industry", tip: {
      format: {x: formatDate},
          opacity: 0.8,
          textPadding: 10,
          lineHeight: 1.5,
        },})),
    Plot.text(bls, Plot.selectLast(Plot.stackY({filter: d => d.industry !== "Mining and Extraction",
      x: "date", y: "unemployed", z: "industry", text: "industry", textAnchor: "start", fontSize: width > 450 ? 12 : 10, fontWeight: 700, dx: 3,fill: "industry", rotate: width > 450 ? 0 : 30}))),
    Plot.ruleY([0], {strokeOpacity: 0.2})
    ]
};

var bls_bar = {
  width: width,
  marginLeft: width/10,
  marginRight: width/33,
  marginTop: 40,
  marginBottom: 30,
  style:{fontSize: size, textTransform: "capitalize"},
  x: {
    tickFormat: "%Y",
    tickSize: 0,
    tickRotate: 35,
    nice: true,
  },
  y: {
    grid: true,
    label: "↑ Unemployed (thousands)",
    nice: true,
    anchor: "left",
    tickSize: 0,
  },
  color: {
    type: "ordinal",
    scheme: "Set2",
    reverse: true,
  },
  marks: [
    Plot.axisY({
      tickSize: 0, // don’t draw ticks
      dx: 2, // offset right
      dy: -4, // offset up
      lineAnchor: "bottom", // draw labels above grid lines
    }),
    Plot.rectY(bls, Plot.binX({y: "sum"}, {x: "date", y: "unemployed", fill: "industry", tip: {
      format: {x: formatTime},
          opacity: 0.8,
          textPadding: 10,
          lineHeight: 1.5,
        },}))
    ]
};

var statemap = new Map(stategrid.map(d => [d.name, d]));
var states = statepop.filter((d) => statemap.has(d.State)).map((d) => ({ ...d, ...statemap.get(d.State) }));

change = new function(d){
  return d => (d["2019"] / d["2010"])
};
formatChange = new function(d){
  return ((f) => (d) => f(change(d) - 1))(d3.format("+.0%"));
};
colorContrast = ({ luminance = 60, ...options }) =>
Plot.initializer(options, (data, facets, channels, scales) => {
  const contrast = (color) =>
  d3.hcl(color).l > luminance ? "black" : "white";
  return {
    channels: {
      fill: {
        ...channels.fill,
        scale: undefined,
        value:
              channels.fill == null // when options.fill is a constant color such as "red"
              || scales.color == null // when the scale isn't yet available (e.g. hexbin below)
              ? Array.from(data).fill(contrast(options.fill))
              : Array.from(channels.fill.value, (value) => contrast(scales.color(value)))
            }
          }
        };
      })

var gridmap = {
  width: width,
  style:{fontSize: size},
  aspectRatio: 1,
  axis: null,
  color: {
      type: "diverging-log", // diverging-log scales pivot at 1 by default
      scheme: "piyg",
    },
    marks: [
      Plot.cell(states, {x: "x", y: "y", fill: change}),
      // Plot.text(states, {x: "x", y: "y", text: "key", dy: -2}), // state abbr
      // Plot.text(states, {x: "x", y: "y", text: formatChange, dy: 10, fillOpacity: 0.6}),
      Plot.text(
        states,
        colorContrast({
          luminance: 60,
          x: "x",
          y: "y",
          text: "key", // state abbr
          dy: -6,
          fill: change,
          fontSize: width > 450 ? 14 : 12,
          fontWeight: "bold"
        })
        ),
      Plot.text(
        states,
        colorContrast({
          luminance: 60,
          x: "x",
          y: "y",
          text: formatChange, 
          dy: width > 450 ? 10 : 6,
          fill: change,
          fontSize: width > 450 ? 12 : 10
        })
        ),
      ]
  };

  // https://observablehq.com/@observablehq/plot-state-population-change
  var diverging ={
    width: width,
    style:{fontSize: size-2},
    marginRight: width/33,
    marginLeft: width/33,
    label: null,
    x: {
      axis: "top",
      label: "← decrease  ·  Change in population, 2010–2019 (%)  ·  increase →",
      labelAnchor: "center",
      tickFormat: "+",
      percent: true,
    },
    color: {
      scheme: "PiYg",
      type: "ordinal"
    },
    marks: [
      Plot.barX(statepop, {y: "State", x: (d) => (d[2019] - d[2010]) / d[2010], fill: (d) => Math.sign(d[2019] - d[2010]), sort: {y: "x"}}),
      Plot.gridX({stroke: "white", strokeOpacity: 0.5}),
      Plot.axisY({x: 0}),
      Plot.ruleX([0])
    ]
  };

  // https://observablehq.com/@observablehq/plot-difference-chart
  var difference ={
    width: width,
    style:{fontSize: size, textTransform: "capitalize"},
    marginRight: width/33,
    marginLeft: width/33,
    x: { inset: 4},
    y: { grid: true, label: "Temperature (°F)", tickSize: 0},
    color: { scheme: "RdYlBu", label: "colder" },
    marks: [
      Plot.differenceY(weather, {
        x: "date",
        y1: "New York",
        y2: "San Francisco",
        curve: "step-after",
        positiveFill: () => "NY",
        negativeFill: () => "SF",
        tip: {
          format: {x: formatDate, y: "f"},
          lineHeight: 1.5,
          padding: 10,
          opacity: .9,
        },
      }),
      Plot.text(
        weather,
        Plot.selectMaxY({
          x: "date",
          y: "New York",
          text: () => "New York",
          dy: -6,
          fontSize: 10,
        })
      ),
      Plot.text(weather, {
        ...Plot.selectMaxY({
          x: "date",
          y: "New York"
        }),
        y: "San Francisco",
        text: () => "San Francisco",
        dy: 13,
        fontSize: 10,
      }),
      Plot.text(
        weather,
        Plot.selectMinY({
          x: "date",
          y: "New York",
          text: () => "New York",
          textAnchor: "start",
          dy: -10,
          dx: 6,
          fontSize: 10,
        })
      ),
      Plot.text(weather, {
        ...Plot.selectMinY({
          x: "date",
          y: "New York",
          text: () => "San Francisco"
        }),
        y: "San Francisco",
        dy: -40,
        fontSize: 10,
      })
      ]
  };

// Drug scatter plot 
  var drug_scatter = {     
    width: width,
    marginLeft: width/33,
    marginRight: width/100,
    style:{fontSize: size},
    grid: true,
    y: {        
        nice: true, // Nice is a convenience function that automatically rounds to the nearest whole number
        ticks: 4,
        tickSize: 0,
        tickFormat: formatWhole,
        label: "Physical harm",
      },
      x:{ 
        nice: true, // Nice is a convenience function that automatically rounds to the nearest whole number
        tickSize: 0, 
        anchor: "right",
        label: "Social harm",
        labelOffset: 40,
      },
      marks: [
        Plot.frame(),
      // Draw a dot for each drug in drugs
        Plot.dot(drugs, {x: "Mean Social harm", y: "Mean_Physical_harm",r: "Pleasure", fill: "Drug", tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.5,
          },}),
      // Add a text label above the dot
        Plot.text(drugs, {filter: d => d.Mean_Physical_harm >2.3 || d.Mean_Physical_harm < 1.3, x: "Mean Social harm", y: "Mean_Physical_harm", text: d => d.Drug === "Solvents" ? "" : d.Drug, dy: -12}),
        Plot.ruleX([0], {strokeOpacity: 0}),
        Plot.ruleY([0], {strokeOpacity: 0}),
        ]
    };

    var example_histogram = {
      width: width,
      style:{fontSize: size},
      marginLeft: width/33,
      marginRight: width/100,
      marginTop: 20,
      marginBottom: 40,
      color: {
        type: "diverging",
        scheme: "Sinebow"
      },
      x: {
        round: true,
        label: "Trade volume (log₁₀) →",
        anchor: "left",
      },
      y: {
        grid: true,
        tickSize: 0
      },
      marks: [
        Plot.rectY(aapl, Plot.binX({y: "count", fill:"median"}, {x: d => Math.log10(d.Volume), normalize: true, fill: "Volume", fillOpacity: .9})),
        Plot.ruleY([0])
        ]
    };

    // https://observablehq.com/@observablehq/plot-proportion-plot
    var proportion_data = [
    {
      "age": "16-34’s",
      "population": 30,
      "wealth": 3
    },
    {
      "age": "35-54’s",
      "population": 33,
      "wealth": 32
    },
    {
      "age": "55-74’s",
      "population": 28,
      "wealth": 52
    },
    {
      "age": "Over 75’s",
      "population": 9,
      "wealth": 13
    }];
    const stack = (options) => Plot.stackY({}, { x: "type", y: "value", z: "age", ...options });
    var columns = ["population", "wealth"];
    var proportion_data_flat = proportion_data = columns.flatMap((type) => proportion_data.map((d) => ({ age: d.age, type, value: d[type] })));

    var proportion_plot = {
      width: width,
      marginLeft: width/10,
      marginRight: width/10,
      marginTop: 20,
      marginBottom: 10,
      style:{fontSize: size},
      x: {
        domain: columns,
        axis: "top",
        label: null,
        tickFormat: (d) => `Share of ${d}`,
        tickSize: 0,
          padding: 0 // see margins
        },
        y: {
          axis: null,
          reverse: true
        },
        color: {
          scheme: "prgn",
          reverse: true
        },
        marks: [
          Plot.areaY(
            proportion_data_flat,
            stack({
              curve: "bump-x",
              fill: "age",
              stroke: "white"
            })
            ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "population",
              text: (d) => `${d.value}%`,
              textAnchor: "end",
              dx: -6
            })
            ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "wealth",
              text: (d) => `${d.value}%`,
              textAnchor: "start",
              dx: +6
            })
            ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "population",
              text: "age",
              textAnchor: "start",
              fill: "white",
              fontWeight: "bold",
              dx: +8
            })
            )
          ]
      };

      var stem_plot = {
        width: 240,
        style:{fontSize: size, margin: "auto"},
        axis: null,
        y: {
          domain: d3.range(4, 25).map(String)
        },
        color: {
          domain: "NLB",
          range: ["currentColor", "peru", "brown"],
          legend: true,        
        },
        marks: [
          Plot.text([[1, "4"]], {
            text: ["Northbound"], 
            textAnchor: "start"
          }),
          Plot.text([[-1, "4"]], {
            text: ["Southbound"], 
            textAnchor: "end"
          }),
          Plot.text(new Set(caltrain.map(d => d.hours)), {
            x: 0,
            y: d => d,
            text: d => `${(d - 1) % 12 + 1}${(d % 24) >= 12 ? "p": "a"}`
          }),
          Plot.text(caltrain, Plot.stackX2({
            filter: d => d.orientation === "N",
            x: 1,
            y: "hours",
            text: d => d.minutes.padStart(2, "0"),
            title: d => `${d.time} on line ${d.line}`,
            fill: "type",
            textAnchor: "start",
            tip: true,
          })),
          Plot.text(caltrain, Plot.stackX2({
            filter: d => d.orientation === "S",
            x: -1,
            y: "hours",
            text: d => d.minutes.padStart(2, "0"),
            title: d => `${d.time} on line ${d.line}`,
            tip: true,
            fill: "type",
            textAnchor: "end"
          })),
          Plot.ruleX([-0.5, 0.5])
          ]
      };

      var streamgraph = {
        width: width,
        marginLeft: width/20,
        marginRight: width/9,
        marginTop: 30,
        marginBottom: 10,
        style:{fontSize: size, textTransform: "capitalize"},
        x: {
          tickSize: 0,
          grid: true,
          tickFormat: "%Y",
        },
        y: {
          grid: true,
          label: "Unemployed (thousands)",
          ticks: 8,
          tickSize: 0,
          nice: true,
          clamp: true,
        },
        marks: [
          Plot.areaY(bls, Plot.stackY({
            x: "date",
            y: "unemployed",
            fill: "industry",
            tip: {
              format: {x: formatDate},
              lineHeight: 1.5,
              padding: 10,
              opacity: .9,
            },
            offset: "wiggle"
          })),
          Plot.text(bls, Plot.selectLast(Plot.stackY({
            x: "date", 
            y: "unemployed", 
            z: "industry", 
            text: "industry",
            offset: "wiggle", 
            textAnchor: "start",
            rotate: width > 450 ? 0 : 30,
            dx: 5,
            fill: "industry"}))),
          ]
      };

      var qatar_pyramid = {
        width: width,
        aspectRatio: .05,
        marginLeft: width/15,
        marginRight: width/100,
        style:{fontSize: size},
        color: {
          domain: ["male","female"],
          range: ["steelblue", "#EE7989"]
        },
        x: {
          tickFormat: d => d3.format("~s")(Math.abs(d)),
          label: "← male             female →    (000s)",
          nice: true,
          round: true,
          axis: "bottom",
          labelOffset: 42,
        },
        y: {
          domain: d3.groupSort(qatar, v => parseInt(v[0].age), d => d.age),
          reverse: true,
          label: "Age",
          labelOffset: 30,
          labelAnchor: "Top",
          tickSize: 0,
        },
        marks: [
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            fill: d => d.sex === "male" ? "male" : "female",            
          }),
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            fill: "sex",
            stroke: "white",
            strokeWidth: 3.5,
          }),
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            stroke: "black"
          })
          ],
      };

    // https://observablehq.com/@observablehq/plot-marimekko
      function marimekko({
        x,
        y,
        z,
        value = z,
        anchor = "middle",
        inset = 0.5,
        ...options
      } = {}) {
        const stackX = /\bleft$/i.test(anchor) ? Plot.stackX1 : /\bright$/i.test(anchor) ? Plot.stackX2 : Plot.stackX;
        const stackY = /^top\b/i.test(anchor) ? Plot.stackY2 : /^bottom\b/i.test(anchor) ? Plot.stackY1 : Plot.stackY;
        const [Xv, setXv] = Plot.column(value);
        const {x: X, x1, x2, transform: tx} = stackX({offset: "expand", y, x: Xv});
        const {y: Y, y1, y2, transform: ty} = stackY({offset: "expand", x, y: value});
        return Plot.transform({x: X, x1, x2, y: Y, y1, y2, z, inset, frameAnchor: anchor, ...options}, (data, facets) => {
          const I = d3.range(data.length);
          const X = Plot.valueof(data, x);
          const Z = Plot.valueof(data, value);
          const sum = d3.rollup(I, I => d3.sum(I, i => Z[i]), i => X[i]);
          setXv(I.map(i => sum.get(X[i])));
          tx(data, facets);
          ty(data, facets);
          return {data, facets};
        });
      };

      const xy = (options) => marimekko({...options, x: "market", y: "segment", value: "value"});

      var mosaic = {
        width: width,
        style:{fontSize: size},
        height: 640,
        marginLeft: width/16,
        marginRight: width/33,
        label: null,
        x: {percent: true, ticks: 10, tickSize: 2, tickFormat: (d) => d === 100 ? `100%` : d},
        y: {percent: true, ticks: 10, tickSize: 2, tickFormat: (d) => d === 100 ? `100%` : d},
        marks: [
          Plot.frame({stroke: "#ccc"}),
          Plot.rect(sales, xy({fill: "segment", fillOpacity: 0.5})),
          Plot.text(sales, xy({text: d => [d.value.toLocaleString("en"), d.segment, d.market].join("\n"), fontSize: d => d.value > 1000 ? 14 : 10 })),
          Plot.text(sales, Plot.selectMaxX(xy({z: "segment", text: "segment", anchor: "right", textAnchor: "middle", lineAnchor: "bottom", rotate: 90, dx: 6, size: 6,}))),
          Plot.text(sales, Plot.selectMaxY(xy({z: "market", text: "market", anchor: "top", lineAnchor: "bottom", dy: -6, size: 6,})))
          ]
      };

      var mpg = {
        width: width,
        style: {textTransform: "capitalize",fontSize: size},
        marginLeft: width/33,
        marginRight: width/100,
        marginBottom: 40,
        marginTop: 20,
        x: {label: "City mpg", ticks: 2, labelOffset: 50},
        y: {label: "Highway mpg", ticks: 6, labelOffset: 50, labelAnchor: "center"},
        inset: 4,
        grid: true,
        facet: {
          data : mpg,
          x: "class",
          label: null,
        },
        marks: [
          Plot.dot(mpg, {x: "cty", y: "hwy", fill: "manufacturer", stroke: "manufacturer", strokeWidth: 1, 
            channels: {
              manufacturer: "manufacturer",
              model: "model",
              Class: "class",
            },
            tip: {
              format: {
                manufacturer: true,
                cty: true,
                fx: false,
                stroke: true,
              },
                opacity: 0.9,
                textPadding: 10,
                lineHeight: 1.5,
            }}),
          [Plot.frame()]
          ]
      };

      var numbers = Float64Array.from({length: 10000}, d3.randomNormal.source(d3.randomLcg(3))());
      function percentiles(numbers) {
        const sorted = d3.sort(numbers);
        return d3.range(0, 101).map((q) => d3.quantileSorted(sorted, q / 100));
      }

    // https://observablehq.com/@observablehq/plot-percentogram
      var percentogram = {
        width: width,
        style:{fontSize: size, textTransform: "capitalize"},
        marginLeft: width/100,
        marginRight: width/100,
        marginTop: 30,
        color: {
          legend: true,
          type: "quantize",
          scheme: "spectral",
          n: 10,
          label: "Percentile",
          style:{fontSize: size},
        },
        y: {label: "density"},
        marks: [
          Plot.rectY(numbers, {
            fill: (d, i) => i,
            tip: {
              lineHeight: 1.5,
              padding: 10,
              opacity: .9,
            },
            ...Plot.binX({
              y: (bin, {x1, x2}) => 1 / (x2 - x1),
              thresholds: percentiles
            })
          }),
          Plot.ruleY([0])
          ]
      };


    // From Fil: https://observablehq.com/@fil/waffle-chart
      var waffle = { // Todo replace with waffle mark 
        width: width,
        marginLeft: width/100,
        marginRight: width/100,
        marginTop: 0,
        marginBottom: 0, 
        x: { axis: null },
        y: { axis: null },
        color: { scheme: "Pastel2" },
        marks: [
          Plot.cell(
            units,
            Plot.stackX({
              y: (_, i) => i % 5,
              fill: "label",
              title: "group"
            })
            ),
          Plot.text(
            units,
            Plot.stackX({
              y: (_, i) => i % 5,
              text: "label",
              fontSize: width > 450 ? 10 : 8
            })
            )
          ],
      };

      var irregular = {
      // height: 240,
        width: width,
        style:{fontSize: size},
        x: {
          label: "Commute time (minutes) →",
          ticks: 20,
          labelOffset: 50,
        },
        y: {
          label: "↑ People (per 5 minute interval)",
        transform: (n) => n * 5 /* 5-minute intervals */ * 1000 /* data is in thousands */,
          tickFormat: "~s",
          grid: true,
        },
        marks: [
          Plot.rectY(commute, {
            x1: "lo",
            x2: "hi",
            y: (d) => d.people / (d.hi - d.lo),
            fill: "rgba(204,204,204,.8)",
            insetRight: 1,
            tip: true,
            title: (d) =>
            `${new Intl.NumberFormat("en-US").format(
              d.people / 1000
              )} million people\nspend ${d.lo} to ${
              d.hi
            } minutes\ncommuting to work.`
          }),
          Plot.text(commute, {
            filter: "annotation",
            text: "annotation",
            fontSize: size,
            x: "hi",
            y: (d) => d.people / (d.hi - d.lo),
            dx: 2,
            dy: 2,
            textAnchor: "start"
          }),
          Plot.ruleY([0])
          ]
      };

    // Draw the plots (data fetched)
      document.getElementById("popcorn").appendChild(Plot.plot(popcorn));
      document.getElementById("anomaly_barcode").appendChild(Plot.plot (anomaly_barcode));
      document.getElementById("anomaly_dot").appendChild(Plot.plot (anomaly_dot));
      document.getElementById("apple_area").appendChild(Plot.plot (apple_area));
      document.getElementById("beeswarm").appendChild(Plot.plot (beeswarm));
      document.getElementById("bls_bar").appendChild(Plot.plot (bls_bar));
      document.getElementById("bls_line").appendChild(Plot.plot (bls_line));
      document.getElementById("bls_stacked").appendChild(Plot.plot (bls_stacked));
      document.getElementById("bullet").appendChild(Plot.plot (bullet));
      document.getElementById("candlestick").appendChild(Plot.plot (candlestick));
      document.getElementById("dotdensity").appendChild(Plot.plot (dotdensity));
      document.getElementById("dotmap").appendChild(Plot.plot (dotmap));
      document.getElementById("driving_line").appendChild(Plot.plot (driving_line));
      document.getElementById("drug_scatter").appendChild(Plot.plot (drug_scatter));
      document.getElementById("electricity").appendChild(Plot.plot (electricity));
      document.getElementById("example_histogram").appendChild(Plot.plot (example_histogram));
      document.getElementById("freq_letters").appendChild(Plot.plot (freq_letters));
      document.getElementById("gapminder").appendChild(Plot.plot (gapminder));
      document.getElementById("gridmap").appendChild(Plot.plot(gridmap));
      document.getElementById("google_ridgeline").appendChild (Plot.plot(google_ridgeline));
      document.getElementById("irregular").appendChild (Plot.plot(irregular));
      document.getElementById("morley").appendChild(Plot.plot (morley));
      document.getElementById("mosaic").appendChild(Plot.plot (mosaic));
      document.getElementById("mpg").appendChild(Plot.plot (mpg));
      document.getElementById("percentogram").appendChild(Plot.plot (percentogram));
      document.getElementById("proportion_plot").appendChild(Plot.plot (proportion_plot));
      document.getElementById("qatar_pyramid").appendChild(Plot.plot (qatar_pyramid));
      document.getElementById("stem_plot").appendChild(Plot.plot (stem_plot));
      document.getElementById("stocks_baseline").appendChild(Plot.plot (stocks_baseline));
      document.getElementById("streamgraph").appendChild(Plot.plot (streamgraph));
      document.getElementById("waffle").appendChild(Plot.plot (waffle));
      document.getElementById("horizon_chart").appendChild(Plot.plot (horizon_chart));
      document.getElementById("diverging").appendChild(Plot.plot (diverging));
      document.getElementById("difference").appendChild(Plot.plot (difference));
    });

myDataPromises.catch(function() {
  console.log('🚨 Oops - Something has gone wrong fetching data.')
});

</script>
</body>
</html>