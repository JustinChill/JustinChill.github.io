<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <title>Charts & Data | Justin Chill</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Exploring charts and data presentation styles">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="keywords" content="chart, design, HTML, blog, data visualization">
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="website" property="og:type">
  <meta content="https://justinchill.com/charts.html" property="og:url">
  <meta content="Charts & Data | Justin Chill" property="og:title">
  <meta content="Exploring charts and data presentation styles" property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/charts.html">

  <meta property="og:locality" content="New York">
  <meta property="og:region" content="NY">
  <meta property="og:country_name" content="USA">

  <meta name="datePublished" content="2022-08-14">
  <meta name="dateModified" content="2025-07-06">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Charts & Data | Justin Chill">
  <meta name="twitter:description" content="Exploring charts and data presentation styles">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="preload" href="style.css" as="style" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <style type="text/css">
    .plot text {
      color: #656568;
    }

    article>figure {
      display: flex;
      flex-direction: column-reverse;
    }

    /* 
    article p+ul>li {
      position: relative;
      padding-left: 1em;
      list-style: none;
      text-align: left;
    }

    article p+ul>li:before {
      content: "";
      position: absolute;
      background-color: #cbd5e0;
      border-radius: 50%;
      width: .375em;
      height: .375em;
      top: .6875em;
      left: 0em;
    } */

    article>figcaption {
      margin-right: .25rem;
    }

    article h2 {
      margin-top: var(--spacer-4);
      margin-bottom: 0;
    }

    article h4 {
      color: rgb(101, 101, 104);
    }

    .logogrid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 2rem;
      justify-content: center;
      min-height: 360px;
      margin-bottom: 1rem;
    }

    .logogrid__item {
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: 50px;
    }

    .logogrid__img {
      -o-object-fit: cover;
      object-fit: cover;
      /*max-width: 120px;*/
      filter: grayscale(0) contrast(100%);
      transition: filter 0.25s ease;
    }

    .logogrid__img:hover {
      filter: grayscale(100%) contrast(50%);
    }

    .wrapper {
      overflow: auto;
      padding: 0;
      margin: 0;
    }

    article>figcaption {
      /* margin: 1rem 0; */
      text-align: right;
    }

    #civilizations [class*="-swatches-wrap"] span,
    #gantt [class*="-swatches-wrap"] span {
      font-size: 1rem;
    }

    @media screen and (max-width: 680px) {
      .plot text {
        /*font-size: calc(6px + (22 - 16) * ((100vw - 320px) / (1300 - 320)));*/
        /* padding: 1rem; */
      }

      article>figure {
        grid-column: 2/7;
        margin: 0;
      }

      article>figcaption {
        grid-column: 2/7;
      }

      .logogrid {
        display: grid;
        margin: var(--spacer-2) 0;
        grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
      }
    }

    @media screen and (max-width: 1024px) {
      .logogrid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
      }
    }

    @media print {}
  </style>
</head>

<body>
  <nav class="nav" role="navigation">
    <div class="nav__list">
      <a href="index.html" class="nav__item" aria-label="Homepage">Home</a>
      <a href="blog.html" class="nav__item" aria-label="Blog section">Blog</a>
      <a href="now.html" class="nav__item" aria-label="Now page">Now</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <div class="article-hero">
        <h2 class="article-category">Data viz</h2>
        <h1 class="article-title">Charts on the Internet</h1>
        <h2 class="article-subtitle">Models to visualize quantities, hierarchies, time series and reveal insights in your data</h2>
      </div>

      <section class="logogrid" aria-label="A grid of 36 colorful icons representing various charts and graphs, including bar, pie, line, and scatter plots, each depicted in a minimalist style.">
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-1.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-2.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-3.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-4.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-5.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-6.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-7.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-8.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-9.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-10.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-11.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-12.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-13.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-14.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-15.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-16.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-17.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-18.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-19.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-20.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-21.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-22.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-23.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-24.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-26.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-27.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-28.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-29.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-30.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-31.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-32.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-33.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-34.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-35.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-36.svg" class="logogrid__img" alt="Illustration of a graph"></div>
        <div class="logogrid__item"><img loading="lazy" src="imgs/graph-4.svg" class="logogrid__img" alt="Illustration of a graph"></div>
      </section>

      <p>Presenting data in the form of a chart or graph makes identifying patterns and understanding difficult concepts easier. Visualizations of data can bring out insights to someone looking at the data for the first time, as well as convey findings to others who won’t see, or take the time to parse, the raw data.</p>

      <p>Deciding on which chart is best for your data will depend on multiple factors, such as:</p>

      <ul>
        <li>
          <p>What are the types of metrics, features, or other variables that you plan on plotting? </p>
        </li>
        <li>
          <p>Who is the audience that you plan on presenting to – is it just an initial exploration for yourself, or are you presenting to a broader audience?</p>
        </li>
        <li>
          <p>What is the kind of conclusion that you want the reader to draw?</p>
        </li>
      </ul>

      <p>In this article, we’ll look at frequently used charts and graphs to help you make the best choice for presenting your data.</p>

      <h2>Alluvial diagram</h2>
      <figure>
        <figcaption class="right">Source: <a href="https://www.economist.com/graphic-detail/2015/05/12/seeking-safety">The Economist</a></figcaption>
        <img src="imgs/Asylum_seekers.png" alt="Flowchart illustrating European asylum seeker application decisions in 2012 and 2014. Shows main origin and destination countries, including Afghanistan, Syria, Serbia, and Pakistan, with applications in Germany, Sweden, France, and more. Data source: Eurostat." loading="lazy">
      </figure>
      <p>An alluvial diagram is useful for showing changes over time across categories. Each group of stacked bars represents a variable while the size of each segment represents how many observations in the dataset belong to that segment. The colored flows between the bars represent a group of observations between each variable of the flow. The thickness of the flow indicates how many observations belong to that group.</p>
      <p>In the example above, countries are represented by each bar and the flow tracks refugees as they change countries. Alluvial diagrams are named after <a href="https://en.wikipedia.org/wiki/Alluvial_fan">alluvial fans</a>.</p>

      <h2>Area chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Apple Inc. (<small>AAPL</small>) closing stock price</h3>
      <figure id="apple_area">
        <figcaption class="right">Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      </figure>
      <p>An area chart, or area graph, is a variation on a basic line graph in which the area underneath the line is shaded to represent the total value of each data point. When several data series must be compared on the same graph, stacked area charts are used.</p>
      <p>This method of data visualization is useful for showing changes in one or more quantities over time, as well as showing how each quantity combines to make up the whole. Stacked area charts are effective in showing part-to-whole comparisons.</p>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>World electricity production, by source</h3>
      <figure id="electricity">
        <figcaption>Data: <a href="https://ourworldindata.org/electricity-mix">Our World in Data</a></figcaption>
      </figure>
      <p>A 100% stacked area chart works on the same principle, but each category is plotted as a percentage of an absolute number, with the total adding up to 100%. The y-axis therefore plots percentages instead of numbers. You can quickly identify a 100% stacked chart by its rectangular shape.&nbsp;</p>
      <h2>Bar chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>English letter frequency</h3>
      <figure id="freq_letters">
        <figcaption>Data: <a href="http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html">Cornell</a></figcaption>
      </figure>
      <p>The classic bar chart, or bar graph, is one of the most commonly used method to present&nbsp;quantitative data. In this type of visualization, one axis of the chart shows the categories being compared, and the other, a measured value. The <em>extent</em> (length) of the bar indicates the value for that category. The baseline usually starts at zero.</p>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Global emissions by country</h3>
      <figure id="country_emissions">
        <figcaption class="right">Data: <a href="https://www.iea.org/articles/global-energy-review-co2-emissions-in-2020">IEA</a></figcaption>
      </figure>
      <p>A variation on the regular vertical bar chart is the horizontal bar chart. This orientation is more useful for comparing categories.</p>
      <p>Bar Charts are distinguished from <a href="#">Histograms</a> because they do not display continuous developments over an interval. Instead, the data displays <em>discrete</em> (categorical) data. Bar charts therefore answer the question of "how many?" in each category.</p>
      <h2>Barcode chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Earth surface temperature anomalies</h3>
      <figure id="anomaly_barcode">
        <figcaption>Data: <a href="https://ourworldindata.org/grapher/hadcrut-surface-temperature-anomaly?tab=table">Our World in Data</a></figcaption>
      </figure>
      <p>A compact way to show a distribution. In a barcode chart, line segments represent individual data points along a single axis.</p>
      <h2>Baseline chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Stock Price Comparison</h3>
      <figure id="stocks_baseline">
        <figcaption>Market Data: <a href="https://www.wsj.com/market-data">Wall Street Journal</a></figcaption>
      </figure>
      <p>A baseline chart uses a reference point, which becomes the baseline, to compare all the other categories to. In business, the success of a project or product is often measured against a <strong>baseline</strong> number for costs, sales, or other variables. A project may exceed a baseline number or fail to meet it.</p>
      <h2>Beeswarm </h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>US Presidents</h3>
      <figure id="beeswarm" class="mid-size"></figure>
      <p>Beeswarm plots are a fun, visually pleasing alternative to histograms that can be used when data is sufficiently small and you want to plot every point. A beeswarm chart is a one-dimensional chart that shows all the information on a single-axis (usually the X axis). It is similar to a strip plot, except that would-be overlapping points are separated such that each is visible. </p>
      <h2>Box and Whisker Plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Michaelson-Morley speed of light data</h3>
      <figure id="morley">
        <figcaption class="right">Data: <a href="http://stats4stem.weebly.com/r-morley-data.html">Morley dataset</a></figcaption>
      </figure>
      <p>A box and whisker plot, or box plot, provides a visual summary of data through its quartiles. A box plot is constructed from five values:</p>
      <ul>
        <li>The minimum value</li>
        <li>The 1<sup>st</sup> quartile</li>
        <li>The median value</li>
        <li>The 3<sup>rd</sup> quartile</li>
        <li>The maximum value</li>
      </ul>
      <p>We use these values to compare how close other data values are to them.</p>
      <p> First, a box is drawn from the first quartile to the third of the data set. A line within the box represents the median. “Whiskers,” or lines, are then drawn extending from the box to the minimum (lower extreme) and maximum (upper extreme). Outliers are represented by individual points that are in-line with the whiskers.</p>
      <p>This type of chart is helpful in quickly identifying whether or not the data is symmetrical or skewed, as well as providing a visual summary of the data set that can be easily interpreted.</p>
      <h2>Bubble chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Wealth and Health of Nations, 2007</h3>
      <figure id="gapminder">
        <figcaption class="right">Data: <a href="https://www.gapminder.org/data/">GapMinder Foundation</a></figcaption>
      </figure>
      <p>A bubble chart is a variation of a scatter chart in which the data points are replaced with bubbles, and an additional dimension of the data is represented in the size of the bubbles. Just like a scatter chart, a bubble chart does not use a category axis — both horizontal and vertical axes are value axes. In addition to the x values and y values that are plotted in a scatter chart, a bubble chart also z (size) values.</p>
      <h2>Bullet chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>COVID Tracking Project</h3>
      <h4>Proportion of COVID-19 cases (color) vs. share of population (gray), by race and age</h4>
      <figure id="bullet">
        <figcaption class="right">Data: <a href="https://covidtracking.com/race">The COVID Racial Data Tracker</a></figcaption>
      </figure>
      <p>A bullet graph is a variation of a bar graph that can act as an alternative to dashboard gauges to represent performance data. The main use for a bullet graph is to inform the viewer of how a business is performing in comparison to benchmarks that are in place for key business metrics.</p>
      <p>In a bullet graph, the darker horizontal bar in the middle of the chart represents the actual value, while the vertical line represents a comparative value, or target. If the horizontal bar passes the vertical line, the target for that metric has been surpassed. Additionally, the segmented colored sections behind the horizontal bar represent range scores, such as “poor,” “fair,” or “good.”</p>
      <h2>Bump chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h2>Petrostate</h2>
      <h4>Natural gas exports</h4>
      <figure id="bumpGas">
        <figcaption class="right">Data: International Institute for Sustainable Development (IISD) and IEA</figcaption>
      </figure>
      <p>A bump chart is a chart that helps you identify the change in the performance rankings over time rather than the magnitude of the values of the elements (categories).</p>
      <h2>Cartogram</h2>
      <figure class="">
        <figcaption class="right">Image: <a href="https://www.nytimes.com/interactive/2020/08/11/us/politics/vote-by-mail-us-states.html">New York Times</a></figcaption>
        <img src="https://static01.nyt.com/newsgraphics/2016/11/01/election-map-forms/738e8fe0f4e6d89ec6cb63555d3deb92e772f916/cartogram.png" alt="A map of the United States uses a square graphic to show voting practices by state. Blue indicates states won by John Kerry and red the states won by Bush, by percent of vote." loading="lazy">
      </figure>
      <p>Cartograms distort the shape of geographic regions so that the area directly encodes a data variable. A common example is to redraw every country in the world sizing it proportionally to population or GDP. Can be done by circles, squares or distorted maps by manipulating the initial map.</p>
      <h2>Candlestick Chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Apple Inc. (<small>AAPL</small>) stock price</h3>
      <figure id="candlestick">
        <figcaption class="right">Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      </figure>
      <p>A candlestick chart is popular for tracking price movements on a stock exchange. In the chart above, the end points of the black line show the highest and lowest trading values during that day, while the ends of the thicker line show the open and closing price. Color indicates if the price went <span style="border-bottom: 2px solid red">down</span> or <span style="border-bottom: 2px solid green">up</span> during the day. They are visually similar to box plots, though box plots show different information.</p>
      <h2>Chord diagram</h2>
      <figure>
        <figcaption class="right">Created by <a href="https://lotr.visualcinnamon.com">Nadieh Bremer</a></figcaption>
        <a href="https://lotr.visualcinnamon.com/"><img src="https://uploads-ssl.webflow.com/5fa9d88da1855554db37b1e1/5fb1377b21d82ea1d953ef91_lotr_final.png" alt="A circular diagram showing connections between various colored segments labeled with names from The Lord of the Rings alongside decorative Elvish script. The segments depict character interactions and relationships." loading="lazy"></a>
      </figure>
      <p>This type of diagram visualizes the inter-relationships between entities. The connections between entities are used to display that they share something in common. This makes chord diagrams ideal for comparing the similarities within a dataset or between different groups of data.</p>
      <h2>Choropleth map</h2>
      <figure>
        <figcaption class="right">ZIP codes explained <a href="inf-hoe-graphic.html">here</a></figcaption>
        <img src="imgs/ZIP3_zones.svg" loading="lazy" alt="A map of the contiguous United States showing the Area Codes where rapper Ludacris claims to have hoes.">
      </figure>
      <p>A choropleth map is simply a shaded map. Specifically, it's a map that uses measured differences in shading or color or the placing of symbols inside defined areas on the map in order to indicate the average values of some property or quantity in those areas. Be careful with your color choices, as they can easily change what the map shows.</p>
      <h2>Connected scatter plot</h2>
      <span class="header-tag mid-size"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3 class="mid-size">Driving shifts into reverse</h3>
      <figure id="driving_line" class="mid-size">
        <figcaption class="right">Data: <a href="http://www.nytimes.com/imagepages/2010/05/02/business/02metrics.html">New York Times</a></figcaption>
      </figure>
      <p>A connected scatterplot is a line chart where each data point is shown with a marker, usually a circle or dot. A cross between a scatterplot and a time series graph, the connected scatter plot helps visualize two (2) variables over time.</p>
      <p>As shown in the chart above, Americans have until recently driven more each year than the previous one, with a few brief exceptions. In 1956, Americans of driving age drove about 4,000 miles a year, on average. Fifty years later, that figure had climbed above 10,000. </p>
      <h2>Density plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Unemployment by industry</h3>
      <figure id="bls_line">
        <figcaption class="right">Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      </figure>
      <p>A density plot visualizes the distribution of data over a continuous interval or time period. This chart is a variation of a histogram that uses <em>kernel smoothing</em> to plot values. Kernel smoothing allows for smoother distributions by smoothing out the noise in data.</p>
      <p>One advantage density plots have over histograms is that they're better at determining the distribution shape because they're not affected by the number of bins used (each bar used in a typical histogram). A histogram comprising of only 4 bars wouldn't produce a distinguishable enough shape of distribution as a 20 bar histogram would. Density plots have essentially infinite bins.</p>
      <h2>Diverging bar chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Change in state population, 2010–2019 (%)</h3>
      <figure id="diverging">
        <figcaption class="right">Data: <a href="https://www.census.gov/data/tables/time-series/demo/popest/2010s-state-total.html">Census.gov</a></figcaption>
      </figure>
      <p>A diverging bar chart is a bar chart that has the marks for some dimension members pointing up or right, and the marks for other dimension members pointing in the opposite direction (down or left, respectively). What’s unique about a diverging bar chart is the marks flowing down or left do not necessarily represent negative values. The divergent line can represent zero, but it can also be used to simply separate the marks for two dimension members, to represent a goal, or – as often seen with survey data – to show the break between desired and undesired responses.</p>
      <p>A drawback to using diverging bar charts is that it’s not as easy to compare the values across dimension members as it is with a grouped bar chart. If, on the other hand, your primary objective is to compare the trend of each individual dimension member, a divergent bar chart is a good option.</p>
      <h2>Difference chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Hot properties</h3>
      <figure id="difference">
        <figcaption class="right">Data: NOAA</figcaption>
      </figure>
      <p> A difference chart highlights the difference between two values, typically entries vs exits. The amount is encoded as height, and the sign (surplus vs. deficit) as a solid color. In the chart above, we compare the temperatures on the same day; days when San Francisco was warmer are <span style="border-bottom: 2px solid orange;">orange</span>, and colder days are <span style="border-bottom: 2px solid steelblue;">blue</span>.</p>
      <h2>Donut chart 🍩</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Top 20 countries by emissions</h3>
      <figure id="donut_emissions">
        <figcaption class="right">Data: <a href="https://www.census.gov/data.html">U.S. Census</a></figcaption>
      </figure>
      <p>A donut chart is a pie chart with an area of the center cut out. It looks like a donut. That’s why it’s called a donut chart.</p>
      <p>Pie charts are sometimes criticized for focusing readers on the proportional areas of the slices to one another and to the chart as a whole. This makes it tricky to see the differences between slices, especially when you try to compare multiple pie charts together. A donut chart somewhat remedies this problem by de-emphasizing the use of the area. Readers therefore focus more on reading the length of the arcs, rather than comparing the proportions between slices.</p>
      <h2>Dot density map</h2>
      <figure id="dotdensity">
        <figcaption class="right">Data: <a href="Walmart.html">Walmart stores</a></figcaption>
      </figure>
      <p>Dot density maps are a simple yet highly effective way to show density differences in geographic distributions across a landscape. Dot density maps have been popular for 150 years because they are easy to understand and, at a glance, show us intuitively where things clump or cluster. There are two basic types: <strong><em>one-to-one dot density maps</em></strong> (one dot represents one object or count) and <strong><em>one-to-many dot density maps</em></strong> in which one dot stands for a number of things or a value (e.g., 1 dot = 1,000 acres of wheat production).</p>
      <p>There are at least three big advantages of dot density maps over choropleth maps:</p>
      <ol>
        <li>
          <p> On a dot density map you can map <em>raw data / simple counts</em> (e.g., number of school) or <em>rates and ratios</em> (e.g., number of schools per square mile).</p>
        </li>
        <li>
          <p> You can use more types of data, not just <a href="https://en.wikipedia.org/wiki/Enumerated_type">enumerated</a> data.</p>
        </li>
        <li>
          <p> Dot density maps work fine in black and white, when color isn’t an option.</p>
        </li>
      </ol>
      <h2>Dot map</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>World airports</h3>
      <figure id="dotmap">
        <figcaption class="right">Data: <a href="https://observablehq.com/@d3/world-airports">World airports</a></figcaption>
      </figure>
      <p>Dot maps are a way of detecting spatial patterns or the distribution of data over a geographical region, by placing equally sized points over a geographical region.</p>
      <p>Dot maps are ideal for seeing how things are distributed over a geographical region and can reveal patterns when the points cluster on the map. Dot maps are easy to grasp and can provide a quick overview of the data, but are not great for comparing exact values.</p>
      <h2>Dot plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Surface temperature anomalies</h3>
      <figure id="anomaly_dot">
        <figcaption class="right">Data: <a href="https://ourworldindata.org/grapher/hadcrut-surface-temperature-anomaly?tab=table">Our World in Data</a></figcaption>
      </figure>
      <p>A generalized form of the scatter plot, the dots can be placed in various coordinate systems on an x- and y-axis. A dot plot is similar to a histogram in that it displays the number of data points that fall into each category or value on the axis, thus showing the distribution of a set of data.</p>
      <h2>Frequency trails</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Google search trends, 2020</h3>
      <figure id="google_ridgeline">
        <figcaption class="right">Data: <a href="https://trends.google.com/trends/?geo=US">Google</a></figcaption>
      </figure>
      <p>Frequency trails, also known as joy plots, is a visualization method to show multiple distributions at once. Taken individually, each distribution is shown as a density curve; taken together and they overlap one another for a three-dimensional effect. They're essentially a series of layered line graphs which build up to give the impression of a 3D landscape. They owe their name to the cover of Joy Division's 1979 album <em>Unknown Pleasures</em>. Luis Carli provides an interactive explainer for the method in <a href="https://cartographicperspectives.org/index.php/journal/article/view/1536/1725"><em>Cartographic Pleasures: Maps Inspired by Joy Division’s Unknown Pleasures Album Art</em></a>.</p>
      <h2>Gantt chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Journey into Mordor</h3>
      <figure id="gantt">
        <figcaption class="right">Data: <a href="https://scifi.stackexchange.com/questions/7304/what-is-the-timeline-for-the-lord-of-the-rings-trilogy">tolkiengateway.net</a></figcaption>
      </figure>
      <p>Gantt charts are particularly common in project management, as they’re useful in illustrating a project timeline or progression of tasks. In this type of chart, tasks to be performed are listed on the vertical axis and time intervals are on the horizontal axis. Horizontal bars in the body of the chart represent the <strong>duration</strong> of each activity.</p>
      <p>Utilizing Gantt charts to display timelines can be incredibly helpful, and enable team members to keep track of every aspect of a project. Even if you’re not a project management professional, familiarizing yourself with Gantt charts can help you stay organized.</p>
      <p>Gantt charts were designed and popularized by <a href="https://en.wikipedia.org/wiki/Gantt_chart#cite_note-FOOTNOTEGantt1910-2">Henry Gantt</a> around the years 1910–1915.</p>
      <h2>Glyph chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Animals in the zoo</h3>
      <figure id="animals">
        <figcaption class="right">Data: The zoo</figcaption>
      </figure>
      <p>Glyph charts are a common form of visual design where data is depicted by a collection of visual objects referred to as <em>glyphs</em>. In the context of data visualization, a glyph is any marker, such as an arrow, dot, or symbol, used to specify part of a visualization. The design of glyphs can make use of many different visual channels such as shape, color, texture, size, orientation, aspect ratio or curvature<a href="#glyph" aria-describedby="footnote-label" id="glyph-ref"></a>.</p>
      <p>A major strength is that patterns of multivariate data involving more than two attribute dimensions can often be more readily perceived in the context of a spatial relationship, whereas many techniques for spatial data such as direct volume rendering find difficult to depict with multivariate or multi-field data, and many techniques for non-spatial data such as parallel coordinates are less able to convey spatial relationships encoded in the data.</p>
      <h2>Grid map</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Population change from 2010 to 2019</h3>
      <figure id="gridmap">
        <figcaption></figcaption> <!-- Recreation: https://observablehq.com/@zanarmstrong/us-grid-map-and-observable-plot -->
      </figure>
      <p>A grid map, also known as a tile grid, represents regions using equal-sized blocks instead of precise geographic boundaries. This provides equal visual attention to all. Complex grid maps contain entire charts within each block, from an area chart to a Sankey diagram.</p>
      <p><strong>Grid maps</strong> are excellent for comparing data across regions, especially when they vary in size or importance. Unlike regular maps, which make larger areas seem more significant, grid maps give equal space to every region, <strong>making it easier to compare data and spot trends</strong>, such as election results, or shifts in population across states or countries. In short, they are:</p>
      <ol>
        <li><strong>Easy to understand:</strong> They are less cluttered, so it’s easier to compare information across regions or categories. </li>
        <li><strong>Minimize bias:</strong> Grid maps remove the visual bias that larger areas might otherwise create in traditional maps.</li>
        <li><strong>Fair comparison:</strong> Each region is the same size, so the data— rather than its size or importance — stands out.</li>
        <li><strong>Highly customizable:</strong> You can add colors, labels, and other details to help your visualization tell a clear and compelling story.</li>
      </ol>
      <h2>Heatmap</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Steph Curry popcorn ratings</h3>
      <figure id="popcorn">
        <figcaption class="right">Source: <a href="popcorn.html">Steph Curry, NYT</a></figcaption>
      </figure>
      <p>Heat maps visualize data through variations in coloring. When used like a table, heat maps are useful for cross-examining multivariate data, by placing variables in the rows and columns and coloring each cell within the table. Heat maps are good for showing variance across multiple variables, revealing any patterns, displaying whether any variables are similar to each other, and for detecting if any correlations exist in-between them.</p>
      <p>There are many possible applications of heat maps. For example, if you want to analyze which time of day a retail store makes the most sales, you can use a heat map that shows the day of the week on the vertical axis and time of day on the horizontal axis. Then, by shading in the matrix with colors that correspond to the number of sales at each time of day, you can identify trends in the data that allow you to determine the exact times your store experiences the most sales. Or you can visualize popcorn quality by NBA arena.</p>
      <h2>Histogram</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Apple Inc. (<small>AAPL</small>) trading volume</h3>
      <figure id="example_histogram">
        <figcaption>Data: <a href="https://observablehq.com/@observablehq/plot-area">Apple stock price</a></figcaption>
      </figure>
      <p>A histogram looks like a bar chart, but it reads differently. The baseline is continuous instead of discrete categories, which allows one to see distributions. Histograms help give an estimate as to where values are concentrated, what the extremes are and whether there are any gaps or unusual values. They are also useful for giving a rough view of the probability distribution.</p>
      <p>Histograms are especially useful for showing the frequency of a particular occurrence. For instance, if you’d like to show how many clicks your website received each day over the last week, you can use a histogram. From this visualization, you can quickly determine which days your website saw the greatest and fewest number of clicks.</p>
      <h2>Horizon graph</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Unemployment rate by industry</h3>
      <figure id="horizon_chart">
        <figcaption class="right">Data: <a href="https://observablehq.com/@observablehq/plot-unemployment-horizon-chart">Bureau of Labor Statistics</a></figcaption>
      </figure>
      <p>A horizon chart is a compact version of an area chart. It's a bit like an area chart that is sliced into equal horizontal intervals and collapsed down into single bands, which makes the graph more compact.</p>
      <blockquote>
        <p>Horizon charts are especially useful when you are visualizing time series data that are so close in value so that the data marks in, for example, a line chart, would lie atop each other. … the purpose of the horizon chart is not necessarily to enable readers to pick out specific values, but instead to easily spot general trends and identify extreme values.</p>
        <cite class="right">&mdash; <a href="https://statisticaloddsandends.wordpress.com/2022/03/31/what-is-a-horizon-chart/comment-page-1/">Jonathan Schwabish</a></cite>
      </blockquote>
      <h2>Line chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Historical Debt Outstanding</h3>
      <figure id="example_line">
        <figcaption class="right">Data: <a href="https://fiscaldata.treasury.gov/datasets/historical-debt-outstanding/historical-debt-outstanding">US Treasury</a></figcaption>
      </figure>
      <p>A line chart, also referred to as a line graph or a line plot, connects a series of data points using a line. Often the x-axis (horizontal axis) represents a sequential progression of values, where each element is related to the previous one, to help spot trends. The y-axis (vertical axis) then tells you the values for a selected metric across that progression.</p>
      <p>This is a common chart and is great to use when you want to show data over time. One use case could be tracking the interest of consumers in a type of product or service throughout the year to make predictions for the year ahead.</p>
      <p>The line chart above uses a <em>logarithmic</em>, or log, scale. <a href="https://www.highcharts.com/blog/tutorials/when-should-you-use-logarithmic-or-linear-scales-in-charts/">Log scales</a> are used when the values of the data vary over a wide range, such as population growth.</p>
      <h2>Lollipop chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>English letter frequency</h3>
      <figure id="lollipop"></figure>
      <p>A lollipop chart is a type of graph that is similar to a bar chart, but uses a line and a dot instead of a bar. The dot represents the value, and the line is anchored from the x-axis. The lollipop chart is often claimed to be useful compared to a normal bar chart, if you are dealing with a large number of values and when the values are all high, such as in the 80-90% range (out of 100%). Then a large set of tall columns can be visually aggressive.</p>
      <p>This chart has some disadvantages: the center of the circle at the end of the lollipop marks the value, but the location of the centre is difficult to judge, making it imprecise compared to the straight edge of a bar, and half of the circle extends beyond the value that it represents, making it inaccurate.</p>
      <h2>Mosaic plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Fruit salad sales</h3>
      <figure id="mosaic">
        <figcaption class="right">Data: <a href="https://observablehq.com/@observablehq/plot-marimekko">Fictional sales</a></figcaption>
      </figure>
      <p>Also known as a Marimekko diagram, this chart uses the width and height of rectangles to represent separate variables. It can be useful to represent multidimensional data. The main flaws of Marimekko charts are that they can be hard to read, especially when there are many segments. Also, it's hard to accurately make comparisons between each segment, as they are not all arranged next to each other along a common baseline. Therefore, Marimekko charts are better suited for giving a more general overview of the data.</p>
      <h2>Network graph</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>The complete ARPANET, December 1969</h3>
      <figure id="network">
        <figcaption class="right">Data: <a href="http://mercury.lcs.mit.edu/~jnc/tech/arpageo.html">MIT</a></figcaption>
      </figure>
      <p>This type of visualization shows how things are interconnected through the use of nodes and link lines. Typically, nodes are drawn as dots or circles, but icons can also be used. Links are usually displayed as lines connecting nodes. However, in more elaborate network diagrams, not all of the nodes and links are created equally: additional variables can be shown by making the node size or link stroke weight proportional to an assigned value.</p>
      <p>There are many use cases for network diagrams, including depicting social networks, highlighting the relationships between employees at an organization, or visualizing product sales across geographic regions.</p>
      <h2>Organogram</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/tree_diagram.png" alt="A hierarchical tree diagram with multiple branches connecting rectangular nodes, arranged symmetrically. Each level splits into increasing numbers of nodes, creating a structured and balanced network." loading="lazy">
      <p>An organogram is an organizational chart that shows the structure of an organization and the relationships and relative ranks of its parts and positions/jobs. A variation is a tree diagram, which shows the different elements of a field of knowledge or a group of languages.</p>
      <h2>Packed bubble chart</h2>
      <figure>
        <figcaption>Data: <a href="https://www.nytimes.com/2020/12/05/health/covid-vaccine-first.html">New York Times</a></figcaption>
        <img src="https://flowingdata.com/wp-content/uploads/2020/12/Defining-essential-worker-1536x1476.png" alt="A bubble chart illustrating U.S. essential and frontline workers by occupation. Bubbles represent various sectors like healthcare, education, and food services, scaled by worker numbers. Colors differentiate essential from frontline roles." loading="lazy">
      </figure>
      <p>Circle size represents data like with a bubble chart, but there is typically no x-y axis. Instead, bubble position often represents grouping or is used to maximize space.</p>
      <h2>Parallel coordinates</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Cars from the 70s & 80s</h3>
      <img src="https://datavizcatalogue.com/methods/images/top_images/SVG/parallel_coordinates.svg" alt="Parallel coordinates chart." loading="lazy">
      <!-- <figure id="parallel"></figure> -->
      <p>Parallel coordinate plots are ideal for comparing many variables together and seeing the relationships between them. In the above example, models of cars produced in the 1970s and '80s are compared across multiple variables. Chris Evans created a <a href="http://www.columbia.edu/~cme2126/datavisuals/bigdata_parallelcoordinates.html">more elaborate example</a> using the same data set.</p>
      <p>In a parallel coordinates plot, each variable is given its own axis and all the axes are placed in parallel to each other. Each axis can have a different scale, as each variable works off a different unit of measurement, or all the axes can be normalized to keep all the scales uniform. Values are plotted as a series of lines that connected across all the axes. This means that each line is a collection of points placed on each axis, that have all been connected together.</p>
      <h2>Parallel sets</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/parallel_sets.png" alt="A colorful flowchart with layered green and yellow bands connecting various rectangular sections, illustrating data relationships and movements across different categories." loading="lazy">
      <p>Parallel Set charts are similar to Sankey Diagrams in the way they show flow and proportions. However, Parallel Sets don’t use arrows and they divide the flow-path at each displayed line-set. Each line-set corresponds to a dimension/dataset, which its values/categories are represented in each line divide in that line-set. The width of each line and the flow-path that stems from it is determined by the proportional fraction of the category total. Each flow-path can be colored to show and compare the distribution between different categories.</p>
      <h2>Percentogram</h2>
      <figure id="percentogram">
        <figcaption class="right">Data: <a href="https://statmodeling.stat.columbia.edu/2023/04/13/the-percentogram-a-histogram-binned-by-percentages-of-the-cumulative-distribution-rather-than-using-fixed-bin-widths/">Andrew Gelman</a></figcaption>
      </figure>
      <p>The “<a href="https://statmodeling.stat.columbia.edu/2023/04/13/the-percentogram-a-histogram-binned-by-percentages-of-the-cumulative-distribution-rather-than-using-fixed-bin-widths/">percentogram</a>” is a histogram binned by percentages of the cumulative distribution, rather than using fixed bin widths. Put simply, it is like a histogram or density plot in that is shows the overall shape of the distribution, where each bar is made to have the same area and to specifically represent a chosen percentage. A percentogram makes it easy to assess how much of a distribution is falling in particular ranges.</p>
      <h2>Pictogram</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Phish set list, NYE 2019</h3>
      <figure>
        <figcaption class="right">Data: <a href="https://observablehq.com/@mayagans/day-2-pictograms">Maya Gans</a></figcaption>
        <img src="imgs/phish.svg" alt="A pictogram of the Phish set list from New Years eve, 2019." loading="lazy">
      </figure>
      <p>Pictogram, or pictograph, charts use icons to give a more engaging overall view of small sets of discrete data. Typically, the icons represent the data’s subject or category. Each icon can represent one unit or any number of units (e.g. each icon represents 10). Data sets are compared side-by-side in either columns or rows of icons, to compare each category to one another.</p>
      <p>Pictogram charts are particularly useful for presenting simple data in a more visual and engaging way. These charts use icons to visualize data, with each icon representing a different value or category. For example, data about time might be represented by icons of clocks or watches. Each icon can correspond to either a single unit or a set number of units (for example, each icon represents 100 units).</p>
      <h2>Pie chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>United States population, 2015</h3>
      <figure>
        <figcaption class="right">Data: <a href="https://www.census.gov/data.html">U.S. Census</a></figcaption>
        <img src="imgs/pie_chart.svg" loading="lazy" alt="The United States population in 2015, represented in a pie chart.">
      </figure>
      <p>Pie charts are one of the most common and basic data visualization techniques, used across a wide range of applications. Pie charts are ideal for illustrating proportions, or part-to-whole comparisons.</p>
      <p>Pie charts help show proportions and percentages between categories by dividing a circle into proportional segments. The length of each arc represents a proportion of each category, while the full circle represents the total sum of all the data, equal to 100%.</p>
      <p>Because pie charts are relatively simple and easy to read, they’re best suited for audiences who might be unfamiliar with the information or are only interested in the key takeaways. For viewers who require a more thorough explanation of the data, pie charts fall short in their ability to display complex information.</p>
      <h2>Proportion Plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Who owns Britain?</h3>
      <figure id="proportion_plot">
        <figcaption class="right">Data: <a href="https://stephanieevergreen.com/proportion-plots/">U.K. Office for National Statistics</a></figcaption>
      </figure>
      <p>Pioneered by <a href="https://stephanieevergreen.com/proportion-plots/">Stephanie Evergreen</a>, proportion plots are useful to highlight differences between the share of a population across two metrics. It uses length on the left and right side of the chart and connects the lengths by a band in the middle that swoops a lot if there is disproportionality and stays pretty even if the proportions are the same. In the above chart we examine Richard Speigal’s <a href="https://www.linkedin.com/feed/update/urn:li:activity:6758306750174138368/">“Who owns Britain?</a>” chart, highlighting age class inequalities in Britain.</p>
      <h2>Population Pyramid chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Population of Qatar, 2019</h3>
      <figure id="qatar_pyramid">
        <figcaption>Data: <a href="https://population.un.org/wpp/Download/Standard/Population/">World Population Prospects, U.N., 2019</a></figcaption>
      </figure>
      <p>A population pyramid chart is a pair of back-to-back histograms (for each sex) that displays the distribution of a population in all age groups and in both sexes. The X-axis is used to plot population numbers and the Y-axis lists all age groups.</p>
      <h2>Radar chart</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/radar_chart.png" alt="Two side-by-side radar charts: the left chart is red with five uneven points, and the right chart is yellow with five symmetrical points, resembling a star. Both charts have scales from 0 to 10." loading="lazy">
      <p>Radar charts (also known as spider chart, web chart, polar chart, or star plots) are a way of comparing multiple quantitative variables. This makes them useful for seeing which variables have similar values or if there are any outliers among each variable. Radar Charts are also useful for seeing which variables are scoring high or low within a dataset, making them ideal for displaying performance.</p>
      <h2>Renko chart</h2>
      <figure id="renko"></figure>
      <p>Renko charts capture relevant periods of activity of a time series by adding a “brick” of a fixed horizontal and vertical size each time the value ventures too far away from the current brick. The time axis is compressed during periods of minor change, and conversely expanded during more active periods, allowing the user to focus on actual change.</p>
      <p>Renko charts seem to be used mainly (or solely?) in <small>FOREX</small> trading, a domain that is definitely foreign to me. For comparison, here is the same plot on the traditional linear time scale:</p>
      <figure id="renko_comparison"></figure>
      <h2>Sankey diagram</h2>
      <figure>
        <figcaption>Data: <a href="https://www.nytimes.com/interactive/2018/03/19/upshot/race-class-white-and-black-men.html">New York Times</a></figcaption>
        <img src="https://flowingdata.com/wp-content/uploads/2018/03/Black-boys-dropping-income-levels-1090x582.png" alt="Flow chart showing the adult income outcomes of 5,393 boys raised in wealthy families, categorized by wealth and race. Many white boys stay rich, whereas fewer Black boys maintain wealth, with disparities evident at all income levels." loading="lazy">
      </figure>
      <p>Sankey Diagrams display flows and their quantities in proportion to one another. Typically used to show the transfer of energy, money or materials, but they can be used to show the flow of any isolated process in a system. The width of the arrows or lines are used to show their magnitudes, so the bigger the arrow, the larger the quantity of flow. Flow arrows or lines can combine together or split through their paths on each stage of a process. Color can be used to divide the diagram into different categories or to show the transition from one state of the process to another.</p>
      <h2>Scatter plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>The relative harm of drugs</h3>
      <figure id="drug_scatter">
        <figcaption>Data: David Nutt for <a href="https://www.drugscience.org.uk">Drug Science</a></figcaption>
      </figure>
      <p>Also known as a scatter graph, point graph, X-Y plot, scatter chart or scattergram. A scatter plot displays data for two variables as represented by points plotted against the horizontal and vertical axis. This type of data visualization is useful in illustrating the relationships that exist between variables and can be used to identify trends or correlations in data.</p>
      <p>Scatter plots are most effective for fairly large data sets, since it’s often easier to identify trends when there are more data points present. Additionally, the closer the data points are grouped together, the stronger the correlation or trend tends to be.</p>
      <h2>Shockwave chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Hunga Tonga eruption</h3>
      <figure id="shockwave"></figure>
      <p>The shockwave created by the explosion of the <a href="https://en.wikipedia.org/wiki/2021%E2%80%9322_Hunga_Tonga%E2%80%93Hunga_Ha%CA%BBapai_eruption_and_tsunami">Hunga Tonga–Hunga Haʻapai volcano</a> on January 15<sup>th</sup>, 2022, shown as a series of geodesic circles of increasing radius<a href="#Tonga" aria-describedby="footnote-label" id="Tonga-ref"></a>.</p>
      <p>When the speed of a source equals the speed of sound (<code><em>v&nbsp;=&nbsp;c</em></code>) the wave fronts cannot escape the source. The resulting pile of waves forms a large amplitude "sound barrier" that makes sustained flight at this speed difficult and risky.</p>
      <h2>Slope chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Government spending, % of GDP</h3>
      <figure id="slope">
        <figcaption class="right">Data: <a href="https://observablehq.com/@observablehq/plot-slope-chart">GDP receipts</a></figcaption>
      </figure>
      <p>Also known as a <em>slopegraph</em>, this type of chart shows change in rank between two (or a few) discrete points in time. Typically used to compare changes over time for a list of nouns (e.g. countries) located on an ordinal or interval scale (e.g. GDP). </p>
      <figure id="intslope">
        <figcaption class="right">Data: <a href="https://www.edwardtufte.com/notebook/slopegraphs-for-comparing-gradients-slopegraph-theory-and-practice/">Cancer survival rates</a></figcaption>
      </figure>
      <p>A slope chart with intermediate values. <a href="https://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003nk">Edward Tufte</a> is credited with creating the slop chart.</p>
      <h2>Small multiples</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Comparing MPG by vehicle type</h3>
      <figure id="mpg">
        <figcaption>Data: <a href="https://ggplot2.tidyverse.org/reference/mpg.html">ggplot2 Fuel Economy Data</a></figcaption>
      </figure>

      <p>Small multiples use the same basic graphic or chart to display different slices of a data set. Small multiples can show rich, multi-dimensional data without trying to cram all that information into a single, overly-complex chart. Small multiples go by many names, including Trellis chart, lattice chart, grid chart, and panel chart. I would even argue that sparklines are a simpler, smaller cousin of small multiples.</p>
      <h2>Spiral chart</h2>
      <img class="full-bleed" src="https://datavizcatalogue.com/methods/images/top_images/PNG/spiral_plot.png" alt="A colorful, semi-circular chart with multiple concentric arcs, each composed of rectangular segments in varying sizes and colors, including purple, pink, orange, yellow, green, turquoise, blue, and violet." loading="lazy">
      <p>This type of visualization plots time-based data along an <a href="https://en.wikipedia.org/wiki/Archimedean_spiral">Archimedean spiral</a>. The graph begins at the centre of a spiral and then progresses outwards. Spiral Plots are versatile and can use bars, lines or points to be displayed along the spiral path.</p>
      <!-- <h2>Spike chart</h2> -->
      <!-- <figure id="spikeMap"></figure> -->
      <!-- <p></p> -->
      <h2>Square pie chart</h2>
      <figure id="waffle"></figure>
      <p>Square charts, also called waffle charts, are a form of pie charts that use squares instead of circles to represent percentages. Similar to basic circular pie charts, square pie charts take each percentage out of a total 100%. They are often 10 by 10 grids, where each cell represents 1%. Despite the name, circles, pictograms (such as of people), and other shapes may be used instead of squares. One major benefit to square charts is that smaller percentages, difficult to see on traditional pie charts, can be easily depicted.</p>
      <h2>Stacked area chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Unemployment by industry</h3>
      <figure id="bls_stacked">
        <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      </figure>
      <p>Stacked area graphs work in the same way as regular area graphs, except for the use of multiple data series that start each point from the point left by the previous data series. The entire graph represents the total of all the data plotted. Stacked area graphs also use the areas to convey whole numbers, so they do not work for negative values. Overall, they are useful for comparing multiple variables changing over an interval.</p>
      <h2>Stacked bar chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Unemployment by industry</h3>
      <figure id="bls_bar">
        <figcaption>Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      </figure>
      <p>Stacked bar graphs are used to show how a larger category is divided into smaller categories and what the relationship of each part has on the total amount.</p>
      <h2>Stem and Leaf plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Caltrain’s Palo Alto station schedule</h3>
      <figure id="stem_plot">
        <figcaption class="right">Data: <a href="https://www.caltrain.com/stations/paloaltostation.html">Caltrain</a></figcaption>
      </figure>
      <p>A stem and leaf plot is a special table where each data value is split into a "stem" (the first digit or digits) and a "leaf" (usually the last digit). The "stem" values are listed down, and the "leaf" values go right (or left) from the stem values. The "stem" is used to group the scores and each "leaf" shows the individual scores within each group.</p>
      <p>In the example above, the stem is the hour of the day and the leaf is the minute of when a Caltrain running <em>southbound</em> (left) or <em>northbound</em> (right) is scheduled to arrive. The color of each leaf encodes the type of train arriving.</p>
      <h2>Step chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>WeWork valuation</h3>
      <figure id="wework">
        <figcaption class="right">Data: <a href="https://craft.co/wework/funding-rounds">Craft.co</a></figcaption>
      </figure>
      <p>A step chart is a type of data visualization that displays data points in a way that emphasizes changes over time. Unlike line charts, where data points are connected with straight lines, step charts display horizontal and vertical lines, creating a “stair-step” effect. This method is particularly useful for representing discrete changes, such as values that remain constant over intervals and then jump to a new level.</p>
      <p>Step charts are effective for showing how a value changes over time, especially when the data is not continuous<a href="#interpolation" aria-describedby="footnote-label" id="interpolation-ref"></a>. They are commonly used in scenarios like stock prices, website visits, or any metric that changes at specific intervals.</p>
      <h2>Streamgraph</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Unemployment by industry</h3>
      <figure id="streamgraph">
        <figcaption class="right">Data: <a href="https://www.bls.gov/cew/downloadable-data-files.htm">U.S. Bureau of Labor Statistics</a></figcaption>
      </figure>
      <p>Stream graphs display the changes in data over time of different categories through the use of flowing, organic shapes that somewhat resemble a river-like stream. This makes stream graphs aesthetically pleasing and more engaging to look at. In a stream graph, the size of each individual stream shape is proportional to the values in each category.</p>
      <h2>Strip plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>English letter frequency</h3>
      <figure id="example_dot">
        <figcaption class="right">Data: <a href="http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html">Cornell</a></figcaption>
      </figure>
      <p>Dots are placed along a single continuous scale to show distribution along the corresponding variable. The radius of each dot is encoded, so frequent letters are larger than infrequent letters.</p>
      <h2>Table</h2>
      <!--Source: https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-climate-averages/gcnk62de6-->
      <div class="wrapper" tabindex="0" role="region" aria-labelledby="tableCaption_01">
        <table class="simple">
          <caption id="tableCaption_01">Average climate data for the UK, 1990–2020</caption>
          <thead>
            <tr>
              <th scope="col">Month</th>
              <th scope="col">Maximum temperature (°C)</th>
              <th scope="col">Minimum temperature (°C)</th>
              <th scope="col">Days of air frost (days)</th>
              <th scope="col">Sunshine (hours)</th>
              <th scope="col">Rainfall (mm)</th>
              <th scope="col">Days of rainfall ≥1&nbsp;mm (days)</th>
              <th scope="col">Monthly mean wind speed (knots)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">January</th>
              <td>6.66</td>
              <td>1.21</td>
              <td>11.32</td>
              <td>47.51</td>
              <td>121.53</td>
              <td>15.43</td>
              <td>10.77</td>
            </tr>
            <tr>
              <th scope="row">February</th>
              <td>7.16</td>
              <td>1.13</td>
              <td>10.69</td>
              <td>71.93</td>
              <td>96.15</td>
              <td>13.18</td>
              <td>10.77</td>
            </tr>
            <tr>
              <th scope="row">March</th>
              <td>9.22</td>
              <td>2.19</td>
              <td>7.84</td>
              <td>109.24</td>
              <td>85.10</td>
              <td>12.68</td>
              <td>10.28</td>
            </tr>
            <tr>
              <th scope="row">April</th>
              <td>12.03</td>
              <td>3.75</td>
              <td>4.03</td>
              <td>155.38</td>
              <td>71.73</td>
              <td>11.59</td>
              <td>9.33</td>
            </tr>
            <tr>
              <th scope="row">May</th>
              <td>15.13</td>
              <td>6.25</td>
              <td>1.20</td>
              <td>192.21</td>
              <td>70.98</td>
              <td>11.24</td>
              <td>8.75</td>
            </tr>
            <tr>
              <th scope="row">June</th>
              <td>17.68</td>
              <td>9.08</td>
              <td>0.07</td>
              <td>171.48</td>
              <td>77.20</td>
              <td>11.51</td>
              <td>8.16</td>
            </tr>
            <tr>
              <th scope="row">July</th>
              <td>19.62</td>
              <td>11.02</td>
              <td>0.00</td>
              <td>173.39</td>
              <td>82.48</td>
              <td>12.25</td>
              <td>7.85</td>
            </tr>
            <tr>
              <th scope="row">August</th>
              <td>19.30</td>
              <td>10.97</td>
              <td>0.01</td>
              <td>161.64</td>
              <td>93.73</td>
              <td>12.89</td>
              <td>7.88</td>
            </tr>
            <tr>
              <th scope="row">September</th>
              <td>16.85</td>
              <td>9.04</td>
              <td>0.12</td>
              <td>127.49</td>
              <td>90.89</td>
              <td>12.08</td>
              <td>8.41</td>
            </tr>
            <tr>
              <th scope="row">October</th>
              <td>13.08</td>
              <td>6.42</td>
              <td>1.64</td>
              <td>91.82</td>
              <td>122.56</td>
              <td>14.83</td>
              <td>9.30</td>
            </tr>
            <tr>
              <th scope="row">November</th>
              <td>9.41</td>
              <td>3.56</td>
              <td>5.51</td>
              <td>57.94</td>
              <td>123.39</td>
              <td>15.81</td>
              <td>9.74</td>
            </tr>
            <tr>
              <th scope="row">December</th>
              <td>7.02</td>
              <td>1.42</td>
              <td>10.95</td>
              <td>42.71</td>
              <td>127.19</td>
              <td>15.60</td>
              <td>10.06</td>
            </tr>
          </tbody>
          <tfoot>
            <th scope="row">Annual</th>
            <td>12.79</td>
            <td>5.53</td>
            <td>53.36</td>
            <td>1402.73</td>
            <td>1162.93</td>
            <td>159.08</td>
            <td>9.27</td>
          </tfoot>
        </table>
      </div>
      <p>Visually plain and boring. Often exactly what you want.</p>
      <h2>Timetable</h2>
      <img src="https://datavizcatalogue.com/methods/images/top_images/timetable.png" alt="A train timetable for Monday to Friday shows departure and arrival times for trains from London Waterloo to Basingstoke. It includes stops at various stations, with times listed in a grid format." loading="lazy">
      <p>Timetables are used as a referencing and management tool for scheduled events, tasks and actions to take place. Timetables are commonly used to display the arrival and departure time of trains and other forms of transportation.</p>
      <h2>Ternary plot</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Three of a kind</h3>
      <figure id="ternary">
        <figcaption class="right">JustinChill developers</figcaption>
      </figure>
      <p>A ternary plot, triangle plot, simplex plot, or Gibbs triangle are used to visualize systems with three components. They look like this: △. </p>
      <p>Ternary diagrams allow you to represent the relative proportions of three components in a system. In order to plot data on a ternary diagram, the components are normalized to 100% (i.e., you must determine the proportions of each component relative only to the other components represented on the diagram; more on that later).</p>
      <h2>Timeline</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>World History Timeline</h3>
      <figure id="civilizations">
        <figcaption class="right">Data: <a href="http://www.essential-humanities.net/history-overview/world-history-timeline/">Essential Humanities</a></figcaption>
      </figure>
      <p>A timeline shows a list of events in chronological order. The events may be placed on a scale or in chronological order without a scale. Timelines are useful for telling a story of events over time. They’re typically linear, with key events outlined along the axis. Timelines are used to communicate time-related information and display historical data.</p>
      <p>Timelines allow you to highlight the most important events that occurred, or need to occur in the future, and make it easy for the viewer to identify any patterns appearing within the selected time period. While timelines are often relatively simple linear visualizations, they can be made more visually appealing by adding images, colors, fonts, and decorative shapes.</p>
      <ul>
        <li>For events, use concrete, positive language. Don't include non-events, such as "last chance for X to happen", when X didn't happen.</li>
        <li>Encourage scanning. Keep labels in vertical timelines left aligned to form a straight edge.</li>
        <li>Consider including the smaller events that led to the key events of the story.</li>
        <li>Consider alternating odd and even events on either side of the timeline axis. This helps to avoid crowding. Stay mindful of how this may affect scanning.</li>
        <li>Consider grouping phases in the timeline.</li>
        <li>Consider tooltips on events for details.</li>
      </ul>
      <h2>Treemap</h2>
      <img src="imgs/treemap.svg" alt="An example treemap data visualization from Ben Shneiderman." loading="lazy">
      <p>Ben Shneiderman originally developed treemaps as a way of visualizing a vast file directory on a computer, without taking up too much space on the screen. This makes treemaps a more compact and space-efficient option for displaying hierarchies, that gives a quick overview of the structure. Treemaps are also great at comparing the proportions between categories via their area size.</p>
      <!-- <img src="https://images.datacamp.com/image/upload/v1692817220/image3_852926c2da.png" alt="A divided rectangle showing four colored sections labeled: group A in red at the bottom left, group B in green above it, group C in blue to the right, and group D in gray at the top." loading="lazy"> -->
      <h2>UpSet Plots</h2>
      <img src="https://upset.app/assets/images/upsetr.png" alt="An example of an UpSet chart, showing a matrix chart combined with bar charts along the axis." loading="lazy">
      <p>UpSet plots show the intersections of a set as a matrix. Each column corresponds to a set, and bar charts on top show the size of the set. Each row corresponds to a possible intersection: the filled-in cells show which set is part of an intersection. Also notice the lines connecting the filled-in cells: they show in which direction you should read the plot.</p>
      <p>Read more about the development and application of UpSet plots in the <a href="https://vdl.sci.utah.edu/publications/2014_infovis_upset/">original paper</a>.</p>
      <h2>Variable width bar chart</h2>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Commute time to work</h3>
      <figure id="irregular">
        <figcaption>Data: <a href="https://www.census.gov/prod/2004pubs/c2kbr-33.pdf">US 2000 census</a></figcaption>
      </figure>
      <p>A <strong>variable width bar chart</strong> is a type of graphical representation that differs from traditional bar charts in that the width of each bar carries significant meaning. Rather than all bars being of uniform width, as in conventional bar charts, the width of the bars in a Variable Width Bar Chart is determined by an additional dimension within the dataset.</p>
      <p>In essence, each bar in the chart can represent a specific category, such as different product lines or demographic groups. Variable Width Bar Charts can be oriented either vertically or horizontally, depending on the preference and the nature of the data.</p>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Vaccinations by age group</h3>
      <figure id="irregular_bar">
        <figcaption>Source: <a href="https://www.bytemuse.com/post/us-covid-vaccination-by-age/">US Covid vaccination by age</a> (March 22, 2021)</figcaption>
      </figure>
      <p>Variable width bar charts are particularly useful when visualizing data where the width of the bars provides meaningful context or insight into the underlying dataset. They can be used in scenarios such as comparing the profitability of different product lines, illustrating demographic distributions, or analyzing sales volume and profit margins.</p>
      <h2>Venn diagram</h2>
      <img src="https://upload.wikimedia.org/wikipedia/commons/d/df/VennDiagram.svg" alt="Example venn diagram." loading="lazy">
      <p>A Venn Diagram is a diagram that visually displays all the possible logical relationships between a collection of sets. Each set is typically represented with a circle. When sets overlap, it’s known as the intersection area. This is where entities that have all the qualities of the overlapping sets.</p>
      <h2>Waterfall chart</h2>
      <img src="https://www.automateexcel.com/excel/wp-content/uploads/2020/10/waterfall-chart-free-template.png" alt="Bar chart titled Quarterly Net Cash Flow showing a decline from $100,000 to a current balance of $78,500. Blue bars represent starting balances, red bars represent decreases, and green bars show increases in cash flow from FY2018 to FY2020." loading="lazy">
      <p>A waterfall chart is a visual representation that illustrates how a value changes as it’s influenced by different factors, such as time. The main goal of this chart is to show the viewer how a value has grown or declined over a defined period. For example, waterfall charts are popular for showing spending or earnings over time.</p>
      <h2>Word clouds</h2>
      <p>A word cloud, or tag cloud, is a visual representation of text data in which the size of the word is proportional to its frequency. The more often a specific word appears in a dataset, the larger it appears in the visualization. In addition to size, words often appear bolder or follow a specific color scheme depending on their frequency.</p>
      <img src="https://images.datacamp.com/image/upload/v1692817285/image9_3a0ec1443d.png" alt="A word cloud featuring terms like palate, aromas, dried, fruit, tropical, brimstone, herb, broom, apple, citrus, unripened, overly, expressive, offering, acidity, and sage, in varying sizes and colors." loading="lazy">
    </article>
  </main>

  <!-- Todo: find better way to define SVG gradient, as in https://observablehq.com/@observablehq/plot-area-chart-with-gradient -->
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="visually-hidden">
    <defs>
      <linearGradient id="gradient" gradientTransform="rotate(90)">
        <stop offset="20%" stop-color="rgba(0, 0, 0, .75)" stop-opacity="0.5" />
        <stop offset="100%" stop-color="LightSkyBlue" stop-opacity="0" />
      </linearGradient>
    </defs>
  </svg>

  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <li id="glyph">For a deep dive on glyph and pictograph charts, check out <a href="https://vis.uib.no/wp-content/papercite-data/pdfs/Borgo13GlyphBased.pdf">Glyph-based Visualization: Foundations, Design Guidelines, Techniques and Applications</a>. <a href="#glyph-ref" aria-label="Back to content">↩</a></li>
      <li id="Tonga"><strong>Fil</strong>, <a href="https://observablehq.com/@observablehq/plot-shockwave"><em>Shockwave</em></a> <a href="#Tonga-ref" aria-label="Back to content">↩</a></li>
      <li id="interpolation"><strong>Interpolation</strong> is the process of calculating an approximate value based on values that are already known. Learn more <a href="https://www.merriam-webster.com/dictionary/interpolation">here</a>.<a href="#interpolation-ref" aria-label="Back to content">↩</a></li>
    </ol>
    <div>
      <p>Justin Chill &copy; 2025</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" alt="GitHub logo" class="icon">Source code</a></span>
    </div>
  </footer>
  <script type="text/javascript" src="js/occlusionY.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>

  <script type="text/javascript">
    var elementMid = d3.select('figure.mid-size').node();
    var widthMid = elementMid.getBoundingClientRect().width; // get width of figure.mid-size so graphic is responsive
    var element = d3.select('figure:not(.mid-size)').node();
    var width = element.getBoundingClientRect().width;
    var size = width > 450 ? ".9rem" : ".7rem";
    var backgroundColor = "rgba(242,245,248,1)";

    var nodes = [{
        id: "SRI",
        x: 0,
        y: 10
      },
      {
        id: "UCSB",
        x: 1,
        y: 1
      },
      {
        id: "UCLA",
        x: 8,
        y: 0
      },
      {
        id: "UTAH",
        x: 36,
        y: 17
      }
    ];

    var links = [
      ["SRI", "UTAH"],
      ["SRI", "UCSB"],
      ["SRI", "UCLA"],
      ["UCLA", "UCSB"]
    ];

    var ex_lvls = [{
        "Phrase": "Hey baby,",
        "level": 15
      },
      {
        "Phrase": "do you want",
        "level": 25
      },
      {
        "Phrase": "to have",
        "level": 40
      },
      {
        "Phrase": "sex...",
        "level": 75
      },
      {
        "Phrase": "...tuplets?",
        "level": 5
      }
    ];

    var wework = [
      // https://craft.co/wework/funding-rounds
      [0.097, '01/04/2009', 'A'],
      [0.440, '01/11/2010', 'B'],
      [1.5, '01/07/2011', 'C'],
      [4.8, '01/07/2011', 'D-1'],
      [5, '01/05/2012', 'D-2'],
      [10, '01/05/2015', 'E'],
      [15, '01/06/2015', 'F'],
      [21, '01/08/2017', 'G'],
      [47, '01/08/2019', '‘The epic SoftBank round’'], // https://www.businesswire.com/news/home/20190108005751/en/WeWork-Closes-6-Billion-Investment-SoftBank
      [7.3, '12/31/2019'],
      [2.9, '05/20/2020'],
      [2.9, new Date()]
    ].map(([val, d, label]) => ({
      value: val,
      date: new Date(d),
      label
    }));

    var animals = [{
        animal: "pigs",
        country: "Great Britain",
        count: 1354979
      },
      {
        animal: "cattle",
        country: "Great Britain",
        count: 3962921
      },
      {
        animal: "sheep",
        country: "Great Britain",
        count: 10931215
      },
      {
        animal: "pigs",
        country: "United States",
        count: 6281935
      },
      {
        animal: "cattle",
        country: "United States",
        count: 9917873
      },
      {
        animal: "sheep",
        country: "United States",
        count: 7084151
      }
    ];

    var top20 = [{
      "country": "China",
      "value": 10174.681
    }, {
      "country": "United States",
      "value": 5284.697
    }, {
      "country": "India",
      "value": 2616.449
    }, {
      "country": "Russia",
      "value": 1678.367
    }, {
      "country": "Japan",
      "value": 1106.664
    }, {
      "country": "Iran",
      "value": 779.527
    }, {
      "country": "Germany",
      "value": 701.955
    }, {
      "country": "Indonesia",
      "value": 617.513
    }, {
      "country": "South Korea",
      "value": 611.263
    }, {
      "country": "Saudi Arabia",
      "value": 582.15
    }, {
      "country": "Canada",
      "value": 576.65
    }, {
      "country": "South Africa",
      "value": 478.608
    }, {
      "country": "Brazil",
      "value": 465.716
    }, {
      "country": "Mexico",
      "value": 438.498
    }, {
      "country": "Australia",
      "value": 411.016
    }, {
      "country": "Turkey",
      "value": 405.126
    }, {
      "country": "United Kingdom",
      "value": 369.878
    }, {
      "country": "Italy",
      "value": 337.086
    }, {
      "country": "France",
      "value": 323.747
    }, {
      "country": "Poland",
      "value": 322.627
    }];

    var alphabet = [{
      "letter": "E",
      "frequency": 0.12702
    }, {
      "letter": "T",
      "frequency": 0.09056
    }, {
      "letter": "A",
      "frequency": 0.08167
    }, {
      "letter": "O",
      "frequency": 0.07507
    }, {
      "letter": "I",
      "frequency": 0.06966
    }, {
      "letter": "N",
      "frequency": 0.06749
    }, {
      "letter": "S",
      "frequency": 0.06327
    }, {
      "letter": "H",
      "frequency": 0.06094
    }, {
      "letter": "R",
      "frequency": 0.05987
    }, {
      "letter": "D",
      "frequency": 0.04253
    }, {
      "letter": "L",
      "frequency": 0.04025
    }, {
      "letter": "C",
      "frequency": 0.02782
    }, {
      "letter": "U",
      "frequency": 0.02758
    }, {
      "letter": "M",
      "frequency": 0.02406
    }, {
      "letter": "W",
      "frequency": 0.0236
    }, {
      "letter": "F",
      "frequency": 0.02288
    }, {
      "letter": "G",
      "frequency": 0.02015
    }, {
      "letter": "Y",
      "frequency": 0.01974
    }, {
      "letter": "P",
      "frequency": 0.01929
    }, {
      "letter": "B",
      "frequency": 0.01492
    }, {
      "letter": "V",
      "frequency": 0.00978
    }, {
      "letter": "K",
      "frequency": 0.00772
    }, {
      "letter": "J",
      "frequency": 0.00153
    }, {
      "letter": "X",
      "frequency": 0.0015
    }, {
      "letter": "Q",
      "frequency": 0.00095
    }, {
      "letter": "Z",
      "frequency": 0.00074
    }];

    var mekko = [{
      "year": 2013,
      "territory": "Southeast",
      "total": 860126.27
    }, {
      "year": 2015,
      "territory": "Southeast",
      "total": 590351.26
    }, {
      "year": 2014,
      "territory": "Southeast",
      "total": 554975.04
    }, {
      "year": 2013,
      "territory": "Southwest",
      "total": 514814.11
    }, {
      "year": 2013,
      "territory": "Mideast",
      "total": 509158.51
    }, {
      "year": 2013,
      "territory": "Plains",
      "total": 499981.42
    }, {
      "year": 2013,
      "territory": "Great Lakes",
      "total": 448777.43
    }, {
      "year": 2015,
      "territory": "Plains",
      "total": 426599.52
    }, {
      "year": 2015,
      "territory": "Great Lakes",
      "total": 426204.18
    }, {
      "year": 2015,
      "territory": "Mideast",
      "total": 422307.31
    }, {
      "year": 2016,
      "territory": "Southeast",
      "total": 398957.56
    }, {
      "year": 2013,
      "territory": "Far West",
      "total": 391021.82
    }, {
      "year": 2015,
      "territory": "Southwest",
      "total": 356559.44
    }, {
      "year": 2014,
      "territory": "Mideast",
      "total": 348336.13
    }, {
      "year": 2014,
      "territory": "Plains",
      "total": 335422.77
    }, {
      "year": 2014,
      "territory": "Southwest",
      "total": 330156.18
    }, {
      "year": 2015,
      "territory": "Far West",
      "total": 311311.14
    }, {
      "year": 2016,
      "territory": "Mideast",
      "total": 309321.7
    }, {
      "year": 2016,
      "territory": "Plains",
      "total": 249464.6
    }, {
      "year": 2014,
      "territory": "Far West",
      "total": 238638.61
    }, {
      "year": 2014,
      "territory": "Great Lakes",
      "total": 235570.98
    }, {
      "year": 2016,
      "territory": "Far West",
      "total": 233609.7
    }, {
      "year": 2016,
      "territory": "Southwest",
      "total": 227107.47
    }, {
      "year": 2016,
      "territory": "Great Lakes",
      "total": 209591.94
    }, {
      "year": 2015,
      "territory": "Rocky Mountain",
      "total": 196060.13
    }, {
      "year": 2013,
      "territory": "Rocky Mountain",
      "total": 195866.61
    }, {
      "year": 2014,
      "territory": "Rocky Mountain",
      "total": 106174.16
    }, {
      "year": 2016,
      "territory": "Rocky Mountain",
      "total": 83640.41
    }];

    var profiles = [{
        journalist: 75,
        developer: 25,
        designer: 0,
        name: "Alissa Combs"
      },
      {
        journalist: 70,
        developer: 10,
        designer: 20,
        name: "Sidney Gibson"
      },
      {
        journalist: 75,
        developer: 20,
        designer: 5,
        name: "Evan Guerrero"
      },
      {
        journalist: 5,
        developer: 60,
        designer: 35,
        name: "Marquise Walsh"
      },
      {
        journalist: 10,
        developer: 80,
        designer: 10,
        name: "Terry Mason"
      },
      {
        journalist: 10,
        developer: 90,
        designer: 0,
        name: "Megan Boyle"
      },
      {
        journalist: 20,
        developer: 70,
        designer: 10,
        name: "Aliana Cline"
      },
      {
        journalist: 10,
        developer: 20,
        designer: 70,
        name: "Esther Coffey"
      },
      {
        journalist: 15,
        developer: 5,
        designer: 80,
        name: "Giuliana Booker"
      },
      {
        journalist: 10,
        developer: 10,
        designer: 80,
        name: "Deandre Roy"
      },
      {
        journalist: 20,
        developer: 10,
        designer: 70,
        name: "Cruz Day"
      }
    ];

    var population = [{
      "2010": 37254523,
      "2019": 39512223,
      "State": "California"
    }, {
      "2010": 25145561,
      "2019": 28995881,
      "State": "Texas"
    }, {
      "2010": 18801310,
      "2019": 21477737,
      "State": "Florida"
    }, {
      "2010": 19378102,
      "2019": 19453561,
      "State": "New York"
    }, {
      "2010": 12702379,
      "2019": 12801989,
      "State": "Pennsylvania"
    }, {
      "2010": 12830632,
      "2019": 12671821,
      "State": "Illinois"
    }, {
      "2010": 11536504,
      "2019": 11689100,
      "State": "Ohio"
    }, {
      "2010": 9687653,
      "2019": 10617423,
      "State": "Georgia"
    }, {
      "2010": 9535483,
      "2019": 10488084,
      "State": "North Carolina"
    }, {
      "2010": 9883640,
      "2019": 9986857,
      "State": "Michigan"
    }, {
      "2010": 8791894,
      "2019": 8882190,
      "State": "New Jersey"
    }, {
      "2010": 8001024,
      "2019": 8535519,
      "State": "Virginia"
    }, {
      "2010": 6724540,
      "2019": 7614893,
      "State": "Washington"
    }, {
      "2010": 6392017,
      "2019": 7278717,
      "State": "Arizona"
    }, {
      "2010": 6547629,
      "2019": 6949503,
      "State": "Massachusetts"
    }, {
      "2010": 6346105,
      "2019": 6833174,
      "State": "Tennessee"
    }, {
      "2010": 6483802,
      "2019": 6732219,
      "State": "Indiana"
    }, {
      "2010": 5988927,
      "2019": 6137428,
      "State": "Missouri"
    }, {
      "2010": 5773552,
      "2019": 6045680,
      "State": "Maryland"
    }, {
      "2010": 5686986,
      "2019": 5822434,
      "State": "Wisconsin"
    }, {
      "2010": 5029196,
      "2019": 5758736,
      "State": "Colorado"
    }, {
      "2010": 5303925,
      "2019": 5639632,
      "State": "Minnesota"
    }, {
      "2010": 4625364,
      "2019": 5148714,
      "State": "South Carolina"
    }, {
      "2010": 4779736,
      "2019": 4903185,
      "State": "Alabama"
    }, {
      "2010": 4533372,
      "2019": 4648794,
      "State": "Louisiana"
    }, {
      "2010": 4339367,
      "2019": 4467673,
      "State": "Kentucky"
    }, {
      "2010": 3831074,
      "2019": 4217737,
      "State": "Oregon"
    }, {
      "2010": 3751351,
      "2019": 3956971,
      "State": "Oklahoma"
    }, {
      "2010": 3574097,
      "2019": 3565287,
      "State": "Connecticut"
    }, {
      "2010": 2763885,
      "2019": 3205958,
      "State": "Utah"
    }, {
      "2010": 3046355,
      "2019": 3155070,
      "State": "Iowa"
    }, {
      "2010": 2700551,
      "2019": 3080156,
      "State": "Nevada"
    }, {
      "2010": 2915918,
      "2019": 3017825,
      "State": "Arkansas"
    }, {
      "2010": 2967297,
      "2019": 2976149,
      "State": "Mississippi"
    }, {
      "2010": 2853118,
      "2019": 2913314,
      "State": "Kansas"
    }, {
      "2010": 2059179,
      "2019": 2096829,
      "State": "New Mexico"
    }, {
      "2010": 1826341,
      "2019": 1934408,
      "State": "Nebraska"
    }, {
      "2010": 1852994,
      "2019": 1792065,
      "State": "West Virginia"
    }, {
      "2010": 1567582,
      "2019": 1787147,
      "State": "Idaho"
    }, {
      "2010": 1360301,
      "2019": 1415872,
      "State": "Hawaii"
    }, {
      "2010": 1316470,
      "2019": 1359711,
      "State": "New Hampshire"
    }, {
      "2010": 1328361,
      "2019": 1344212,
      "State": "Maine"
    }, {
      "2010": 989415,
      "2019": 1068778,
      "State": "Montana"
    }, {
      "2010": 1052567,
      "2019": 1059361,
      "State": "Rhode Island"
    }, {
      "2010": 897934,
      "2019": 973764,
      "State": "Delaware"
    }, {
      "2010": 814180,
      "2019": 884659,
      "State": "South Dakota"
    }, {
      "2010": 672591,
      "2019": 762062,
      "State": "North Dakota"
    }, {
      "2010": 710231,
      "2019": 731545,
      "State": "Alaska"
    }, {
      "2010": 601723,
      "2019": 705749,
      "State": "District of Columbia"
    }, {
      "2010": 625741,
      "2019": 623989,
      "State": "Vermont"
    }, {
      "2010": 563626,
      "2019": 578759,
      "State": "Wyoming"
    }];

    var civilizations = [{
      "civilization": "Aegean civilization",
      "start": -2000,
      "end": -1200,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Age of pre-colonial civilization (Christian, Islamic, and traditional kingdoms)",
      "start": 650,
      "end": 1880,
      "startLabel": null,
      "endLabel": null,
      "region": "Sub-Saharan Africa",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Age of Turkic empires",
      "start": 500,
      "end": 1200,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Age of united Caliphate",
      "start": 650,
      "end": 900,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Ancient Andean region",
      "start": -1000,
      "end": 500,
      "startLabel": null,
      "endLabel": null,
      "region": "pre-colonial Americas",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Ancient China",
      "start": -2000,
      "end": 500,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Ancient Steppe empires",
      "start": -1000,
      "end": 500,
      "startLabel": null,
      "endLabel": null,
      "region": "the Steppe",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "British India",
      "start": 1800,
      "end": 1945,
      "startLabel": null,
      "endLabel": "WWII",
      "region": "South Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Classic age of Mesoamerica",
      "start": 100,
      "end": 900,
      "startLabel": null,
      "endLabel": null,
      "region": "pre-colonial Americas",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Colonial Africa",
      "start": 1880,
      "end": 1980,
      "startLabel": null,
      "endLabel": null,
      "region": "Sub-Saharan Africa",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Colonial United States",
      "start": 1500,
      "end": 1776,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Early Islamic period",
      "start": 1200,
      "end": 1500,
      "startLabel": null,
      "endLabel": null,
      "region": "South Asia",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Early modern China",
      "start": 1500,
      "end": 1918,
      "startLabel": null,
      "endLabel": "WWI",
      "region": "East Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Early modern Europe",
      "start": 1500,
      "end": 1800,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Early Nubian civilization",
      "start": -2000,
      "end": -1000,
      "startLabel": null,
      "endLabel": null,
      "region": "Sub-Saharan Africa",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Egyptian civilization",
      "start": -3000,
      "end": -550,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "First Persian Empire",
      "start": -550,
      "end": -330,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Formative age of Mesoamerica",
      "start": -1500,
      "end": 100,
      "startLabel": null,
      "endLabel": null,
      "region": "pre-colonial Americas",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Formative Japan (age of Yamato rule)",
      "start": 500,
      "end": 800,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Formative US",
      "start": 1776,
      "end": 1865,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Fractured Islamic world",
      "start": 900,
      "end": 2018,
      "startLabel": null,
      "endLabel": "present",
      "region": "Middle East",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Great power US",
      "start": 1865,
      "end": 1945,
      "startLabel": null,
      "endLabel": "WWII",
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Greek age",
      "start": -1200,
      "end": 0,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Heian age",
      "start": 800,
      "end": 1200,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Imperial Japan",
      "start": 1870,
      "end": 1945,
      "startLabel": null,
      "endLabel": "WWII",
      "region": "East Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Indian kingdom age",
      "start": -500,
      "end": 1200,
      "startLabel": null,
      "endLabel": null,
      "region": "South Asia",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Indus civilization",
      "start": -2500,
      "end": -1500,
      "startLabel": null,
      "endLabel": null,
      "region": "South Asia",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Inter-Persian period",
      "start": -330,
      "end": 200,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Kush",
      "start": -1000,
      "end": 300,
      "startLabel": null,
      "endLabel": null,
      "region": "Sub-Saharan Africa",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Medieval Andean region",
      "start": 500,
      "end": 1530,
      "startLabel": null,
      "endLabel": null,
      "region": "pre-colonial Americas",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Medieval China",
      "start": 500,
      "end": 1500,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Medieval Europe",
      "start": 500,
      "end": 1500,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Mesopotamian civilization",
      "start": -3500,
      "end": -550,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Modern Africa",
      "start": 1980,
      "end": 2018,
      "startLabel": "WWII",
      "endLabel": "present",
      "region": "Sub-Saharan Africa",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Modern Europe",
      "start": 1800,
      "end": 2018,
      "startLabel": null,
      "endLabel": "present",
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Modern India",
      "start": 1945,
      "end": 2018,
      "startLabel": null,
      "endLabel": "present",
      "region": "South Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Modern Japan",
      "start": 1945,
      "end": 2018,
      "startLabel": null,
      "endLabel": "present",
      "region": "East Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Mongol Empire",
      "start": 1200,
      "end": 1300,
      "startLabel": null,
      "endLabel": null,
      "region": "the Steppe",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Mughal Empire",
      "start": 1500,
      "end": 1800,
      "startLabel": null,
      "endLabel": null,
      "region": "South Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Peak of Aksum",
      "start": 300,
      "end": 650,
      "startLabel": null,
      "endLabel": null,
      "region": "Sub-Saharan Africa",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "People's Republic of China",
      "start": 1945,
      "end": 2018,
      "startLabel": "WWII",
      "endLabel": "present",
      "region": "East Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Postclassic age of Mesoamerica",
      "start": 900,
      "end": 1520,
      "startLabel": null,
      "endLabel": null,
      "region": "pre-colonial Americas",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Ptolemaic Egypt",
      "start": -330,
      "end": 0,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Republic of China",
      "start": 1918,
      "end": 1945,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Roman > Byzantine Egypt",
      "start": 0,
      "end": 650,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Roman Empire",
      "start": 0,
      "end": 500,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Roman Republic",
      "start": -500,
      "end": 0,
      "startLabel": null,
      "endLabel": null,
      "region": "Europe (and colonial offshoots)",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Second Persian Empire",
      "start": -200,
      "end": 650,
      "startLabel": null,
      "endLabel": null,
      "region": "Middle East",
      "timeline": "ANCIENT WORLD"
    }, {
      "civilization": "Shogunate",
      "start": 1200,
      "end": 1870,
      "startLabel": null,
      "endLabel": null,
      "region": "East Asia",
      "timeline": "MEDIEVAL WORLD"
    }, {
      "civilization": "Superpower US",
      "start": 1945,
      "end": 2021,
      "startLabel": null,
      "endLabel": "present",
      "region": "Europe (and colonial offshoots)",
      "timeline": "MODERN WORLD"
    }, {
      "civilization": "Vedic age",
      "start": -1500,
      "end": -500,
      "startLabel": null,
      "endLabel": null,
      "region": "South Asia",
      "timeline": "ANCIENT WORLD"
    }];

    var sales = [{
      "market": "Auburn, AL",
      "segment": "Almond lovers",
      "value": 3840
    }, {
      "market": "Auburn, AL",
      "segment": "Berry buyers",
      "value": 1920
    }, {
      "market": "Auburn, AL",
      "segment": "Carrots-n-more",
      "value": 960
    }, {
      "market": "Auburn, AL",
      "segment": "Delicious-n-new",
      "value": 400
    }, {
      "market": "Birmingham, AL",
      "segment": "Almond lovers",
      "value": 1600
    }, {
      "market": "Birmingham, AL",
      "segment": "Berry buyers",
      "value": 1440
    }, {
      "market": "Birmingham, AL",
      "segment": "Carrots-n-more",
      "value": 960
    }, {
      "market": "Birmingham, AL",
      "segment": "Delicious-n-new",
      "value": 400
    }, {
      "market": "Gainesville, FL",
      "segment": "Almond lovers",
      "value": 640
    }, {
      "market": "Gainesville, FL",
      "segment": "Berry buyers",
      "value": 960
    }, {
      "market": "Gainesville, FL",
      "segment": "Carrots-n-more",
      "value": 640
    }, {
      "market": "Gainesville, FL",
      "segment": "Delicious-n-new",
      "value": 400
    }, {
      "market": "Durham, NC",
      "segment": "Almond lovers",
      "value": 320
    }, {
      "market": "Durham, NC",
      "segment": "Berry buyers",
      "value": 480
    }, {
      "market": "Durham, NC",
      "segment": "Carrots-n-more",
      "value": 640
    }, {
      "market": "Durham, NC",
      "segment": "Delicious-n-new",
      "value": 400
    }];

    var gasExports = [{
        country: "United States",
        "2013": 44526,
        "2014": 42878,
        "2015": 50503,
        "2016": 66133,
        "2017": 89704,
        "2018": 102150,
        "2019": 131852,
        "2020": 149615,
        "2021": 188381,
        "2022": 195376,
        "2023": 215509
      },
      {
        country: "Russia",
        "2013": 211867,
        "2014": 189572,
        "2015": 200747,
        "2016": 213094,
        "2017": 228226,
        "2018": 245114,
        "2019": 259849,
        "2020": 238783,
        "2021": 242437,
        "2022": 167281,
        "2023": 137767
      },
      {
        country: "Qatar",
        "2013": 122630,
        "2014": 121090,
        "2015": 123890,
        "2016": 127430,
        "2017": 123740,
        "2018": 122810,
        "2019": 124680,
        "2020": 124110,
        "2021": 123820,
        "2022": 124880,
        "2023": 124968
      },
      {
        country: "Norway",
        "2013": 107192,
        "2014": 106679,
        "2015": 114696,
        "2016": 114644,
        "2017": 123233,
        "2018": 120086,
        "2019": 113582,
        "2020": 110922,
        "2021": 113450,
        "2022": 121101,
        "2023": 116914
      },
      {
        country: "Australia",
        "2013": 29972,
        "2014": 29646,
        "2015": 32226,
        "2016": 50364,
        "2017": 70240,
        "2018": 82561,
        "2019": 99592,
        "2020": 105443,
        "2021": 103354,
        "2022": 112970,
        "2023": 110474
      },
      {
        country: "Canada",
        "2013": 82465,
        "2014": 77996,
        "2015": 78267,
        "2016": 84270,
        "2017": 85125,
        "2018": 79635,
        "2019": 76628,
        "2020": 70931,
        "2021": 79558,
        "2022": 86046,
        "2023": 82380
      }
    ];

    var vaxdata = d3.csvParse(`Age group,population,one,full
  75+,21848000,15075704,10322963
  65-74,32455000,20169927,11505303
  50-64,64105000,18623335,8198891
  40-49,41153000,8488028,4412083
  30-39,45194000,7791839,4164941
  18-29,53184000,6046041,3067161
  <18,74660000,173094,46592`, d3.autoType);

    var tasks = [{
        task: "Shire to Bree",
        group: "Frodo, Sam, Merry, Pippin",
        startDate: "3018-09-23",
        endDate: "3018-09-28",
        description: "Travel from the Shire to Bree to meet Gandalf at the Prancing Pony."
      },
      {
        task: "Journey to Rivendell",
        group: "Frodo, Sam, Merry, Pippin, Strider",
        startDate: "3018-09-30",
        endDate: "3018-10-20",
        description: "After meeting Strider in Bree, the group sets off, Frodo gets stabbed, and they end up in Rivendell on October 20."
      },
      {
        task: "Rivendell",
        group: "Everybody",
        startDate: "3018-10-20",
        endDate: "3018-12-25",
        description: "Following the Fellowship's creation at the Council of Elrond (October 25), the Fellowship departs Rivendell at dawn on December 25."
      },
      {
        task: "Caradhras",
        group: "Fellowship",
        startDate: "3018-12-25",
        endDate: "3019-01-12",
        description: "The Fellowship attempts the path through the mountains, but must turn back."
      },
      {
        task: "Mines of Moria",
        group: "Fellowship",
        startDate: "3019-01-13",
        endDate: "3019-01-16",
        description: "Fellowship dares to travel through the Mines of Moria. Gandalf falls to the Balrog."
      },
      {
        task: "Caras Galadhon",
        group: "Fellowship sans Gandalf",
        startDate: "3019-01-17",
        endDate: "3019-02-16",
        description: "Company is in Caras Galadhon, and meet Galadriel. Weird mirror business."
      },
      {
        task: "River and Argonath passing",
        group: "Fellowship sans Gandalf",
        startDate: "3019-02-17",
        endDate: "3019-02-26",
        description: "The company are attacked and pass the Argonath. Merry and Pippin captured by orcs. Boromir dies. February 26: the Breaking of the Fellowship. "
      },
      {
        task: "Emyn Muil and the Dead Marshes",
        group: "Frodo, Sam and Gollum",
        startDate: "3019-02-26",
        endDate: "3019-03-06",
        description: "Frodo and Sam set out on their own. Capture Gollum. Traverse the Dead Marshes."
      },
      {
        task: "Henneth Annun",
        group: "Frodo, Sam and Gollum",
        startDate: "3019-03-07",
        endDate: "3019-03-09",
        description: "Faramir brings the trio to Henneth Annun, then lets them go."
      },
      {
        task: "Morgol Road and Cirith Ungol",
        group: "Frodo, Sam and Gollum",
        startDate: "3019-03-09",
        endDate: "3019-03-15",
        description: "A dangerous path, Shelob's layer, Frodo is captured by orcs and imprisoned in the tower at Cirith Ungol."
      },
      {
        task: "Mordor, on the road to Mount Doom",
        group: "Frodo and Sam",
        startDate: "3019-03-15",
        endDate: "3019-03-24",
        description: "Frodo and Sam make their way toward Mount Doom, have some orc run-ins, and leave all of their supplies somewhere."
      },
      {
        task: "Mount Doom",
        group: "Frodo, Sam and Gollum",
        startDate: "3019-03-25",
        endDate: "3019-03-26",
        description: "Oh Gollum's back. But not for long! A ring gets destroyed in Mount Doom. Sauron crumbles. Finally, eagles."
      },
      {
        task: "Minas Tirith",
        group: "Remaining members of the Fellowship",
        startDate: "3019-04-01",
        endDate: "3019-06-15",
        description: "Aragorn crowned King Elessar. Marries Arwen."
      },
      {
        task: "Rohan",
        group: "Remaining members of the Fellowship",
        startDate: "3019-07-01",
        endDate: "3019-08-14",
        description: "The remaining members of the Fellowship, with others, return with Theoden's body to Rohan."
      }
    ];

    // Civilization chart
    formatYear = year => year < 0 ? `${-year} BC` : `${year} AD` // formatYear uses a ternary operator to dynamically format the year in the data. Such a cool d3 thing! 😎

    colorContrast = ({
        luminance = 60,
        ...options
      }) =>
      Plot.initializer(options, (data, facets, channels, scales) => {
        const contrast = (color) =>
          d3.hcl(color).l > luminance ? "black" : "white";
        return {
          channels: {
            fill: {
              ...channels.fill,
              scale: undefined,
              value: channels.fill == null // when options.fill is a constant color such as "red"
                ||
                scales.color == null // when the scale isn't yet available (e.g. hexbin below)
                ?
                Array.from(data).fill(contrast(options.fill)) : Array.from(channels.fill.value, (value) => contrast(scales.color(value)))
            }
          }
        };
      })

    var civ_options = {
      width: width,
      marginRight: 0,
      style: {
        fontSize: size,
        textTransform: "capitalize",
        paddingLeft: 20,
        paddingRight: 10
      },
      x: {
        axis: "both",
        grid: true,
        clamp: true,
        tickFormat: formatYear
      },
      y: {
        axis: null,
        domain: d3.sort(civilizations, d => d.start).map(d => d.civilization)
      },
      color: {
        reverse: true,
        scheme: "BuRd",
        legend: true,
      },
      marks: [
        Plot.barX(civilizations, {
          x1: "start",
          x2: "end",
          insetTop: 2,
          insetBottom: 2, // Makes the bars slightly thinner
          fill: "region",
          tip: {
            opacity: 0.9,
            textPadding: 10,
            lineHeight: 1.65,
          },
          title: (d) =>
            `${d.civilization}\nStart: ${formatYear(d.start)}\nEnd: ${formatYear(d.end)}\nRegion: ${d.region}`,
          y: "civilization"
        }),
        Plot.text(civilizations.filter(d => (d.civilization == "Mesopotamian civilization" || d.civilization == "Egyptian civilization")), {
          x: "end", // Show label on right when start date is > -3000 years
          y: "civilization",
          text: "civilization",
          textAnchor: "start",
          dx: 10
        }),
        Plot.text(civilizations.filter(d => (d.civilization !== "Mesopotamian civilization" && d.civilization !== "Egyptian civilization")), {
          x: "start", // Show label on right when start date is > -3000 years
          y: "civilization",
          text: "civilization",
          textAnchor: "end",
          dx: -6
        }),
      ]
    };

    var country_emissions = {
      width: width,
      marginLeft: 10,
      style: {
        fontSize: size,
        backgroundColor: backgroundColor,
        paddingTop: 10,
        paddingLeft: width > 450 ? "6rem" : "4rem",
        paddingRight: "1.825rem",
      },
      color: {
        range: ["#969696", "#4e79a7"]
      },
      x: {
        axis: "top",
        ticks: 0,
        label: "Metric Tonne Carbon Dioxide Equivalent (MtCO₂) annually",
        labelAnchor: "left",
      },
      y: {
        domain: d3.sort(top20, d => -d.value).map(d => d.country),
        label: null,
      },
      marks: [
        Plot.axisY({
          label: null,
          lineWidth: 8,
          tickSize: 4,
        }),
        Plot.barX(top20, {
          x: "value",
          y: "country",
          // inset: 2,
          insetTop: 2,
          insetBottom: 2,
          fill: d => d.value < 2000 ? "" : "country",
        }),
        Plot.text(top20, {
          x: "value",
          y: "country",
          text: d => d3.format(",.0f")(d.value),
          textAnchor: "start",
          dx: 6,
          dy: 0,
        }),
      ]
    };

    var emoji = ({
      cattle: "🐄",
      sheep: "🐑",
      pigs: "🐖"
    });
    var animals = {
      width: width,
      marginRight: 0,
      style: {
        textTransform: "capitalize",
        fontSize: size,
      },
      height: 280,
      y: {
        label: null,
        tickSize: 0,
        tickFormat: d => d + ":",
      },
      fy: {
        paddingInner: 0.27,
        label: null
      },
      marks: [
        Plot.frame({
          stroke: "#DFDFDF",
          anchor: "top"
        }),
        Plot.text(animals, {
          frameAnchor: "left",
          fontSize: width > 450 ? 30 : 15,
          text: (d) => `${emoji[d.animal]} `.repeat(Math.round(d.count / 1e6)),
          dx: 20,
          y: "animal",
          fy: "country",
        }),
        Plot.axisFy({
          fontSize: width > 450 ? 18 : 14,
          frameAnchor: "top",
          dy: -18,
          textAnchor: "middle",
        })
      ],
    };

    lookup = new function() {
      const index = new Map(nodes.map(d => [d.id, d]));
      return id => index.get(id);
    };

    function project([id1, id2]) {
      const {
        x: x1,
        y: y1
      } = lookup(id1);
      const {
        x: x2,
        y: y2
      } = lookup(id2);
      return {
        x1,
        y1,
        x2,
        y2
      };
    };

    var network = {
      width: 300,
      height: 220,
      inset: 10,
      style: {
        fontSize: size + 2,
        paddingLeft: 10,
        paddingRight: 10,
        margin: "0 auto"
      },
      x: {
        axis: null
      },
      y: {
        axis: null
      },
      marks: [
        Plot.link(links.map(project), {
          x1: "x1",
          y1: "y1",
          x2: "x2",
          y2: "y2"
        }),
        Plot.dot(nodes, {
          x: "x",
          y: "y",
          fill: "black"
        }),
        Plot.text(nodes, {
          x: "x",
          y: "y",
          text: "id",
          dy: 16,
          dx: -12
        })
      ],
    };

    var wework = {
      width: width,
      marginRight: 0,
      style: {
        fontSize: size,
      },
      y: {
        grid: true,
        tickFormat: d => `$${d}B`,
        label: "Value ↑",
        tickSize: 0,
        ticks: 4,
      },
      marks: [
        Plot.axisY({
          tickSize: 0, // don’t draw ticks
          ticks: 4,
          dx: 2, // offset right
          dy: -4, // offset up
          lineAnchor: "bottom", // draw labels above grid lines
          tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}B` : `${d}B`) // Show $ on first tick only
        }),
        Plot.lineY(wework, {
          x: "date",
          y: "value",
          curve: "step-after",
          strokeWidth: 2,
          stroke: "steelblue"
        }),
        Plot.ruleY([0]),
        Plot.text(wework.filter(d => (d.label !== "E" && d.label !== "C")), {
          x: "date",
          y: "value",
          text: "label",
          dx: 0,
          dy: -12
        }),
        Plot.text(wework.filter(d => (d.label === "E" || d.label === "C")), {
          x: "date",
          y: "value",
          text: "label",
          dx: -12,
          dy: -1
        }),
        Plot.dot(wework, {
          x: "date",
          y: "value",
          r: width < 500 ? 3 : 4,
          fill: "white",
          stroke: "black",
          title: d => d3.format("$")(d.value) + `B`,
        })
      ]
    };

    var example_dot = {
      width: width,
      style: {
        fontSize: size
      },
      marginLeft: 0,
      marginRight: 0,
      x: {
        label: null,
      },
      marks: [
        Plot.dot(alphabet, {
          x: "letter",
          r: d => d.frequency * 1,
          fill: "letter",
          title: d => d3.format(".0%")(d.frequency),
          tip: true,
        })
      ]
    };

    function makeFlat(data) {
      let final = [];
      let countries = data.map((d) => d.country);
      let years = Object.keys(data[0]).slice(0, Object.keys(data[0]).length - 1);

      countries.forEach((country) => {
        let match = data.find((f) => f.country == country);
        years.forEach((year) => {
          let obj = {
            country,
            year,
            val: match[`${year}`]
          };
          final.push(obj);
        });
      });

      return final;
    };

    function bumpMarks(data, {
      r = 3,
      curve = "bump-x",
      tip,
      ...options
    }) {
      options = Plot.stackY2(options);
      return Plot.marks(
        Plot.line(data, {
          ...options,
          tip,
          stroke: options.z,
          curve,
          fill: null
        }),
        Plot.dot(data, {
          ...options,
          fill: options.z,
          r
        }),
        Plot.text(data, {
          fill: options.z,
          dy: -12,
          ...options,
          text: options.y
        }),
        Plot.text(
          data,
          Plot.selectFirst({
            ...options,
            text: options.z,
            dx: -(5 + (r || options.strokeWidth / 2)),
            textAnchor: "end",
            fill: "currentColor"
          })
        ),
        Plot.text(
          data,
          Plot.selectLast({
            ...options,
            text: options.z,
            dx: 5 + (r || options.strokeWidth / 2),
            textAnchor: "start",
            fill: "currentColor"
          })
        )
      );
    }

    var flatGasExports = makeFlat(gasExports);

    var bumpGas = {
      width: width,
      style: {
        fontSize: size,
        paddingTop: 24,
        paddingBottom: 24,
        paddingLeft: 35,
        paddingRight: 35
      },
      margin: 0,
      x: {
        domain: Object.keys(gasExports[0]).slice(
          0,
          Object.keys(gasExports[0]).length - 1
        ),
        label: null
      },
      y: {
        axis: null,
        domain: [6, 1]
      },
      color: {
        domain: d3
          .groupSort(
            flatGasExports,
            (v) => v[0].val,
            (d) => d.country
          )
          .reverse()
      },
      marks: [
        bumpMarks(flatGasExports, {
          x: "year",
          z: "country",
          order: "val",
          reverse: true
        })
      ]
    };


    donut_emissions = new function() {
      // d3 donut chart: https://observablehq.com/@d3/donut-chart/2
      var data = [{
        "name": "<5",
        "value": 19912018
      }, {
        "name": "5-9",
        "value": 20501982
      }, {
        "name": "10-14",
        "value": 20679786
      }, {
        "name": "15-19",
        "value": 21354481
      }, {
        "name": "20-24",
        "value": 22604232
      }, {
        "name": "25-29",
        "value": 21698010
      }, {
        "name": "30-34",
        "value": 21183639
      }, {
        "name": "35-39",
        "value": 19855782
      }, {
        "name": "40-44",
        "value": 20796128
      }, {
        "name": "45-49",
        "value": 21370368
      }, {
        "name": "50-54",
        "value": 22525490
      }, {
        "name": "55-59",
        "value": 21001947
      }, {
        "name": "60-64",
        "value": 18415681
      }, {
        "name": "65-69",
        "value": 14547446
      }, {
        "name": "70-74",
        "value": 10587721
      }, {
        "name": "75-79",
        "value": 7730129
      }, {
        "name": "80-84",
        "value": 5811429
      }, {
        "name": "≥85",
        "value": 5938752
      }];

      const height = Math.min(width, 500);
      const radius = Math.min(width, height) / 2;

      const arc = d3.arc()
        .innerRadius(radius * 0.67)
        .outerRadius(radius - 1);

      const pie = d3.pie()
        .padAngle(1 / radius)
        .sort(null)
        .value(d => d.value);

      const color = d3.scaleOrdinal()
        .domain(data.map(d => d.name))
        .range(d3.quantize(t => d3.interpolateSpectral(t * 0.8 + 0.1), data.length).reverse());

      const svg = d3.select("#donut_emissions").append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("viewBox", [-width / 2, -height / 2, width, height])
        .attr("style", "max-width: 100%; height: auto;");

      svg.append("g")
        .selectAll()
        .data(pie(data))
        .join("path")
        .attr("fill", d => color(d.data.name))
        .attr("d", arc)
        .append("title")
        .text(d => `${d.data.name}: ${d.data.value.toLocaleString()}`);

      svg.append("g")
        .attr("font-family", "sans-serif")
        .attr("font-size", 12)
        .attr("text-anchor", "middle")
        .selectAll()
        .data(pie(data))
        .join("text")
        .attr("transform", d => `translate(${arc.centroid(d)})`)
        .call(text => text.append("tspan")
          .attr("y", "-0.4em")
          .attr("font-weight", "bold")
          .text(d => d.data.name))
        .call(text => text.filter(d => (d.endAngle - d.startAngle) > 0.25).append("tspan")
          .attr("x", 0)
          .attr("y", "0.7em")
          .attr("fill-opacity", 0.7)
          .text(d => d.data.value.toLocaleString("en-US")));

      return svg.node();
    };

    var myColors = [{
        group: "Frodo, Sam, Merry, Pippin",
        color: "gold"
      },
      {
        group: "Frodo, Sam, Merry, Pippin, Strider",
        color: "orange"
      },
      {
        group: "Everybody",
        color: "teal"
      },
      {
        group: "Fellowship",
        color: "skyblue"
      },
      {
        group: "Fellowship sans Gandalf",
        color: "lightgreen"
      },
      {
        group: "Frodo, Sam and Gollum",
        color: "orchid"
      },
      {
        group: "Frodo and Sam",
        color: "darkorchid"
      },
      {
        group: "Remaining members of the Fellowship",
        color: "navy"
      }
    ];
    var domainByDate = tasks.sort((a, b) => d3.ascending(a.startDate, b.startDate)).map(d => d.task);
    var domainByGroup = d3.groups(tasks, d => d.group).sort((a, b) => d3.ascending(a.startDate, b.startDate)).map(d => d[0]);
    var parser = d3.utcParse("%Y-%m-%d");
    var colorMap = new Map(myColors.map((obj) => [obj.group, obj.color]));
    var colors = domainByGroup.map((d) => colorMap.get(d));

    var gantt = {
      width: width,
      style: {
        fontSize: size,
      },
      marginLeft: 0,
      marginRight: 0,
      x: {
        grid: true
      },
      y: {
        domain: domainByDate,
        label: null,
        tickFormat: null,
        tickSize: null,
        grid: false,
      },
      color: {
        domain: domainByGroup,
        range: colors,
        legend: true
      },
      marks: [
        Plot.barX(tasks, {
          y: "task",
          x1: (d) => parser(d.startDate),
          x2: (d) => parser(d.endDate),
          fill: "group",
          rx: 3,
          title: (d) =>
            `${d.group}\nStage: ${d.task}\nDescription: ${d.description}\nStart: ${d.startDate}\n End: ${d.endDate}`
        }),
        Plot.text(tasks, {
          y: "task",
          x: (d) => parser(d.startDate),
          text: (d) => d.task,
          textAnchor: "start",
          stroke: "white",
          strokeWidth: 0.65,
          fill: "dimgray",
          fontWeight: 500
        })
      ],
    };

    // https://observablehq.com/@fil/ternary-plot
    ternaryprojection = ({
      width,
      height,
      angle = 0
    }) => {
      const sqrt3_2 = Math.sqrt(3) / 2;
      let scale = 1;
      let tx = 0;
      let ty = 0;
      const ca = Math.cos((angle * Math.PI) / 180);
      const sa = Math.sin((angle * Math.PI) / 180);
      const q = (x, y) => [x + y * 0.5, -y * sqrt3_2];
      const p = (x, y) => {
        [x, y] = q(x, y);
        return [scale * (x * ca + y * sa) + tx, scale * (y * ca - x * sa) + ty];
      };
      const projection = d3.geoTransform({
        point: function(x, y) {
          this.stream.point(...p(x, y));
        },
        sphere: function() {
          this.stream.polygonStart();
          this.stream.lineStart();
          this.stream.point(...p(0, 0));
          this.stream.point(...p(0, 1));
          this.stream.point(...p(1, 0));
          this.stream.point(...p(0, 0));
          this.stream.lineEnd();
          this.stream.polygonEnd();
        }
      });

      // Fit bounds (with angle!)
      const [
        [x1, y1],
        [x2, y2]
      ] = d3
        .geoPath(projection)
        .bounds({
          type: "Sphere"
        });
      const w = width / (x2 - x1);
      const h = height / (y2 - y1);
      scale = Math.min(w, h);
      tx = w > scale ? width / 2 - (scale * (x2 + x1)) / 2 : -x1 * scale;
      ty = w < scale ? height / 2 - (scale * (y2 + y1)) / 2 : -y1 * scale;
      return projection;
    }
    ternarygraticule = (options) =>
      Plot.link(
        d3.range(0.1, 1, 0.1).flatMap((d) => [
          [d, 0, 0, d],
          [d, 0, d, 1 - d],
          [0, d, 1 - d, d]
        ]), {
          x1: "0",
          y1: "1",
          x2: "2",
          y2: "3",
          stroke: "#aaa",
          strokeWidth: 0.5,
          ...options
        }
      )
    var ternaryAxes = ["designer", "journalist", "developer"];
    ternaryTickLabels = (
      data = d3.range(0.1, 1, 0.1), {
        tickFormat = ".0%",
        ...options
      } = {}
    ) => {
      const text = d3.format(tickFormat);
      return Plot.marks(
        Plot.text(data, {
          x: (d) => 1 - d,
          y: 0,
          text,
          rotate: 60,
          textAnchor: "start",
          dx: 2,
          dy: 5,
          ...options
        }),
        Plot.text(data, {
          x: 0,
          y: (d) => d,
          text,
          rotate: 0,
          textAnchor: "end",
          dx: -5,
          dy: 0,
          ...options
        }),
        Plot.text(data, {
          x: (d) => d,
          y: (d) => 1 - d,
          text,
          textAnchor: "start",
          rotate: -60,
          dx: 2,
          dy: -5,
          ...options
        })
      );
    }
    ternarynormalize = ({
      a,
      b,
      c,
      ...options
    } = {}) => {
      if (a == null) throw new Error("missing channel a");
      if (b == null) throw new Error("missing channel b");
      if (c == null) throw new Error("missing channel c");
      const [X, setX] = Plot.column(a); // Using a hides x from the tip!
      const [Y, setY] = Plot.column(b);
      return Plot.transform({
        x: X,
        y: Y,
        ...options
      }, (data, facets) => {
        const A = Plot.valueof(data, a);
        const B = Plot.valueof(data, b);
        const C = Plot.valueof(data, c);
        setX(A.map((d, i) => d / (A[i] + B[i] + C[i])));
        setY(B.map((d, i) => d / (A[i] + B[i] + C[i])));
        return {
          data,
          facets
        };
      });
    };
    ternarylabels = (data, options) =>
      Plot.text(data, {
        x: (_, i) => [1.075, -0.025, -0.025][i],
        y: (_, i) => [-0.05, 1.05, -0.05][i],
        text: Plot.identity,
        ...options
      })
    ternary = ({
      ternaryprojection,
      ternarygraticule,
      ternarynormalize,
      sphere: Plot.sphere,
      ternaryTickLabels,
      ternarylabels
    });
    var group = Object.assign((d) => d3.greatest(ternaryAxes, (k) => d[k]), {
      label: "group"
    });
    var ternary = {
      width: width,
      marginLeft: 0,
      marginRight: 0,
      insetBottom: 30,
      style: {
        fontSize: size,
        textTransform: "capitalize",
        paddingBottom: 10
      },
      color: {
        legend: true,
        style: {
          textTransform: "capitalize"
        },
      },
      projection: ternary.ternaryprojection,
      marks: [
        Plot.sphere(),
        ternary.ternarygraticule({
          strokeDasharray: "5 1.5"
        }),

        // A blob for each group
        Plot.density(
          profiles,
          ternary.ternarynormalize({
            a: "designer",
            b: "journalist",
            c: "developer",
            stroke: group,
            bandwidth: 35,
            thresholds: 2
          })
        ),
        Plot.dot(
          profiles,
          ternary.ternarynormalize({
            a: "designer",
            b: "journalist",
            c: "developer",
            fill: group,
            stroke: "white",
            r: 8,
            channels: {
              label: "name",
              journalist: "journalist",
              developer: "developer",
              designer: "designer"
            },
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
            },
          })
        ),

        ternary.ternaryTickLabels(d3.range(0.5, 1, 0.1), {
          fill: "currentColor",
          stroke: "white"
        }),
        ternary.ternarylabels(ternaryAxes, {
          fontWeight: "bold"
        })
      ]
    };

    // Draw the plot (data local on page)
    document.getElementById("civilizations").appendChild(Plot.plot(civ_options));
    document.getElementById("wework").appendChild(Plot.plot(wework));
    document.getElementById("animals").appendChild(Plot.plot(animals));
    document.getElementById("example_dot").appendChild(Plot.plot(example_dot));
    document.getElementById("network").appendChild(Plot.plot(network));
    document.getElementById("country_emissions").appendChild(Plot.plot(country_emissions));
    document.getElementById("ternary").appendChild(Plot.plot(ternary));
    document.getElementById("gantt").appendChild(Plot.plot(gantt));
    document.getElementById("bumpGas").appendChild(Plot.plot(bumpGas));

    var boxY = function boxY(data, {
      x = null,
      y = {
        transform: x => x
      },
      fill = "#DFDFDF",
      stroke = "currentColor",
    } = {}) {
      const group = x == null ? Plot.groupZ : Plot.groupX;
      return Plot.marks(
        Plot.ruleX(data, group({
          y1: iqr1,
          y2: iqr2
        }, {
          x,
          y,
          stroke
        })),
        Plot.barY(data, group({
          y1: quartile1,
          y2: quartile3
        }, {
          x,
          y,
          fill
        })),
        Plot.tickY(data, group({
          y: "median"
        }, {
          x,
          y,
          stroke,
          strokeWidth: 2
        })),
        Plot.dot(data, Plot.map({
          y: outliers
        }, {
          x,
          y,
          z: x,
          stroke
        }))
      );
    };
    var outliers = function outliers(values) {
      const r1 = iqr1(values);
      const r2 = iqr2(values);
      return values.map(v => v < r1 || v > r2 ? v : NaN);
    };

    var iqr1 = V => {
      const hi = quartile1(V);
      const lo = hi - 1.5 * (quartile3(V) - hi);
      return d3.min(V, v => lo <= v && v <= hi ? v : NaN);
    };

    var iqr2 = V => {
      const lo = quartile3(V);
      const hi = lo + 1.5 * (lo - quartile1(V));
      return d3.max(V, v => lo <= v && v <= hi ? v : NaN);
    };

    var quartile1 = V => d3.quantile(V, 0.25);
    var quartile3 = V => d3.quantile(V, 0.75);

    // Formatting functions
    formatChange = new function() {
      const format = d3.format("+d");
      return x => format((x - 1) * 100);
    };

    formatCurrency = new function() {
      const format = d3.format("$.2f");
      return x => format(x);
    };

    formatPercent = new function() {
      const format = d3.format(".2%");
      return x => format(x);
    };

    formatWhole = new function() {
      const format = d3.format(",");
      return x => format(x);
    };

    formatLog = new function() {
      const format = d3.format(".2s");
      return x => format(x);
    };


    parseTime = new function() {
      const format = d3.timeParse("%Y");
      return x => format(x);
    };

    const formatTime = d3.timeFormat("%Y");
    const formatDate = d3.timeFormat("%B %d, %Y");
    var formatUS = new Intl.NumberFormat("en-US", {
      notation: "compact",
      compactDisplay: "short",
      style: "currency",
      currency: "USD"
    }).format;


    // Use Promises to async request data
    var promises = [d3.json("data/drugs.json"), d3.csv("data/aapl.csv", d3.autoType), d3.csv("data/global-temps.csv", d3.autoType), d3.csv("https://gist.githubusercontent.com/JesseCHowe/099f4b8e1a029c0b4af35b1edc1989f7/raw/8c18ed9a0940c734d423c3f2699ee063279533ec/morley.csv", d3.autoType), d3.csv("data/stocks.csv", d3.autoType), d3.csv("data/units.csv", d3.autoType), d3.json("data/qatar.json"), d3.csv("https://raw.githubusercontent.com/plotly/datasets/master/gapminderDataFiveYear.csv", d3.autoType), d3.csv("data/driving.csv", d3.autoType), d3.csv("data/bls.csv", d3.autoType), d3.csv("data/caltrain.csv"), d3.csv("data/mpg.csv", d3.autoType), d3.csv("data/electricity.csv", d3.autoType), d3.json("data/dogdata.json"), d3.csv("data/google-trends-2020.csv", d3.autoType), d3.csv("data/covid.csv", d3.autoType), d3.csv("data/commute.csv", d3.autoType), d3.csv("data/world-airports.csv", d3.autoType), d3.json("data/geo/land.json"), d3.json("data/geo/statemesh.json"), d3.json("data/geo/nation.json"), d3.csv("data/walmarts.csv", d3.autoType), d3.csv("data/popcornCriteria.csv", d3.autoType), d3.csv("data/state-population-2010-to-2019.csv", d3.autoType), d3.csv("data/geo/us-state-grid.csv", d3.autoType), d3.csv("data/bls_industries.csv", d3.autoType), d3.csv("data/weather.csv", d3.autoType), d3.csv("data/receipts.csv", d3.autoType), d3.csv("data/cancer.csv", d3.autoType), d3.csv("data/us-population-county-2016.csv", d3.autoType), d3.csv("data/hstdebt.csv", d3.autoType), d3.json("data/geo/us-counties-10m.json"), d3.csv("data/us-president-favorability@2.csv", d3.autoType), ];

    // You can request multiple srcs in a promise
    myDataPromises = Promise.all(promises);

    // After data is successfully fetched, generate viz
    myDataPromises.then(function(data) {
      // Define the data. There's gotta be a better way to do this:
      var drugs = data[0];
      var aapl = data[1];
      var hadcrut = data[2];
      var morley = data[3];
      var stocks = data[4];
      var units = data[5];
      var qatar = data[6];
      var gapminder = data[7];
      var driving = data[8];
      var bls = data[9];
      var caltrain = data[10];
      var mpg = data[11];
      var electric = data[12];
      var dogdata = data[13];
      var google = data[14];
      var covid = data[15];
      var commute = data[16];
      var airports = data[17];
      var land = data[18];
      var statemesh = data[19];
      var nation = data[20];
      var walmarts = data[21];
      var popcorndata = data[22];
      var statepop = data[23];
      var stategrid = data[24];
      var industries = data[25];
      var weather = data[26];
      var receipts = data[27];
      var cancer = data[28];
      var countypop = data[29];
      var hstdebt = data[30];
      var counties = data[31];
      var presidents = data[32];

      var sortedData = popcorndata.filter(function(d, i) {
        return i < 30; // Top 5 teams
      });

      var popcorn = {
        style: {
          fontSize: size,
          paddingLeft: width > 450 ? 95 : 70,
          paddingBottom: 35,
          paddingTop: 35,
        },
        width: width,
        aspectRatio: 2,
        x: {
          axis: "both",
          label: null,
          tickSize: 0,
          tickRotate: 35,
          fontSize: 16,
        },
        y: {
          domain: sortedData.map(d => d.Team),
          label: null,
          tickSize: 0,
          axis: null,
        },
        color: {
          legend: true,
          scheme: "oranges",
          zero: true,
          style: {
            fontSize: size
          },
        }, // Need to pass style{} twice, once for X axis, once for legend axis
        marks: [
          Plot.frame({
            stroke: "#DFDFDF",
            anchor: "top"
          }),
          Plot.text(sortedData, {
            y: "Team",
            dx: -10,
            dy: width > 450 ? -2 : -2,
            text: (d) => `${d.Team}`,
            frameAnchor: "left",
            textAnchor: "end",
            lineAnchor: "bottom",
            fontWeight: "bold",
            fontSize: width > 450 ? 16 : ".5rem",
          }), // Team name
          Plot.text(sortedData, {
            y: "Team",
            dx: -10,
            dy: width > 450 ? 4 : 2,
            text: (d) => `${d.Arena}`,
            frameAnchor: "left",
            textAnchor: "end",
            lineAnchor: "top",
            fontSize: width > 450 ? 14 : ".45rem",
            fontWeight: "normal"
          }), // Arena name
          Plot.cell(sortedData.filter(d => (d.Criteria != "Total Score")), {
            y: "Team",
            x: "Criteria",
            fill: "Score",
            inset: .85,
            channels: {
              Arena: "Arena",
            },
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            },
          }),
          Plot.cell(sortedData.filter(d => (d.Criteria == "Total Score")), {
            y: "Team",
            x: "Criteria",
            fill: "white",
            inset: .85,
          }),
          Plot.text(sortedData.filter(d => (d.Criteria != "Total Score")), {
            y: "Team",
            x: "Criteria",
            text: "Score",
            fill: "white",
            fontSize: width > 450 ? 18 : ".8rem",
            fontWeight: "bold"
          }),
          Plot.text(sortedData.filter(d => (d.Criteria == "Total Score")), {
            y: "Team",
            x: "Criteria",
            text: "Score",
            fill: "black",
            fontSize: width > 450 ? 18 : ".8rem",
            fontWeight: "bold"
          }),
        ]

      };

      // https://observablehq.com/@observablehq/plot-slope-chart ? 
      var slope = {
        width: width,
        marginRight: 0,
        marginLeft: 0,
        style: {
          fontSize: size + 2,
        },
        height: 540,
        x: {
          axis: "top",
          type: "ordinal",
          tickFormat: "",
          inset: 90,
          label: null
        },
        y: {
          axis: null,
          inset: 20
        },
        marks: [
          Plot.line(receipts, {
            x: "year",
            y: "receipts",
            z: "country"
          }),
          d3.groups(receipts, (d) => d.year === 1970)
          .map(([left, receipts]) =>
            Plot.text(receipts, occlusionY({
              x: "year",
              y: "receipts",
              text: left ?
                (d) => `${d.country} ${d.receipts}` : (d) => `${d.receipts} ${d.country}`,
              textAnchor: left ? "end" : "start",
              dx: left ? -3 : 3,
              radius: 5.5
            }))
          )
        ],
      };

      // https://observablehq.com/@observablehq/plot-cancer-survival-rates as second slop example 
      var intslope = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          paddingLeft: 30,
          paddingRight: 30
        },
        height: 700,
        x: {
          axis: "top",
          type: "point",
          domain: ["5 Year", "10 Year", "15 Year", "20 Year"],
          inset: 60,
          label: null
        },
        y: {
          axis: null,
          inset: 20
        },
        marks: [
          Plot.line(cancer, {
            x: "year",
            y: "survival",
            z: "name"
          }),
          d3
          .groups(cancer, (d) => d.year)
          .map(([year, cancer]) =>
            Plot.text(
              cancer,
              occlusionY({
                x: "year",
                y: "survival",
                text: year === "5 Year" ?
                  (d) => `${d.name} ${d.survival}` : year === "20 Year" ?
                  (d) => `${d.survival} ${d.name}` : "survival",
                textAnchor: year === "5 Year" ?
                  "end" : year === "20 Year" ?
                  "start" : "middle",
                fill: "currentColor",
                stroke: "white",
                strokeWidth: 2.5,
                strokeLinecap: "round",
                fontSize: 12,
                dx: year === "5 Year" ? -3 : year === "20 Year" ? 3 : 0
              })
            )
          )
        ]
      };

      var electricity = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          paddingRight: 60,
        },
        color: {
          scheme: "BuRd"
        },
        x: {
          tickPadding: 10,
          label: null,
          grid: true,
          tickSize: 0,
        },
        y: {
          tickFormat: "%",
          ticks: 5,
          tickSize: 0,
          nice: true,
          clamp: true,
          grid: true,
          label: null
        },
        marks: [
          Plot.ruleY([0]),
          Plot.gridX(),
          Plot.areaY(electric, Plot.stackY({
            x: "year",
            y: "percentage",
            fill: "source",
            tip: {
              format: {
                y: (d) => formatPercent(d),
                x: (d) => formatTime(d),
                stroke: false
              },
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
            },
            opacity: .85,
            order: ['Coal', 'Gas', 'Oil', 'Nuclear', 'Hydroelectric', 'Wind', 'Solar', 'Other renewables'],
            offset: "expand"
          })),
          Plot.text(electric, Plot.selectLast(Plot.stackY({
            x: "year",
            y: "percentage",
            z: "source",
            order: ['Coal', 'Gas', 'Oil', 'Nuclear', 'Hydroelectric', 'Wind', 'Solar', 'Other renewables'],
            offset: "expand",
            fill: "source",
            text: d => d.source == 'Other renewables' ? "- Other" : '- ' + d.source,
            rotate: 5,
            fontSize: 16,
            fontWeight: "bold",
            textAnchor: "start",
            dx: 4,
            dy: 3
          }))),
        ],
      };

      var apple_area = {
        width: width,
        style: {
          fontSize: size,
          paddingTop: 10,
          paddingRight: 10,
        },
        marginRight: 0,
        y: {
          grid: true,
        },
        marks: [
          Plot.areaY(aapl, {
            x: "Date",
            y: "Close",
            fill: "url(#gradient)"
          }),
          Plot.lineY(aapl, {
            x: "Date",
            y: "Close",
            title: d => formatCurrency(d.Close),
            stroke: "rgba(0, 0, 0, .75)",
            tip: true,
          }),
          Plot.dot(aapl, Plot.selectLast({
            x: "Date",
            y: "Close",
            fill: "white",
            stroke: "rgba(0, 0, 0, .75)"
          })),
          Plot.text(aapl, Plot.selectLast({
            x: "Date",
            y: "Close",
            text: d => formatCurrency(d.Close),
            dy: -12,
            dx: -12,
          })),
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            dx: 2, // offset right
            dy: -6, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}` : d), // Show $ on first tick only,
            labelOffset: 5,
          }),
        ],
      };

      var beeswarm = {
        width: widthMid,
        inset: 20,
        marginBottom: 40,
        marginTop: 20,
        marginLeft: 0,
        marginRight: 0,
        height: width > 450 ? 220 : width,
        style: {
          fontSize: size,
          paddingTop: 20,
          paddingBottom: 30,
        },
        x: {
          labelOffset: 40,
        },
        marks: [
          Plot.image(
            presidents,
            Plot.dodgeY({
              x: "First Inauguration Date",
              r: 20, // clip to a circle
              preserveAspectRatio: "xMidYMin slice", // try not to clip heads
              src: "Portrait URL",
              title: "Name",
              tip: true,
            })
          )
        ]
      };

      const tinyapple = aapl.slice(-90);
      var candlestick = {
        width: width,
        marginRight: 0,
        marginTop: 30,
        style: {
          fontSize: size,
        },
        grid: true,
        inset: 4,
        y: {
          label: "↑ Apple stock price ($)",
          tickFormat: "$f",
          anchor: "top",
          tickSize: 0,
          ticks: 4,
          nice: true,
        },
        x: {
          nice: true,
          tickSize: 0,
          nice: true,
        },
        color: {
          range: ["#e41a1c", "#000000", "#4daf4a"]
        },
        marks: [
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            ticks: 4,
            dx: 2, // offset right
            dy: -4, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            tickFormat: (d, i, _) => (i === _.length - 1 ? `$${d}` : d) // Show $ on first tick only
          }),
          Plot.ruleX(tinyapple, {
            x: "Date",
            y1: "Low",
            y2: "High"
          }),
          Plot.ruleX(tinyapple, {
            x: "Date",
            y1: "Open",
            y2: "Close",
            stroke: d => Math.sign(d.Close - d.Open),
            strokeWidth: 4,
            strokeLinecap: "round",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
              channels: {
                Open: "Open",
                Close: "Close",
                Date: d => formatDate(new Date(d.Date)),
                High: "High",
                Low: "Low"
              },
              format: {
                y: false,
                x: false,
                High: "$.2f",
                Low: "$.2f",
                Open: "$.2f",
                Close: "$.2f",
                stroke: true,
              }
            },
          })
        ]
      };

      var freq_letters = {
        width: width,
        style: {
          fontSize: size,
          paddingRight: 10,
        },
        marginLeft: 0,
        marginRight: 12,
        x: {
          label: null,
          tickSize: 0,
        },
        y: {
          label: "↑ Frequency (%)",
          grid: true,
          tickSize: 0,
          tickFormat: "%",
          ticks: 6,
          tickSize: 0,
          nice: true,
          clamp: true,
          anchor: "start",
        },
        color: {
          domain: ["frequent", "not"],
          range: ["hsl(168, 78%, 41%)", "rgba(204,204,204,.8)"],
        },
        marks: [
          // Transform data example, ternary operator example for style
          Plot.barY(alphabet, {
            x: "letter",
            y: d => d.frequency,
            fill: d => d.frequency > .08 ? "frequent" : "not",
            opacity: .9,
            title: d => "Letter " + (d.letter) + "\n" + formatPercent(d.frequency),
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            },
          }),
          Plot.ruleY([0], {
            stroke: "hsl(0, 0%, 88%)"
          }),
          Plot.axisY({
            textAnchor: "start",
            dx: -2,
            dy: -10,
            tickSize: 0,
            ticks: 6,
            nice: true,
            clamp: true,
            grid: true,
            tickFormat: "%",
            anchor: "right",
            labelOffset: 10,
          })
        ]
      };

      var drug_bar = {
        width: width,
        style: {
          fontSize: size
        },
        x: {
          label: null,
          tickSize: 0,
          tickRotate: -35,
        },
        color: {
          domain: ["small", "big"],
          range: ["hsl(168, 78%, 41%)", "hsl(0, 0%, 88%)"]
        },
        y: {
          grid: true,
          tickFormat: "",
          ticks: 8,
        },
        marks: [
          Plot.barY(drugs, {
            x: "Drug",
            y: "Pleasure",
            title: "Drug",
            fill: d => d.Pleasure > 2.4 ? "small" : "big"
          }),
          Plot.text(drugs, {
            x: "Drug",
            y: "Pleasure",
            text: d => (d.Pleasure).toFixed(1),
            dy: -5
          }),
        ]
      };

      var anomaly_barcode = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          paddingTop: 20,
        },
        x: {
          round: true,
        },
        color: {
          type: "diverging",
          scheme: "BuRd",
          legend: true,
          label: "Temperature Change (℃) →",
          tickFormat: "+f",
          tickSize: 0,
          style: {
            fontSize: size
          },
        },
        marks: [
          Plot.barX(hadcrut, {
            x1: d => d.date, // start of current year
            x2: d => d3.utcYear.offset(d.date), // start of next year
            fill: "value",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            },
            title: (d) =>
              `${d3.timeFormat("%B %d, %Y")(d["date"])} \nAnomaly: ${d3.format("+.3f")(d["value"])}℃`,
          }),
        ],
      };

      var stocks_baseline = {
        width: width,
        style: {
          fontSize: size,
          backgroundColor: backgroundColor,
          padding: "10",
          paddingRight: 30
        },
        inset: 5,
        color: {
          scheme: "BuRd"
        },
        y: {
          type: "log",
          label: "Change in price (%)",
          grid: true,
          anchor: "left",
          tickSize: 0,
          tickPadding: 6,
          tickFormat: formatChange,
        },
        marks: [
          Plot.ruleY([1]),
          Plot.line(stocks, Plot.normalizeY({
            x: "Date",
            y: "Close",
            stroke: "Symbol",
            tip: {
              format: {
                x: (d) => formatTime(d),
                y: (d) => formatPercent(d),
              },
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            }
          })),
          Plot.text(stocks, Plot.selectLast(Plot.normalizeY({
            x: "Date",
            y: "Close",
            z: "Symbol",
            fill: "Symbol",
            text: "Symbol",
            textAnchor: "start",
            fontSize: width > 450 ? 14 : 12,
            fontWeight: 700,
            dx: 3
          })))
        ]
      };

      var anomaly_dot = {
        width: width,
        style: {
          fontSize: size,
        },
        marginRight: 0,
        grid: true,
        inset: 4,
        y: {
          nice: true,
          tickFormat: d => d3.format("+.1f")(d) + " ℃",
          label: null,
          tickSize: 0,
          ticks: 4
        },
        x: {
          nice: true,
          tickSize: 0,
        },
        color: {
          scheme: "BuRd",
          range: [0, 1.3], // clamping the color scheme so that blue appears below the x axis, red above
          reverse: false,
          legend: true,
          label: "Temperature Change (℃) →",
          tickFormat: "+f",
          tickSize: 0,
          style: {
            fontSize: size
          },
        },
        marks: [
          Plot.ruleY([0], {
            stroke: "rgba(0,0,0,.6)"
          }),
          Plot.dot(hadcrut, {
            x: "date",
            y: "value",
            r: width < 500 ? 1 : 3,
            opacity: .9,
            stroke: "value",
            fill: "value",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            },
            title: (d) => `${d3.timeFormat("%B %d, %Y")(d["date"])} \nTemp: ${d3.format("+.2f")(d["value"])}℃`,
          }),
          Plot.lineY(hadcrut, Plot.windowY(12, {
            x: "date",
            y: "value",
            stroke: "currentColor",
            strokeOpacity: .55
          }))
        ]
      };

      var google_ridgeline = {
        width: width,
        style: {
          fontSize: size,
          paddingLeft: 50,
          paddingRight: 10,
          margin: 0,
          padding: 0,
        },
        margin: 0,
        x: {
          axis: "top",
          label: null,
          tickFormat: "%B",
          nice: true,
        },
        y: {
          axis: null,
        },
        fy: {
          round: true,
          label: null,
        },
        facet: {
          data: google,
          y: "search",
          marginLeft: width > 450 ? width / 8 : width / 4,
        },
        color: {
          scheme: "tableau10",
          reverse: true,
        },
        marks: [
          Plot.areaY(google, {
            x: "week",
            y: "interest",
            fill: "search",
            fillOpacity: 0.42,
            sort: {
              fy: "y",
              reduce: "max-index"
            }
          }),
          Plot.line(google, {
            x: "week",
            y: "interest",
            stroke: "white",
            title: (d) => `${d.search}\n${d3.timeFormat("%B %d, %Y")(d["week"])} \nRanking: ${d.interest}`,
            strokeWidth: 1,
            tip: {
              opacity: 0.8,
              textPadding: 10,
              lineHeight: 1.5,
            },
          }),
          Plot.ruleY([0], {
            stroke: "rgba(204,204,204,.8)"
          }),
        ]
      };

      var morley = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          paddingTop: 10,
          paddingBottom: 10
        },
        y: {
          nice: true,
          clamp: true,
          inset: 6,
          tickSize: 0,
          anchor: "left",
          labelOffset: 4,
          ticks: 4,
          grid: true,
          label: "Speed of light (km/s minus 299,000)"
        },
        x: {
          label: "Experiment",
          labelOffset: 40,
          labelAnchor: "center",
        },
        marks: [
          Plot.text(["True speed"], {
            stroke: "white",
            strokeWidth: 1,
            fill: "currentColor",
            frameAnchor: "middle",
            dy: 50
          }),
          boxY(morley, {
            x: "Expt",
            y: "Speed",
            fill: "hsl(43, 89%, 70%)"
          }),
          Plot.ruleY([790], {
            stroke: "currentColor",
            strokeWidth: 1,
            strokeDasharray: "5 1.5"
          }),
        ]
      };

      var gapminder = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          paddingTop: 10,
        },
        inset: 2,
        y: {
          // grid: true,
          label: "Life expectency",
          ticks: 4,
          tickFormat: formatWhole,
          anchor: "left"
        },
        x: {
          type: "log",
          tickFormat: formatLog,
          label: "GDP per capita (log)",
          tickFormat: "~s",
          className: "axis-x",
          labelOffset: -10,
        },
        marks: [
          Plot.dot(gapminder.filter(d => (d.year === 2007)), {
            x: "gdpPercap",
            y: "lifeExp",
            r: "pop",
            fill: "continent",
            channels: {
              country: "country",
            },
            tip: {
              format: {
                y: (d) => d + ` years`,
                x: "$~s",
              },
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
            }
          }),
          Plot.ruleY([40], {
            stroke: "rgba(204,204,204,.8)"
          }),
          Plot.ruleX([250], {
            stroke: "rgba(204,204,204,.8)"
          }),
        ]
      };

      // https://observablehq.com/@observablehq/plot-bullet-graph
      var bullet = {
        width: width,
        height: 340,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        marginRight: 0,
        x: {
          grid: true,
          ticks: d3.range(0, 51, 10),
          tickSize: 0,
        },
        y: {
          label: null,
          domain: ["80+", "65-79", "50-64", "35-49", "18-34", "0-17"],
          tickSize: 0,
        },
        facet: {
          data: covid,
          x: "race",
          label: null,
        },
        color: {
          scheme: "dark2"
        },
        marks: [
          Plot.axisX({ // Draw second axis for clearer labeling
            axis: "top",
            tickFormat: (d) => (d === 50 ? `${d}%` : `${d}`),
          }),
          Plot.barX(covid, {
            x: "population_percent",
            y: "age",
            fill: "#ddd",
            insetTop: 2,
            insetBottom: 2
          }),
          Plot.barX(covid, {
            x: "cases_percent",
            y: "age",
            fill: "race",
            sort: {
              fx: "x",
              reverse: true
            },
            insetTop: 6,
            insetBottom: 6,
            tip: {
              format: {
                x: d => d3.format(".2%")(d / 100),
              },
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.65,
            }
          })
        ]
      };

      var dotdensity = {
        width: width,
        marginLeft: 0,
        marginRight: 0,
        style: {
          fontSize: size,
          background: 'none',
          textTransform: 'capitalize',
          paddingTop: 10,
          paddingBottom: 10
        },
        // padding: 0.05,
        projection: "albers",
        color: {
          type: "quantize",
          scheme: "GnBu",
          unknown: "#ddd",
          label: "Decade store built",
          legend: true,
          tickSize: 0,
          style: {
            fontSize: size
          },
        },

        marks: [
          Plot.geo(nation, {
            strokeOpacity: 0.9,
            fill: "#222",
            opacity: .05
          }),
          Plot.geo(statemesh, {
            strokeOpacity: 0.7
          }),
          Plot.density(walmarts, {
            x: "longitude",
            y: "latitude",
            bandwidth: 3,
            fill: (d) => d.date.getUTCFullYear(),
            opacity: .15
          }),
          Plot.dot(walmarts, {
            x: "longitude",
            y: "latitude",
            r: 2,
            fill: (d) => d.date.getUTCFullYear(),
            opacity: .55,
            tip: {
              format: {
                fill: formatTime,
              },
              opacity: 0.85,
              textPadding: 10,
            },
          }),
        ]
      };

      var dotmap = {
        width: width,
        aspectRatio: 1,
        style: {
          fontSize: size,
          paddingTop: 10,
          paddingBottom: 10
        },
        projection: "equal-earth",
        marks: [
          Plot.graticule(),
          Plot.sphere(),
          Plot.geo(land, {
            fill: "#DFDFDF"
          }),
          Plot.delaunayMesh(airports, {
            x: "longitude",
            y: "latitude",
            opacity: 0.4,
            stroke: "black"
          }),
          Plot.dot(airports, {
            fill: "steelblue",
            opacity: .75,
            r: 2,
            x: "longitude",
            y: "latitude",
            title: "name",
            tip: true
          }),
        ],
      };

      var spikeMap = {
        width: width,
        // aspectRatio: 1,
        style: {
          fontSize: size,
          paddingTop: 10,
          paddingBottom: 10
        },
        projection: "albers-usa",
        length: {
          range: [0, 200]
        },
        marks: [
          Plot.geo(statemesh, {
            strokeOpacity: 0.5
          }),
          Plot.geo(nation),
          Plot.spike(counties, Plot.geoCentroid({
            length: (d) => d.properties.population,
            stroke: "green"
          }))
        ]
      };

      var driving_line = {
        width: widthMid,
        height: 500,
        marginRight: 0,
        style: {
          fontSize: width > 450 ? size : size - 2,
          paddingRight: 24
        },
        marginRight: 0,
        inset: 10,
        grid: true,
        x: {
          label: "Miles driven per capita each year →",
          labelOffset: 50,
          labelAnchor: "left"
        },
        y: {
          label: "↑ Cost of gasoline ($ per gallon)",
          tickFormat: formatCurrency,
          ticks: 6,
        },
        marks: [
          Plot.line(driving, {
            x: "miles",
            y: "gas",
            curve: "catmull-rom",
            strokeWidth: 2
          }),
          Plot.dot(driving, {
            x: "miles",
            y: "gas",
            fill: "white",
            stroke: "black",
            title: (d) => `${d3.timeFormat("%B %d, %Y")(d["year"])} \nGas price: ${d3.format("$.2f")(d["gas"])} \nMiles: ${d3.format(",.2r")(d["miles"])}`,
          }),
          Plot.text(driving.filter(d => (d.year == 1956)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => "Annual\naverage" : "",
            dx: -30,
            dy: 18,
            fontWeight: 700
          }),
          Plot.text(driving.filter(d => (d.year == 1956)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 1)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: -2,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 2)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -4,
            dy: 10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 3)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: -10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 3)), {
            x: "miles",
            y: "gas",
            dx: 12,
            dy: 90,
            fontSize: width > 450 ? 12 : 10,
            fontWeight: 900,
            text: d => "↑ Price of\na gallon\nof gasoline"
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 3)), {
            x: "miles",
            y: "gas",
            dx: 12,
            dy: 130,
            fontStyle: "italic",
            textAlign: "left",
            fontSize: width > 450 ? 12 : 10,
            fontWeight: 300,
            lineHeight: 1.3,
            text: d => "Annual average for\nregular grade gas,\nadjusted for inflation."
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 4)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: -4,
            fontSize: width > 450 ? 10 : 8
          }),
          // Plot.text(driving.filter(d => (d.year == 1956+5)), {x: "miles", y: "gas", text: d => "'61", dx: -2, 
          //   dy: 10, fontSize: 10}),
          Plot.text(driving.filter(d => (d.year == 1956 + 6)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 7)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: -4,
            dy: 9,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 8)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 2,
            dy: 10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 9)), {
            x: "miles",
            y: "gas",
            text: d => "'65",
            dx: 0,
            dy: 10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 9)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => "Cheap gas,\nlonger commutes" : "",
            dx: 40,
            dy: -84,
            fontWeight: 700
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 10)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: -9,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 11)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 12)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 13)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 14)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 15)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 16)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 16)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => "The Arab\noil embargo" : "",
            dx: 70,
            dy: -50,
            fontWeight: 700
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 17)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 18)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 19)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 20)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 21)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: -10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 22)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 23)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 24)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 25)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 26)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 26)), {
            x: "miles",
            y: "gas",
            text: d => "Energy crisis",
            dx: width > 400 ? 50 : 70,
            dy: -50,
            fontWeight: 700
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 27)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 28)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 29)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 30)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 31)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: -10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 32)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 33)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: -16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 34)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: -12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 35)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 36)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 37)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: -18,
            dy: 1,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 40)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => "Record low prices" : "",
            dx: -6,
            dy: -80,
            fontWeight: 700
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 38)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 39)), {
            x: "miles",
            y: "gas",
            text: width > 400 ? d => (d.year).toFixed(0) : "",
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 40)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: -10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 41)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 42)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 43)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 16,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 44)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -2,
            dy: -10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 45)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 46)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 6,
            dy: 10,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 47)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 48)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 49)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 50)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 51)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 52)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 53)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: 0,
            dy: 12,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 54)), {
            x: "miles",
            y: "gas",
            text: d => (d.year).toFixed(0),
            dx: -18,
            dy: 0,
            fontSize: width > 450 ? 10 : 8
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 54)), {
            x: "miles",
            y: "gas",
            text: d => "The swing backwards",
            dx: width > 400 ? -80 : -60,
            dy: -96,
            fontWeight: 700,
            style: {
              background: "white"
            }
          }),
          Plot.text(driving.filter(d => (d.year == 1956 + 54)), {
            x: "miles",
            y: "gas",
            dx: width > 400 ? -80 : -60,
            dy: -50,
            fontSize: width > 450 ? 12 : 10,
            lineHeight: 1.3,
            fontWeight: 300,
            text: d => "The average number of\nmiles that Americans\ndrive annually begins to\nfall, so the chart appears\nto turn around."
          }),
        ]
      };

      bands = 7;
      step = d3.max(industries, (d) => d.unemployed) / bands;

      var horizon_chart = {
        width: width,
        height: width + 100,
        axis: null,
        y: {
          domain: [0, step]
        },
        color: {
          scheme: "YlGnBu",
          legend: true,
          label: "Unemployement rate"
        },
        facet: {
          data: industries,
          y: "industry"
        },
        marks: [
          d3.range(bands).map((i) => Plot.areaY(industries, {
            x: "date",
            y: (d) => d.unemployed - i * step,
            fill: i,
            clip: true
          })),
          Plot.text(industries, Plot.selectFirst({
            text: "industry",
            frameAnchor: "top-left",
            dx: 6,
            dy: 6
          })),
          Plot.frame()
        ]
      };

      var example_line = {
        width: width,
        marginLeft: 0,
        style: {
          fontSize: size,
        },
        y: {
          tickFormat: formatUS,
          type: "log",
          tickSpacing: 40,
          grid: true,
          axis: "right"
        },
        x: {
          label: null,
        },
        marks: [
          Plot.lineY(hstdebt, {
            x: "Record Date",
            y: "Debt Outstanding Amount"
          })
        ]
      };

      var lollipop = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
        },
        x: {
          label: null,
          tickPadding: 6,
          tickSize: 0
        },
        y: {
          percent: true,
          nice: true,
          anchor: "left",
          label: "Frequency",
          ticks: 4,
        },
        marks: [
          Plot.ruleX(alphabet, {
            x: "letter",
            y: "frequency",
            strokeWidth: 2
          }),
          Plot.dot(alphabet, {
            x: "letter",
            y: "frequency",
            fill: "letter",
            r: 4
          })
        ]
      };

      var bls_line = {
        width: width,
        // marginTop: 10,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          paddingRight: 40,
        },
        y: {
          label: "Unemployed (thousands)",
          // nice: true,
          clamp: true,
          frameAnchor: "top-left",
        },
        x: {
          nice: false,
          clamp: true,
          grid: true,
          tickSize: 0,
        },
        marks: [
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            dx: 2, // offset right
            dy: -6, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            ticks: 4,
          }),
          Plot.areaY(bls, {
            x: "date",
            y2: "unemployed",
            z: "industry",
            fillOpacity: 0.1
          }),
          Plot.lineY(bls, {
            x: "date",
            y: "unemployed",
            z: "industry",
            strokeWidth: 1,
            tip: {
              format: {
                x: (d) => formatDate(d),
              },
              opacity: 0.85,
              textPadding: 10,
            },
          }),
          Plot.text(bls, occlusionY(Plot.selectLast({
            filter: d => d.industry !== "Agriculture",
            x: "date",
            y: "unemployed",
            z: "industry",
            text: "industry",
            textAnchor: "start",
            rotate: width > 450 ? 0 : 45,
            dx: 3,
            fontSize: width > 450 ? 12 : 8
          })))
        ]
      };

      var bls_stacked = {
        width: width,
        marginRight: 80,
        marginTop: 40,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        y: {
          grid: true,
          label: "Unemployed (thousands)",
          tickSize: 0,
          ticks: 4,
          anchor: "left",
        },
        x: {
          tickFormat: "%Y",
          tickSize: 0,
        },
        color: {
          scheme: "Set2",
          reverse: true,
          unknown: "currentColor",
        },
        marks: [
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            ticks: 4,
            dx: 2, // offset right
            dy: -4, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
          }),
          Plot.areaY(bls, Plot.stackY({
            x: "date",
            y: "unemployed",
            fill: "industry",
            tip: {
              format: {
                x: formatDate
              },
              opacity: 0.8,
              textPadding: 10,
              lineHeight: 1.5,
            },
          })),
          Plot.text(bls, occlusionY(Plot.selectLast(Plot.stackY({
            filter: d => d.industry !== "Mining and Extraction",
            x: "date",
            y: "unemployed",
            z: "industry",
            text: "industry",
            textAnchor: "start",
            fontSize: width > 450 ? 12 : 10,
            fontWeight: 700,
            dx: 3,
            fill: "industry",
            lineWidth: 8,
            rotate: width > 450 ? 0 : 30
          })))),
          Plot.ruleY([0], {
            strokeOpacity: 0.2
          })
        ]
      };

      var bls_bar = {
        width: width,
        marginRight: 0,
        paddingLeft: 40,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        x: {
          tickFormat: "%Y",
          tickSize: 0,
          tickRotate: 35,
          nice: true,
        },
        y: {
          grid: true,
          label: "↑ Unemployed (thousands)",
          // nice: true,
          tickSize: 0,
          ticks: 4,
        },
        color: {
          type: "ordinal",
          scheme: "Set2",
          reverse: true,
        },
        marks: [
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            dx: 2, // offset right
            dy: -4, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            ticks: 4,
          }),
          Plot.rectY(bls, Plot.binX({
            y: "sum"
          }, {
            x: "date",
            y: "unemployed",
            fill: "industry",
            tip: {
              format: {
                x: formatTime
              },
              opacity: 0.8,
              textPadding: 10,
              lineHeight: 1.5,
            },
          }))
        ]
      };

      var statemap = new Map(stategrid.map(d => [d.name, d]));
      var states = statepop.filter((d) => statemap.has(d.State)).map((d) => ({
        ...d,
        ...statemap.get(d.State)
      }));

      change = new function(d) {
        return d => (d["2019"] / d["2010"])
      };
      formatChange = new function(d) {
        return ((f) => (d) => f(change(d) - 1))(d3.format("+.0%"));
      };

      var gridmap = {
        width: width,
        style: {
          fontSize: size
        },
        aspectRatio: 1,
        axis: null,
        color: {
          type: "diverging-log", // diverging-log scales pivot at 1 by default
          scheme: "piyg",
        },
        marks: [
          Plot.cell(states, {
            x: "x",
            y: "y",
            fill: change
          }),
          // Plot.text(states, {x: "x", y: "y", text: "key", dy: -2}), // state abbr
          // Plot.text(states, {x: "x", y: "y", text: formatChange, dy: 10, fillOpacity: 0.6}),
          Plot.text(
            states,
            colorContrast({
              luminance: 60,
              x: "x",
              y: "y",
              text: "key", // state abbr
              dy: -6,
              fill: change,
              fontSize: width > 450 ? 14 : 10,
              fontWeight: "bold"
            })
          ),
          Plot.text(
            states,
            colorContrast({
              luminance: 60,
              x: "x",
              y: "y",
              text: formatChange,
              dy: width > 450 ? 10 : 6,
              fill: change,
              fontSize: width > 450 ? 12 : 8
            })
          ),
        ]
      };

      // https://observablehq.com/@observablehq/plot-state-population-change
      var diverging = {
        width: width,
        style: {
          fontSize: 12.5,
          paddingTop: 40
        },
        margin: 0,
        aspectRatio: 1.1,
        label: null,
        x: {
          axis: "top",
          label: "← decrease                                                              increase →",
          labelAnchor: "center",
          labelOffset: 44,
          tickFormat: "+",
          percent: true,
          tickSize: 2,
        },
        color: {
          scheme: "PiYg",
          type: "ordinal"
        },
        marks: [
          Plot.barX(statepop, {
            y: "State",
            x: (d) => (d[2019] - d[2010]) / d[2010],
            fill: (d) => Math.sign(d[2019] - d[2010]),
            sort: {
              y: "x"
            }
          }),
          Plot.gridX({
            stroke: "white",
            strokeOpacity: 0.5
          }),
          Plot.axisY({
            x: 0,
            tickSize: 0,
          }),
          Plot.ruleX([0])
        ]
      };

      // https://observablehq.com/@observablehq/plot-difference-chart
      var difference = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        marginRight: 0,
        x: {
          inset: 4,
          nice: true,
        },
        y: {
          grid: true,
          label: "Temperature (°F)",
          tickSize: 0,
          nice: true,
          anchor: "top",
          ticks: 4,
        },
        color: {
          scheme: "RdYlBu",
          label: "colder"
        },
        marks: [
          Plot.differenceY(weather, {
            x: "date",
            y1: "New York",
            y2: "San Francisco",
            curve: "step-after",
            positiveFill: () => "NY",
            negativeFill: () => "SF",
            tip: {
              format: {
                x: formatDate,
                y: "f"
              },
              lineHeight: 1.5,
              padding: 10,
              opacity: .9,
              format: {
                y: ".1f",
              }
            },
          }),
          Plot.text(
            weather,
            Plot.selectMaxY({
              x: "date",
              y: "New York",
              text: () => "New York",
              dy: -6,
            })
          ),
          Plot.text(weather, {
            ...Plot.selectMaxY({
              x: "date",
              y: "New York"
            }),
            y: "San Francisco",
            text: () => "San Francisco",
            dy: 13,
          }),
          Plot.text(
            weather,
            Plot.selectMinY({
              x: "date",
              y: "New York",
              text: () => "New York",
              textAnchor: "start",
              dy: -10,
              dx: 6,
            })
          ),
          Plot.text(weather, {
            ...Plot.selectMinY({
              x: "date",
              y: "New York",
              text: () => "San Francisco"
            }),
            y: "San Francisco",
            dy: -40,
          })
        ]
      };

      // Drug scatter plot 
      var drug_scatter = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          paddingBottom: 20,
        },
        grid: true,
        y: {
          nice: true, // Nice is a convenience function that automatically rounds to the nearest whole number
          ticks: 4,
          tickSize: 0,
          tickFormat: formatWhole,
          label: "Physical harm",
        },
        inset: 2,
        x: {
          nice: true, // Nice is a convenience function that automatically rounds to the nearest whole number
          tickSize: 0,
          anchor: "right",
          label: "Social harm",
          labelOffset: 40,
        },
        marks: [
          Plot.frame(),
          // Draw a dot for each drug in drugs
          Plot.dot(drugs, {
            x: "Mean Social harm",
            y: "Mean_Physical_harm",
            r: "Pleasure",
            fill: "Drug",
            tip: {
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            },
          }),
          // Add a text label above the dot
          Plot.text(drugs, {
            filter: d => d.Mean_Physical_harm > 2.3 || d.Mean_Physical_harm < 1.3,
            x: "Mean Social harm",
            y: "Mean_Physical_harm",
            text: d => d.Drug === "Solvents" ? "" : d.Drug,
            dy: -12
          }),
          Plot.ruleX([0], {
            strokeOpacity: 0
          }),
          Plot.ruleY([0], {
            strokeOpacity: 0
          }),
        ]
      };

      var example_histogram = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
        },
        color: {
          type: "diverging",
          scheme: "Sinebow"
        },
        x: {
          round: true,
          label: "Trade volume (log₁₀) →",
          anchor: "left",
          labelOffset: 40
        },
        y: {
          grid: true,
          tickSize: 0,
          ticks: 4,
        },
        marks: [
          Plot.rectY(aapl, Plot.binX({
            y: "count",
            fill: "median"
          }, {
            x: d => Math.log10(d.Volume),
            normalize: true,
            fill: "Volume",
            fillOpacity: .9
          })),
          Plot.ruleY([0])
        ]
      };

      // https://observablehq.com/@observablehq/plot-proportion-plot
      var proportion_data = [{
          "age": "16-34’s",
          "population": 30,
          "wealth": 3
        },
        {
          "age": "35-54’s",
          "population": 33,
          "wealth": 32
        },
        {
          "age": "55-74’s",
          "population": 28,
          "wealth": 52
        },
        {
          "age": "Over 75’s",
          "population": 9,
          "wealth": 13
        }
      ];
      const stack = (options) => Plot.stackY({}, {
        x: "type",
        y: "value",
        z: "age",
        ...options
      });
      var columns = ["population", "wealth"];
      var proportion_data_flat = proportion_data = columns.flatMap((type) => proportion_data.map((d) => ({
        age: d.age,
        type,
        value: d[type]
      })));

      var proportion_plot = {
        width: width,
        // paddingLeft: 20,
        // paddingRight: 20,
        marginRight: 0,
        marginLeft: 0,
        style: {
          fontSize: size,
        },
        x: {
          domain: columns,
          axis: "top",
          label: null,
          tickFormat: (d) => `Share of ${d}`,
          tickSize: 0,
        },
        y: {
          axis: null,
          reverse: true
        },
        color: {
          scheme: "prgn",
          reverse: true
        },
        marks: [
          Plot.areaY(
            proportion_data_flat,
            stack({
              curve: "bump-x",
              fill: "age",
              stroke: "white"
            })
          ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "population",
              text: (d) => `${d.value}%`,
              textAnchor: "end",
              dx: -6
            })
          ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "wealth",
              text: (d) => `${d.value}%`,
              textAnchor: "start",
              dx: +6
            })
          ),
          Plot.text(
            proportion_data_flat,
            stack({
              filter: (d) => d.type === "population",
              text: "age",
              textAnchor: "start",
              fill: "white",
              fontWeight: "bold",
              dx: +8
            })
          )
        ]
      };

      var stem_plot = {
        width: width > 450 ? width / 2 : width,
        style: {
          fontSize: width > 450 ? size : size + 2,
          margin: "auto",
          paddingLeft: 20,
          paddingRight: 20
        },
        axis: null,
        y: {
          domain: d3.range(4, 25).map(String)
        },
        color: {
          domain: "NLB",
          range: ["currentColor", "peru", "brown"],
          legend: true,
        },
        marks: [
          Plot.text([
            [1, "4"]
          ], {
            text: ["Northbound"],
            textAnchor: "start"
          }),
          Plot.text([
            [-1, "4"]
          ], {
            text: ["Southbound"],
            textAnchor: "end"
          }),
          Plot.text(new Set(caltrain.map(d => d.hours)), {
            x: 0,
            y: d => d,
            text: d => `${(d - 1) % 12 + 1}${(d % 24) >= 12 ? "p": "a"}`
          }),
          Plot.text(caltrain, Plot.stackX2({
            filter: d => d.orientation === "N",
            x: 1,
            y: "hours",
            text: d => d.minutes.padStart(2, "0"),
            title: d => `${d.time} on line ${d.line}`,
            fill: "type",
            textAnchor: "start",
            tip: true,
          })),
          Plot.text(caltrain, Plot.stackX2({
            filter: d => d.orientation === "S",
            x: -1,
            y: "hours",
            text: d => d.minutes.padStart(2, "0"),
            title: d => `${d.time} on line ${d.line}`,
            tip: true,
            fill: "type",
            textAnchor: "end"
          })),
          Plot.ruleX([-0.5, 0.5])
        ]
      };

      var shockwave = {
        width: width,
        style: {
          fontSize: size,
          margin: "auto",
          paddingLeft: 20,
          paddingRight: 20
        },
        projection: {
          type: "equal-earth",
          rotate: [90, 0]
        },
        color: {
          legend: true,
          label: "Distance from Tonga (km)",
          transform: (d) => 111.2 * d, // degrees to km
          zero: true
        },
        marks: [
          Plot.geo(land),
          Plot.geo([0.5, 179.5].concat(d3.range(10, 171, 10)), {
            geometry: d3.geoCircle().center([-175.38, -20.57]).radius((r) => r),
            stroke: (r) => r,
            strokeWidth: 2
          }),
          Plot.sphere()
        ]
      };

      var streamgraph = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          paddingRight: 85,
        },
        x: {
          tickSize: 0,
          grid: true,
          tickFormat: "%Y",
        },
        y: {
          grid: true,
          label: "Unemployed (thousands)",
          ticks: 4,
          tickSize: 0,
          nice: true,
          clamp: true,
        },
        marks: [
          Plot.areaY(bls, Plot.stackY({
            x: "date",
            y: "unemployed",
            fill: "industry",
            tip: {
              format: {
                x: formatDate
              },
              lineHeight: 1.5,
              padding: 10,
              opacity: .9,
            },
            offset: "wiggle"
          })),
          Plot.text(bls, occlusionY(Plot.selectLast(Plot.stackY({
            x: "date",
            y: "unemployed",
            z: "industry",
            lineWidth: 12,
            text: "industry",
            offset: "wiggle",
            textAnchor: "start",
            rotate: width > 450 ? 0 : 30,
            dx: 5,
            fill: "industry"
          })))),
        ]
      };

      var qatar_pyramid = {
        width: width,
        aspectRatio: .045,
        marginRight: 0,
        style: {
          fontSize: size,
          maxHeight: 840,
          paddingBottom: 10
        },
        color: {
          domain: ["male", "female"],
          range: ["steelblue", "#EE7989"]
        },
        x: {
          tickFormat: d => d3.format("~s")(Math.abs(d)),
          label: "← male             female →    (000s)",
          nice: true,
          round: true,
          axis: "bottom",
          labelOffset: 42,
        },
        y: {
          domain: d3.groupSort(qatar, v => parseInt(v[0].age), d => d.age),
          reverse: true,
          label: "Age",
          labelOffset: 30,
          labelAnchor: "Top",
          tickSize: 0,
        },
        marks: [
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            fill: d => d.sex === "male" ? "male" : "female",
            tip: true,
          }),
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            fill: "sex",
            stroke: "white",
            strokeWidth: 3.5,
          }),
          Plot.barX(qatar, {
            x: d => d["population"] * (1 - 2 * (d["sex"] === "male")),
            y: "age",
            stroke: "black"
          })
        ],
      };

      // https://observablehq.com/@observablehq/plot-marimekko
      function marimekko({
        x,
        y,
        z,
        value = z,
        anchor = "middle",
        inset = 0.5,
        ...options
      } = {}) {
        const stackX = /\bleft$/i.test(anchor) ? Plot.stackX1 : /\bright$/i.test(anchor) ? Plot.stackX2 : Plot.stackX;
        const stackY = /^top\b/i.test(anchor) ? Plot.stackY2 : /^bottom\b/i.test(anchor) ? Plot.stackY1 : Plot.stackY;
        const [Xv, setXv] = Plot.column(value);
        const {
          x: X,
          x1,
          x2,
          transform: tx
        } = stackX({
          offset: "expand",
          y,
          x: Xv
        });
        const {
          y: Y,
          y1,
          y2,
          transform: ty
        } = stackY({
          offset: "expand",
          x,
          y: value
        });
        return Plot.transform({
          x: X,
          x1,
          x2,
          y: Y,
          y1,
          y2,
          z,
          inset,
          frameAnchor: anchor,
          ...options
        }, (data, facets) => {
          const I = d3.range(data.length);
          const X = Plot.valueof(data, x);
          const Z = Plot.valueof(data, value);
          const sum = d3.rollup(I, I => d3.sum(I, i => Z[i]), i => X[i]);
          setXv(I.map(i => sum.get(X[i])));
          tx(data, facets);
          ty(data, facets);
          return {
            data,
            facets
          };
        });
      };

      const xy = (options) => marimekko({
        ...options,
        x: "market",
        y: "segment",
        value: "value"
      });

      var mosaic = {
        width: width,
        style: {
          fontSize: size,
        },
        height: 640,
        label: null,
        x: {
          percent: true,
          ticks: 4,
          tickSize: 2,
          tickFormat: (d) => d === 100 ? `100%` : d
        },
        y: {
          percent: true,
          ticks: 4,
          tickSize: 2,
          tickFormat: (d) => d === 100 ? `100%` : d
        },
        marks: [
          Plot.frame({
            stroke: "#DFDFDF"
          }),
          Plot.rect(sales, xy({
            fill: "segment",
            fillOpacity: 0.5,
            tip: true,
          })),
          Plot.text(sales, xy({
            text: d => [d.value.toLocaleString("en"), d.segment, d.market].join("\n"),
            fontSize: width > 450 ? 12 : 10,
            rotate: d => d.value > 1000 || d.market == "Auburn, AL" || d.market == "Birmingham, AL" ? 0 : 90
          })),
          Plot.text(sales, Plot.selectMaxX(xy({
            z: "segment",
            text: "segment",
            anchor: "right",
            textAnchor: "middle",
            lineAnchor: "bottom",
            rotate: 90,
            dx: 6,
            size: 6,
          }))),
          Plot.text(sales, Plot.selectMaxY(xy({
            z: "market",
            text: "market",
            anchor: "top",
            lineAnchor: "bottom",
            dy: -6,
            size: 6,
          })))
        ]
      };

      var mpg = {
        width: width,
        style: {
          textTransform: "capitalize",
          fontSize: size,
        },
        marginRight: 0,
        x: {
          label: "City mpg",
          ticks: 2,
          labelOffset: 50
        },
        y: {
          label: "Highway mpg",
          ticks: 4,
          labelOffset: 50,
          labelAnchor: "center"
        },
        inset: 4,
        grid: true,
        facet: {
          data: mpg,
          x: "class",
          label: null,
        },
        marks: [
          Plot.dot(mpg, {
            x: "cty",
            y: "hwy",
            fill: "manufacturer",
            stroke: "manufacturer",
            strokeWidth: 1,
            channels: {
              manufacturer: "manufacturer",
              model: "model",
              Class: "class",
            },
            tip: {
              format: {
                manufacturer: true,
                cty: true,
                fx: false,
                stroke: true,
              },
              opacity: 0.9,
              textPadding: 10,
              lineHeight: 1.5,
            }
          }),
          [Plot.frame()]
        ]
      };

      var numbers = Float64Array.from({
        length: 10000
      }, d3.randomNormal.source(d3.randomLcg(3))());

      function percentiles(numbers) {
        const sorted = d3.sort(numbers);
        return d3.range(0, 101).map((q) => d3.quantileSorted(sorted, q / 100));
      }

      // https://observablehq.com/@observablehq/plot-percentogram
      var percentogram = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
          textTransform: "capitalize",
        },
        color: {
          legend: true,
          type: "quantize",
          scheme: "spectral",
          n: 10,
          label: "Percentile",
          style: {
            fontSize: size
          },
        },
        y: {
          label: "density",
          ticks: 4,
        },
        marks: [
          Plot.rectY(numbers, {
            fill: (d, i) => i,
            tip: {
              lineHeight: 1.5,
              padding: 10,
              opacity: .9,
            },
            ...Plot.binX({
              y: (bin, {
                x1,
                x2
              }) => 1 / (x2 - x1),
              thresholds: percentiles
            })
          }),
          Plot.ruleY([0])
        ]
      };

      // From Fil: https://observablehq.com/@fil/waffle-chart
      var waffle = { // Todo replace with waffle mark 
        width: width,
        height: 160,
        marginLeft: 0,
        marginRight: 0,
        x: {
          axis: null
        },
        y: {
          axis: null
        },
        color: {
          scheme: "Pastel2"
        },
        marks: [
          Plot.cell(
            units,
            Plot.stackX({
              y: (_, i) => i % 5,
              fill: "label",
              title: "group"
            })
          ),
          Plot.text(
            units,
            Plot.stackX({
              y: (_, i) => i % 5,
              text: "label",
              fontSize: width > 450 ? 10 : 7
            })
          )
        ],
      };

      function renko(data, {
        x = "date",
        y = "value",
        brick_size = 10.0
      } = {}) {
        const dates = Plot.valueof(data, x);
        const values = Plot.valueof(data, y);
        const B = brick_size;
        const bricks = [];
        let i = 0;
        let rank = 0;
        const v = values[i];
        let brick = {
          rank,
          start: i,
          x1: dates[i],
          v1: v,
          v: (0.5 + Math.floor(v / B)) * B,
          floor: Math.floor(v / B) * B,
          ceil: (1 + Math.floor(v / B)) * B
        };
        let j = i;
        for (; i < values.length; ++i) {
          const v = values[i];
          if (Math.abs(v - brick.v) < 0.5 * B) {
            j = i;
          }
          while (Math.abs(v - brick.v) >= 1.5 * B) {
            brick.v2 = values[j];
            brick.x2 = dates[j];
            brick.end = j;
            const direction = Math.sign(v - brick.v);
            if (rank === 0) brick.direction = direction;
            bricks.push(brick);

            brick = {
              rank: ++rank,
              direction,
              start: j,
              x1: dates[j],
              v1: values[j],
              v: brick.v + direction * B,
              floor: brick.floor + direction * B,
              ceil: brick.ceil + direction * B
            };
            j = i;
          }
        }
        brick.end = i - 1;
        brick.x2 = dates[i - 1];
        brick.v2 = values[i - 1];
        bricks.push(brick);

        return bricks;
      } // From Liangwei: https://observablehq.com/d/e77c63439fb36146
      var brick_size = 5;
      var renko_data = renko(aapl, {
        x: "Date",
        y: "Close",
        brick_size
      });
      var renko_months = d3.utcMonths(...d3.extent(renko_data, (d) => d.x1));
      var renko_position = d3.scaleLinear(
        renko_data.map((d) => +d.x1).concat([+renko_data[renko_data.length - 1].x2]),
        d3.range(renko_data.length + 1)
      );
      var renko_years = d3.utcYears(...d3.extent(renko_data, (d) => d.x1));

      var renko = {
        width: width,
        height: 350,
        marginRight: 0,
        color: {
          domain: [1, -1],
          range: ["white", "black"]
        },
        x: {
          label: "time →",
          ticks: 10,
          tickFormat: (rank) =>
            renko_data[rank] ? d3.timeFormat("%d %b")(renko_data[rank].x1) : ""
        },
        y: {
          grid: true
        },
        marks: [
          Plot.ruleY([d3.min(renko_data, (d) => d.v) - 2 * brick_size]),
          Plot.ruleX(renko_months, {
            strokeWidth: 0.06,
            x: renko_position
          }),
          Plot.ruleX(renko_years, {
            strokeWidth: 0.5,
            x: renko_position
          }),
          Plot.textX(renko_years, {
            strokeWidth: 0.5,
            x: renko_position,
            text: (d) => `${d.getFullYear()}`,
            textAnchor: "start",
            dx: 3,
            dy: -155
          }),
          Plot.rect(renko_data, {
            x1: (d) => d.rank,
            x2: (d) => d.rank + 1,
            y1: "floor",
            y2: "ceil",
            fill: "direction",
            stroke: "black"
          }),
          //   showDots
          //     ? Plot.dot(aapl, {
          //         x: (d) => position(d.Date),
          //         y: "Close",
          //         fill: "red",
          //         r: 1
          //       })
          //     : []
        ],
      };
      var renko_comparison = {
        width: width,
        height: 350,
        marginRight: 0,
        color: {
          domain: [1, -1],
          range: ["white", "black"]
        },
        x: {
          label: "time →",
          ticks: []
        },
        y: {
          grid: true
        },
        marks: [
          Plot.ruleY([d3.min(renko_data, (d) => d.v) - 2 * brick_size]),
          Plot.ruleX(renko_months, {
            strokeWidth: 0.06,
            x: (d) => d
          }),
          Plot.ruleX(renko_years, {
            strokeWidth: 0.5,
            x: (d) => d
          }),
          Plot.textX(renko_years, {
            strokeWidth: 0.5,
            x: (d) => d,
            text: (d) => `${d.getFullYear()}`,
            textAnchor: "start",
            dx: 3,
            dy: -155
          }),
          Plot.rect(renko_data, {
            x1: "x1",
            x2: "x2",
            y1: "floor",
            y2: "ceil",
            fill: "direction",
            stroke: "black"
          }),
          // showDots
          //   ? Plot.dot(aapl, {
          //       x: (d) => d.Date,
          //       y: "Close",
          //       fill: "red",
          //       r: 1
          //     })
          //   : []
        ],
      };

      var irregular = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: size,
        },
        x: {
          label: "Commute time (minutes) →",
          ticks: 20,
          labelOffset: 50,
        },
        y: {
          label: "↑ People (per 5 minute interval)",
          transform: (n) => n * 5 /* 5-minute intervals */ * 1000 /* data is in thousands */ ,
          tickFormat: "~s",
          grid: true,
          tickSize: 0,
          ticks: 4,
        },
        marks: [
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            ticks: 4,
            dx: 2, // offset right
            dy: -6, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            labelOffset: 20,
            tickFormat: "~s",
          }),
          Plot.rectY(commute, {
            x1: "lo",
            x2: "hi",
            y: (d) => d.people / (d.hi - d.lo),
            fill: "rgba(204,204,204,.8)",
            insetRight: 1,
            tip: true,
            title: (d) =>
              `${new Intl.NumberFormat("en-US").format(
              d.people / 1000
              )} million people\nspend ${d.lo} to ${
              d.hi
            } minutes\ncommuting to work.`
          }),
          Plot.text(commute, {
            filter: "annotation",
            text: "annotation",
            fontSize: size,
            x: "hi",
            y: (d) => d.people / (d.hi - d.lo),
            dx: 2,
            dy: 2,
            textAnchor: "start"
          }),
          Plot.ruleY([0])
        ]
      };

      one_adjust = (d) => (d.one / d.population) * 1.083863014;
      full_adjust = (d) => (d.full / d.population) * 1.076538114;
      percent = d3.format(".1%");

      var irregular_bar = {
        width: width,
        marginRight: 0,
        style: {
          fontSize: ".8rem",
        },
        x: {
          label: "Population (millions) →",
          transform: (d) => d * 1e-6,
          anchor: "bottom-right",
          labelOffset: 40,
          ticks: 6,
        },
        y: {
          label: "↑ Share of vaccinated people per age group",
          tickFormat: "%",
          anchor: "left",
          ticks: 3,
        },
        color: {
          domain: ["all", "one", "full"],
          range: ["#ddd", "lightblue", "steelblue"]
        },
        marks: [
          // gray bars, all of the same height (total population by age group)
          Plot.rectY(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: 1,
            fill: () => "all",
            insetLeft: 0.5,
            insetRight: 0.5,
          }),

          // light blue bars (one dose, at least, by age group)
          Plot.rectY(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: one_adjust,
            fill: () => "one",
            insetLeft: 0.5,
            insetRight: 0.5,
          }),

          //  blue bars (fully vaccinated population, by age group)
          Plot.rectY(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: full_adjust,
            fill: () => "full",
            insetLeft: 0.5,
            insetRight: 0.5,
          }),

          // age group label
          Plot.text(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: 1,
            fill: "black",
            text: "Age group",
            dy: 11,
            fontSize: width > 450 ? 13 : 10,
          }),

          // age group size
          Plot.text(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: 1,
            fill: "black",
            text: (d) => `${+(d.population * 1e-6).toFixed(1)}M`,
            dy: 23,
            fontSize: width > 450 ? 11 : 9,
          }),

          // percentage labels for "one", below
          Plot.text(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: (d) => (one_adjust(d) > 0.05 ? one_adjust(d) : null),
            fill: "black",
            fontWeight: "bold",
            text: (d) => percent(one_adjust(d)),
            fontSize: width > 450 ? 10 : 8,
            dy: 11,
          }),

          // percentage labels for "one", above (age class "<18")
          Plot.text(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: (d) => (one_adjust(d) <= 0.05 ? one_adjust(d) : null),
            fill: "black",
            fontWeight: "bold",
            text: (d) => percent(one_adjust(d)),
            fontSize: width > 450 ? 10 : 8,
            dy: -5,
          }),

          // percentage labels for "full", below
          Plot.text(vaxdata, {
            ...Plot.stackX({
              x: "population"
            }),
            y: (d) => (full_adjust(d) > 0.05 ? full_adjust(d) : null),
            fill: "white",
            fontWeight: "bold",
            text: (d) => percent(full_adjust(d)),
            fontSize: width > 450 ? 11 : 8,
            dy: 11,
          }),
          Plot.frame()
        ],
      };

      // Draw the plots (data fetched)
      document.getElementById("popcorn").appendChild(Plot.plot(popcorn));
      document.getElementById("anomaly_barcode").appendChild(Plot.plot(anomaly_barcode));
      document.getElementById("anomaly_dot").appendChild(Plot.plot(anomaly_dot));
      document.getElementById("apple_area").appendChild(Plot.plot(apple_area));
      document.getElementById("beeswarm").appendChild(Plot.plot(beeswarm));
      document.getElementById("bls_bar").appendChild(Plot.plot(bls_bar));
      document.getElementById("bls_line").appendChild(Plot.plot(bls_line));
      document.getElementById("bls_stacked").appendChild(Plot.plot(bls_stacked));
      document.getElementById("bullet").appendChild(Plot.plot(bullet));
      document.getElementById("candlestick").appendChild(Plot.plot(candlestick));
      document.getElementById("dotdensity").appendChild(Plot.plot(dotdensity));
      document.getElementById("dotmap").appendChild(Plot.plot(dotmap));
      document.getElementById("driving_line").appendChild(Plot.plot(driving_line));
      document.getElementById("drug_scatter").appendChild(Plot.plot(drug_scatter));
      document.getElementById("electricity").appendChild(Plot.plot(electricity));
      document.getElementById("example_histogram").appendChild(Plot.plot(example_histogram));
      document.getElementById("freq_letters").appendChild(Plot.plot(freq_letters));
      document.getElementById("gapminder").appendChild(Plot.plot(gapminder));
      document.getElementById("gridmap").appendChild(Plot.plot(gridmap));
      document.getElementById("google_ridgeline").appendChild(Plot.plot(google_ridgeline));
      document.getElementById("irregular").appendChild(Plot.plot(irregular));
      document.getElementById("morley").appendChild(Plot.plot(morley));
      document.getElementById("mosaic").appendChild(Plot.plot(mosaic));
      document.getElementById("mpg").appendChild(Plot.plot(mpg));
      document.getElementById("percentogram").appendChild(Plot.plot(percentogram));
      document.getElementById("proportion_plot").appendChild(Plot.plot(proportion_plot));
      document.getElementById("qatar_pyramid").appendChild(Plot.plot(qatar_pyramid));
      document.getElementById("stem_plot").appendChild(Plot.plot(stem_plot));
      document.getElementById("stocks_baseline").appendChild(Plot.plot(stocks_baseline));
      document.getElementById("streamgraph").appendChild(Plot.plot(streamgraph));
      document.getElementById("waffle").appendChild(Plot.plot(waffle));
      document.getElementById("horizon_chart").appendChild(Plot.plot(horizon_chart));
      document.getElementById("diverging").appendChild(Plot.plot(diverging));
      document.getElementById("difference").appendChild(Plot.plot(difference));
      document.getElementById("slope").appendChild(Plot.plot(slope));
      document.getElementById("intslope").appendChild(Plot.plot(intslope));
      document.getElementById("irregular_bar").appendChild(Plot.plot(irregular_bar));
      document.getElementById("example_line").appendChild(Plot.plot(example_line));
      document.getElementById("lollipop").appendChild(Plot.plot(lollipop));
      document.getElementById("shockwave").appendChild(Plot.plot(shockwave));
      document.getElementById("renko").appendChild(Plot.plot(renko));
      document.getElementById("renko_comparison").appendChild(Plot.plot(renko_comparison));
      // document.getElementById("spikeMap").appendChild(Plot.plot(spikeMap));
    });

    myDataPromises.catch(function() {
      console.log('🚨 Oops - Something has gone wrong fetching data.')
    });
  </script>
</body>

</html>