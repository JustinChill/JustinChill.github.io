<!DOCTYPE html>
<html lang="en">
<head>
  <title>8 minutes, 46 seconds</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A short time can feel like an eternity">
  <meta name="author" content="Justin Chill">

  <style type="text/css">

  .timer {
    font-size: 6.250rem;
    font-weight: bold;
    font-variant-numeric: tabular-nums;
    text-align: center;
  }
  button {
    font-size: 20px;
  }
  .hide {
    opacity: 0;
  }
  .wrapper {
    margin-top: 100px;
    /*grid-column: 4;*/
    padding: 0;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-content: center;
  }
  @media (max-width: 600px) {
    .wrapper {
      margin-top: 20px;
    }
  }
  .intro,
  button {
    transition: opacity 2s;
  }
  #transcript, .intro {
    padding-top: 2rem;
  }
  #transcript {
    transition: opacity 3s;
    font-family: serif;
    font-size: 24px;
    font-style: italic;
  }
  .transcript-hide {
    opacity: 0;
  }
  .transcript-show {
    opacity: 1;
  }

  html,
  article{
    background: #000;
  }
  a.nav__item,
  article > p,
  .timer,
  #transcript
  #transcript a{
    color:  #fff;
  }

  @media screen and (min-width: 900px){
    article{ 
      /* Absolutely position content only when large enough to do so properly */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  }

</style>
</head>
<body>
  <nav class="nav">
    <div class="nav__list">
      <a href="index.html" class="nav__item">Home</a>
      <a href="blog.html" class="nav__item">Blog</a>
      <a href="fun.html" class="nav__item">Fun</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>
  
  <main role="main">
    <article>
    <div class="wrapper">
      <div class="timer" id="timer">8:46</div>
      <button id="start" onclick="start()">Start Timer</button>
      <div id="transcript" class="transcript-hide"></div>
    </div>
    <p class="intro" id="intro">On May 25th 2020, Derek Chauvin held his knee on the neck of George Floyd for 8 minutes and 46 seconds, resulting in Mr. Floyd's death. I invite you to sit quietly and reflect for this same length of time. It feels like an eternity. If you feel discomfort, and want to leave the website prior to the timer finishing, reflect on that feeling.</p>
    </article>

</main>
<!-- <footer>
  <h2 id="footnote-label">Footnotes</h2>
  <div>
    <p>Justin Chill Â© 2021. </p>
    <p><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" class="gh">Source code and feedback</a></p>    
  </div>
</footer> -->


<script type="text/javascript">
  function start() {
    var startButton = document.getElementById('start');
    var intro = document.getElementById('intro');

    if (startButton.classList.contains('hide')) {
      return // end function if button already pressed
    }

    startButton.classList = 'hide';
    intro.classList.add('hide');

    var eight_minutes_from_now = new Date().getTime() + 527000; //The getTime() method returns the number of milliseconds since the Unix Epoch, so 8.78 minutes is 527000 
    var interval = setInterval(function() {

      var now = new Date().getTime();
      var time_remaining = eight_minutes_from_now - now;
      var minutes = Math.floor((time_remaining % (3600000)) / (60000));
      var seconds = Math.floor((time_remaining % (60000)) / 1000);
      var glue = (seconds > 9) ? ':' : ':0'; // ternary operator to format time when less than 10s remain

      var transcript_item = getTranscriptItem(time_remaining);
      if (transcript_item) {
        fadeInText(transcript_item);
      }

      document.getElementById("timer").innerHTML = minutes + glue + seconds;

      // Final message
      if (time_remaining < 0) {
        clearInterval(interval);
        document.getElementById("timer").innerHTML = "0:00";
        setTimeout(function(){
          var transcript = document.getElementById('transcript');
          transcript.innerHTML = 
          'Justice for George. <br> Sources: <a target="_blank" href="https://www.youtube.com/watch?v=FMGUAHBFmjk">YouTube</a>, <a target="_blank" href="https://www.youtube.com/watch?v=lirHz93qJ50">YouTube</a>, <a target="_blank" href="https://en.wikipedia.org/wiki/Death_of_George_Floyd">Wikipedia</a> <br> Recreation of <a target="_blank" href="https://8m46s.com">this</a> powerful website';
          transcript.classList = 'transcript-show';
        }, 10000);
      }
    }, 200);
  }
  function fadeInText(t) {
    var transcript = document.getElementById('transcript');
    transcript.innerHTML = t;
    transcript.classList = 'transcript-show';
    setTimeout(function(){
      var transcript = document.getElementById('transcript');
      transcript.classList = 'transcript-hide';
    }, 7000)
  }
  function getTranscriptItem(current_time) {
    var fullTranscript = {
      520000: "&ldquo;Please, please, please! I can't breathe!&rdquo;",
      495000: "&ldquo;Please man.&rdquo;",
      485000: "&ldquo;I can't breathe.&rdquo;",
      475000: "&ldquo;I'm about to die.&rdquo;",
      465000: "&ldquo;I can't breathe. I can't breathe.&rdquo;",
      455000: "(Still kneeling) &ldquo;Get in the car!&rdquo; &ldquo;I will!&rdquo;",
      445000: "(Still kneeling) &ldquo;Get up, get in the car!&rdquo; &ldquo;I can't move.&rdquo;",
      435000: "(Still kneeling) &ldquo;Get up, and get in the car!&rdquo; &ldquo;Mama! Mama!&rdquo;",
      407000: "An ambulance is called.",
      380000: "&ldquo;Everything hurts. Some water or something, please.&rdquo;",
      350000: "&ldquo;I can't breathe officer.&rdquo; &ldquo;Shut up.&rdquo; &ldquo;They gonna kill me.&rdquo;",
      227000: "&ldquo;He's not responsive right now!&rdquo; -bystander",
      173000: "After 5 minutes and 50 seconds, George Floyd becomes unresponsive.",
      107000: "&ldquo;He's not fucking moving!&rdquo; -bystander",
      1: "After 8 minutes and 46 seconds, Derek Chauvin removed his knee from George Floyd's neck. Mr. Floyd was later pronounced dead."
    };
    for (var timestamp in fullTranscript) {
      if (isInTimeWindow(timestamp)) {
        return fullTranscript[timestamp];
      }
    }
    function isInTimeWindow(timestamp) {
      var t = parseInt(timestamp);
      if (current_time >= t - 100 && current_time <= t + 100) {
        return true;
      }
      return false;
    }
  }
</script>
</body>
</html>