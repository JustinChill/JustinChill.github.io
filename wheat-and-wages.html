<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <title>Wheat and Wages | Justin Chill</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Recreating William Playfair's Wheat and Wages for the web.">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="keywords" content="wheat, wages, chart, graph">
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="article" property="og:type">
  <meta content="https://justinchill.com/wheat-and-wages.html" property="og:url">
  <meta content="Wheat and Wages | Justin Chill" property="og:title">
  <meta content="Recreating William Playfair's Wheat and Wages for the web." property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">

  <meta property="og:locality" content="NY">
  <meta property="og:region" content="NY">
  <meta property="og:country_name" content="USA">

  <meta name="datePublished" content="2025-03-06">
  <meta name="dateModified" content="2025-08-06">
  
  <meta content="" property="og:image">
  <meta content="" property="twitter:image">
  <meta content="" property="og:image:alt">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Wheat and Wages | Justin Chill">
  <meta name="twitter:description" content="Recreating William Playfair's Wheat and Wages for the web.">

  <link href="https://fonts.googleapis.com/css2?family=Old+Standard+TT:ital,wght@0,700;1,400&family=Pinyon+Script&family=Fredericka+the+Great&display=swap" rel="stylesheet">
  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="preload" href="style.css" as="style" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <style type="text/css">

  </style>
</head>

<body>
  <nav class="nav" role="navigation">
    <div class="nav__list">
      <a href="index.html" class="nav__item" aria-label="Homepage">Home</a>
      <a href="blog.html" class="nav__item" aria-label="Blog section">Blog</a>
      <a href="now.html" class="nav__item" aria-label="Now page">Now</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <img src="imgs/wheatAndWagesOrig.jpg" loading="lazy" class="mid-size" alt="Chart shewing at one view the price of the quarter of wheat, & wages of labour by the week, from the year 1565 to 1821">
      <div class="article-hero mid-size">
        <h2 class="article-category">Post</h2>
        <h1 class="article-title">Wheat & Wages</h1>
        <h2 class="article-subtitle">A recreation of William Playfair’s classic chart</h2>
      </div>

      <p>Born in Scotland in 1759, William Playfair may be the most famous person you have never heard of. Credited with inventing the bar chart, the pie chart, the line chart, and the area chart, he popularized “statistical graphics”. Playfair was also a pioneer in strategic analysis, and a secret agent who carried out espionage and subversion against France on behalf of Great Britain<a href="#gmu" aria-describedby="footnote-label" id="gmu-ref"></a>.</p>

      <h2>Recreating a classic</h2>
      <p>In 1822 Playfair published <i>Wheat and Wages</i>, showing "the price of the quarter of wheat and wages of labour by the week". This early <strong>combination chart</strong> includes a bar chart and line chart as well as a timeline of Monarchs reigning over the same time period.</p>
      <p>To start with, let's simply show the data: a bar chart of wheat prices and an area chart of wage growth.</p>
      <h3>Step 1: Adding data</h3>
      <figure id="step1"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <p>This immediately reveals that the wage data stop in 1810 but the wheat data appear to stop in 1820. This misalignment in the two datasets also appears in the original graphic. </p>
      <p>The original graphic also reveals that the last wheat value is only for the period 1820-1821 and not the 5 year period of the other bars (the chart was published in 1822). Changing the axis for the line chart corrects the line from sloping at the end.</p>
      <figure id="step2"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <h3>Step 2: Styling </h3>
      <p>To mimic the style of the original, we need to fade the black bar colors downward. Setting fill gradients can be achieved with some SVG styling.</p>
      <figure id="step3"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <p>Make the line red.</p>
      <figure id="step4"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <h2>Step 3: Customizing the axes & grid</h2>
      <p>The original chart uses what are, by modern standards, a set of rather idiosyncratic styles – a repeated vertical axis on the left and right with different labelling; alternating use of only the last significant digit for numbers on the left vertical axis; double labelling of the horizontal axis and a mixture of rotated and unrotated labels on the right vertical axis. We also see some quite dominating grid lines in the main chart area.</p>
      <figure id="step5"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <p>With a single horizontal axis, we can customise the x-channel so that the full year is displayed every 50 years and we have a double label by centring it with some spaces between the two blocks of text.</p>
      <figure id="step6"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <p>Create the grid...</p>
      <figure id="step7"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <h3>Step 4: Labeling</h3>
      <p>The main title is enclosed in an elliptical panel in the chart space. Plot doesn't have an ellipse mark so we can instead create a custom mark to draw ellipse. Marks in Plot are just functions that produce SVG, so to create a custom mark we simply have to specify our own function (and helpfully SVG has a simple <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/ellipse">ellipse command</a>).</p>
      <p>SVG requires pixel coordinates to position marks, but we have been specifying locations in 'data space' (i.e. horizontal position determined by dates and vertical position determined by price). Usefully, custom marks can capture the x- and y- <a href="https://observablehq.com/plot/features/scales">scales</a> used to convert from data space to screen space, so we can express the dimensions of the SVG ellipse with data values making positioning much more robust should we need to change chart dimensions.</p>
      <figure id="step8"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <h3>Typography</h3>
      <p>An obvious and jarring difference between the original and new versions of the chart is the use of type. We can customise fonts to use antique styles that more closely match the original. Sticking to publicly available fonts served on the web keeps distribution simple, but does require some compromise when matching the originals.</p>
      <ul>
        <li><span style="font-family: 'Pinyon Script'; font-size:18pt;">An italic script for most axis labels and annotations.<span></span></span></li>
        <li><span style="font-family: 'Old Standard TT'; font-size:18pt;">A serif font for century labels and some of the title.<span></span></span></li>
        <li><span style="font-family: 'Fredericka The Great'; font-size:14pt; text-transform: uppercase;">A display font for selected parts of the title.<span></span></span></li>
      </ul>
      <figure id="step9"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>

      <h3>The Monarchs</h3>
      <p>Along the top of the chart are some alternating bars indicating the reigns of the monarchs (and Cromwell) over the period of the chart. The data recording their names and reigns can be stated explicitly as below. The vertical position (in data space) of the bars can be calculated programmatically by determining whether the monarch is in an odd or even position in the list. The only exception being Cromwell's commonwealth, so we deal with that explicitly in the positioning rules. The horizontal positioning of each bar is referenced by its centre, which will make labelling a little easier.</p>
      <figure id="monarchs"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
      <h3>Century Markers</h3>
      <p>The very top of the original chart shows a series of curved braces marking each century. Because they have variable extents, it is probably simplest to create a small dataset containing vertices that trace the shape. We can keep this simple as we can interpolate along curved lines to generate the more gentle shapes required.</p>
      <figure id="century"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>

      <h3>Finishing touches</h3>
      <figure id="step10"></figure>
      <figcaption>Data: <a href="https://vega.github.io/vega/examples/wheat-and-wages/">William Playfair</a>, 1822</figcaption>
    </article>
  </main>
  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <li id="gmu"><a href="https://publishing.gmu.edu/tag/william-playfair/">Bruce Berkowitz</a>, <i>Playfair: The True Story of the British Secret Agent Who Changed How We See the World</i><a href="#gmu-ref" aria-label="Back to content">↩</a></li>
    </ol>

    <div>
      <p>Justin Chill &copy; 2025</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" alt="GitHub logo" class="icon">Source code</a></span>
    </div>
  </footer>

  <svg height="10" width="10" xmlns="http://www.w3.org/2000/svg" version="1.1">
    <defs>
      <linearGradient id="gradient1" gradientUnits="objectBoundingBox" gradientTransform="rotate(90)">
        <stop offset="25%" stop-color="rgb(0,0,0)" />
        <stop offset="50%" stop-color="white" />
      </linearGradient>
      <linearGradient id="vFade" gradientUnits="objectBoundingBox" gradientTransform="rotate(90)">
        <stop offset="30%" stop-color="rgb(0,0,0)" />
        <stop offset="45%" stop-color="rgb(250,244,230)" />
      </linearGradient>
    </defs>
  </svg>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>

  <script type="text/javascript">
    var elementMid = d3.select('figure.mid-size').node();
    var widthMid = elementMid.getBoundingClientRect().width; // get width of figure.mid-size so graphic is responsive
    var element = d3.select('figure:not(.mid-size)').node();
    var width = element.getBoundingClientRect().width;
    var size = 12;
    var bgClr = "rgb(250,244,230)";
    var fnt = ({
      script: "Pinyon Script",
      serif: "Old Standard TT",
      display: "Fredericka The Great"
    });

    // Use Promises to async request data
    var promises = [d3.json("https://cdn.jsdelivr.net/npm/vega-datasets@2/data/wheat.json")];

    // You can request multiple srcs in a promise
    myDataPromises = Promise.all(promises);

    // After data is successfully fetched, generate viz
    myDataPromises.then(function(data) {
      // Define the data. There's gotta be a better way to do this:    
      var data = data[0].map((d) => ({
        year: +d.year,
        wheat: +d.wheat,
        wages: +d.wages,
      }));

      var monarchData = [{
          name: "Elizabeth",
          start: 1565,
          end: 1603
        },
        {
          name: "James I",
          start: 1603,
          end: 1625
        },
        {
          name: "Charles I",
          start: 1625,
          end: 1649
        },
        {
          name: "Cromwell",
          start: 1649,
          end: 1660,
          commonwealth: true
        },
        {
          name: "Charles II",
          start: 1660,
          end: 1685
        },
        {
          name: "James II",
          start: 1685,
          end: 1689
        },
        {
          name: "William\nand\nMary",
          start: 1689,
          end: 1702
        },
        {
          name: "Anne",
          start: 1702,
          end: 1714
        },
        {
          name: "George I",
          start: 1714,
          end: 1727
        },
        {
          name: "George II",
          start: 1727,
          end: 1760
        },
        {
          name: "George III",
          start: 1760,
          end: 1820
        },
        {
          name: "George IV",
          start: 1811,
          end: 1821
        },
        {
          name: "",
          start: 1821,
          end: 1830,
          future: true
        }
      ].map((d, i) => ({
        ...d,
        x: d.start + (d.end - d.start) / 2,
        y: (d.future || (!d.commonwealth && i % 2) ? -1 : 1) + 96
      }));

      var step1 = {
        // className: "custom-plot", // see stylesheet below
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        marginTop: 10,
        marginBottom: 10,
        percent: true,
        x: {
          label: null,
          tickFormat: "f"
        },
        y: {
          nice: true
        },
        marks: [
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => d.year + 5,
            y: "wheat"
          }),
          Plot.areaY(data, {
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          })
        ]
      };

      var step2 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        marginTop: 10,
        marginBottom: 10,
        percent: true,
        x: {
          label: null,
          tickFormat: "f"
        },
        y: {
          nice: true
        },
        marks: [
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5), // 1820 data only extends to 1821
            y: "wheat"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810, // Prevent the absent data beyond 1810 being treated as 0s.
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          })
        ]
      };

      var step3 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        marginTop: 10,
        marginBottom: 10,
        percent: true,
        x: {
          label: null,
          tickFormat: "f"
        },
        y: {
          label: null,
          nice: true,
        },
        marks: [
          // gradientFill, // Add the SVG gradient definition as (inivisble) mark
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#gradient1)" // Here we link to that invisible gradient definition mark
          })
        ]
      };

      var step4 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr
        },
        marginTop: 10,
        marginBottom: 20,
        percent: true,
        x: {
          label: null,
          tickFormat: "f"
        },
        y: {
          nice: true
        },
        marks: [
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };
      var step5 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr
        },
        marginTop: 10,
        marginBottom: 20,
        percent: true,
        x: {
          label: null,
          tickFormat: "f"
        },
        y: {
          nice: true
        },
        marks: [
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };
      var step6 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 30,
        percent: true,
        x: {
          tickFormat: (d) => d3.format("d")(d % 50 === 0 ? d : d % 100),
          tickSize: 0,
          tickSpacing: 30,
          tickPadding: 4,
          label: `5 Years each division${" ".repeat(100)}5 Years each division`,
          labelAnchor: "center",
          labelArrow: "none",
          labelOffset: 24
        },
        y: {
          nice: true
        },
        marks: [
          Plot.axisY({
            anchor: "right",
            tickFormat: (d) =>
              d === 0 || d > 100 ?
              "" : d === 5 || d === 50 || d === 100 ?
              `${d} Shillings` : d,
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10,
            labelArrow: "none",
            labelOffset: 30,
            labelAnchor: "center",
            label: `Price of the Quarter ${" ".repeat(25)} of Wheat in Shillings`
          }),
          Plot.axisY({
            anchor: "left",
            tickFormat: (d) => (d === 0 || d > 100 ? "" : d % 10 === 0 ? d : 5),
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10
          }),
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };
      var step7 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 30,
        percent: true,
        x: {
          tickFormat: (d) => d3.format("d")(d % 50 === 0 ? d : d % 100),
          tickSize: 0,
          tickSpacing: 30,
          tickPadding: 4,
          label: `5 Years each division${" ".repeat(100)}5 Years each division`,
          labelAnchor: "center",
          labelArrow: "none",
          labelOffset: 24
        },
        y: {
          nice: true
        },
        marks: [
          Plot.axisY({
            anchor: "right",
            tickFormat: (d) =>
              d === 0 || d > 100 ?
              "" : d === 5 || d === 50 || d === 100 ?
              `${d} Shillings` : d,
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10,
            labelArrow: "none",
            labelOffset: 30,
            labelAnchor: "center",
            label: `Price of the Quarter ${" ".repeat(25)} of Wheat in Shillings`
          }),
          Plot.axisY({
            anchor: "left",
            tickFormat: (d) => (d === 0 || d > 100 ? "" : d % 10 === 0 ? d : 5),
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10
          }),
          Plot.gridX(d3.range(1600, 1830, 50), {
            y1: 0,
            y2: 100,
            strokeWidth: 1.5,
            strokeOpacity: 1
          }),
          Plot.gridX(d3.range(1565, 1830, 5), {
            y1: 0,
            y2: 100,
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(0, 101, 10), {
            strokeWidth: 2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(5, 90, 10), {
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };
      var step8 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 30,
        percent: true,
        x: {
          tickFormat: (d) => d3.format("d")(d % 50 === 0 ? d : d % 100),
          tickSize: 0,
          tickSpacing: 30,
          tickPadding: 4,
          label: `5 Years each division${" ".repeat(100)}5 Years each division`,
          labelAnchor: "center",
          labelArrow: "none",
          labelOffset: 24
        },
        y: {
          nice: true
        },
        marks: [
          Plot.axisY({
            anchor: "right",
            tickFormat: (d) =>
              d === 0 || d > 100 ?
              "" : d === 5 || d === 50 || d === 100 ?
              `${d} Shillings` : d,
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10,
            labelArrow: "none",
            labelOffset: 30,
            labelAnchor: "center",
            label: `Price of the Quarter ${" ".repeat(25)} of Wheat in Shillings`
          }),
          Plot.axisY({
            anchor: "left",
            tickFormat: (d) => (d === 0 || d > 100 ? "" : d % 10 === 0 ? d : 5),
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10
          }),
          Plot.gridX(d3.range(1600, 1830, 50), {
            y1: 0,
            y2: 100,
            strokeWidth: 1.5,
            strokeOpacity: 1
          }),
          Plot.gridX(d3.range(1565, 1830, 5), {
            y1: 0,
            y2: 100,
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(0, 101, 10), {
            strokeWidth: 2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(5, 90, 10), {
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };
      var monarchs = {
        width: width,
        height: 70,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 10,
        axis: null,
        y: {
          domain: [90, 100]
        },
        marks: [
          Plot.rect(monarchData, {
            x1: "start",
            x2: "end",
            y1: "y",
            y2: (d) => d.y + 1.0,
            fill: (d) => (d.commonwealth || d.future ? bgClr : "black"),
            stroke: "black"
          }),
          Plot.ruleX(monarchData, {
            x: "end",
            y1: (d) => (d.y < 96 ? d.y : d.y + 1),
            y2: (d) =>
              d.end > 1800 || d.name === "Charles I" || d.commonwealth ?
              d.y : d.y < 96 ?
              d.y + 3 : d.y - 2
          }),
          Plot.text(monarchData, {
            x: "x",
            y: "y",
            fontSize: 9,
            textAnchor: "middle",
            lineAnchor: "top",
            lineHeight: 0.82, // For more compact 'William and Mary' (thanks @Fil)
            dy: 4,
            text: "name"
          })
        ]
      };

      var step9 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr,
          fontFamily: fnt.script,
          fontWeight: 900
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 30,
        percent: true,
        x: {
          tickFormat: (d) => d3.format("d")(d % 50 === 0 ? d : d % 100),
          tickSize: 0,
          tickSpacing: 30,
          tickPadding: 4,
          label: `5 Years each division${" ".repeat(100)}5 Years each division`,
          labelAnchor: "center",
          labelArrow: "none",
          labelOffset: 24
        },
        y: {
          nice: true
        },
        marks: [
          Plot.axisY({
            anchor: "right",
            tickFormat: (d) =>
              d === 0 || d > 100 ?
              "" : d === 5 || d === 50 || d === 100 ?
              `${d} Shillings` : d,
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10,
            labelArrow: "none",
            labelOffset: 30,
            labelAnchor: "center",
            label: `Price of the Quarter ${" ".repeat(25)} of Wheat in Shillings`
          }),
          Plot.axisY({
            anchor: "left",
            tickFormat: (d) => (d === 0 || d > 100 ? "" : d % 10 === 0 ? d : 5),
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10
          }),
          Plot.gridX(d3.range(1600, 1830, 50), {
            y1: 0,
            y2: 100,
            strokeWidth: 1.5,
            strokeOpacity: 1
          }),
          Plot.gridX(d3.range(1565, 1830, 5), {
            y1: 0,
            y2: 100,
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(0, 101, 10), {
            strokeWidth: 2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(5, 90, 10), {
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          })
        ]
      };

      var cCurves = [{
          year: 1565,
          y1: 108,
          y2: 107
        },
        {
          year: 1590,
          y1: 102,
          y2: 102
        },
        {
          year: 1600,
          y1: 100,
          y2: 100
        },
        {
          year: 1605,
          y1: 101,
          y2: 101
        },
        {
          year: 1650,
          y1: 108,
          y2: 107
        },
        {
          year: 1695,
          y1: 101,
          y2: 101
        },
        {
          year: 1700,
          y1: 100,
          y2: 100
        },
        {
          year: 1705,
          y1: 101,
          y2: 101
        },
        {
          year: 1750,
          y1: 108,
          y2: 107
        },
        {
          year: 1795,
          y1: 101,
          y2: 101
        },
        {
          year: 1800,
          y1: 100,
          y2: 100
        },
        {
          year: 1805,
          y1: 102,
          y2: 102
        },
        {
          year: 1810,
          y1: 103.5,
          y2: 103.5
        }
      ];

      const centData = [1575, 1650, 1750, 1820].map((d, i) => ({
        x: d,
        y: 102,
        cent: 16 + i + "ᵗʰ Century"
      }));

      var century = {
        width: width,
        height: 70,
        style: {
          fontSize: size,
          textTransform: "capitalize"
        },
        marginLeft: 0,
        marginRight: 0,
        marginTop: 0,
        marginBottom: 0,
        axis: null,
        marks: [
          Plot.areaY(cCurves, {
            x: "year",
            y: "y1",
            y2: "y2",
            curve: "monotone-x",
            stroke: "black",
            fill: "black",
            strokeWidth: 2
          }),
          Plot.text(centData, {
            x: "x",
            y: "y",
            text: "cent",
            fontFamily: fnt.serif
          }),
          Plot.frame({
            anchor: "left",
            strokeWidth: 2
          }),
          Plot.frame({
            anchor: "right",
            strokeWidth: 2
          })
        ]
      };

      var step10 = {
        width: width,
        style: {
          fontSize: size,
          textTransform: "capitalize",
          backgroundColor: bgClr,
          fontFamily: fnt.script,
          fontWeight: 900
        },
        marginLeft: 20,
        marginRight: 60,
        marginTop: 10,
        marginBottom: 50,
        percent: true,
        x: {
          tickFormat: (d) => d3.format("d")(d % 50 === 0 ? d : d % 100),
          tickSize: 0,
          tickSpacing: 30,
          tickPadding: 4,
          label: `5 Years each division${" ".repeat(100)}5 Years each division`,
          labelAnchor: "center",
          labelArrow: "none",
          labelOffset: 24
        },
        y: {
          nice: true
        },
        marks: [
          Plot.axisY({
            anchor: "right",
            tickFormat: (d) =>
              d === 0 || d > 100 ?
              "" : d === 5 || d === 50 || d === 100 ?
              `${d} Shillings` : d,
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10,
            labelArrow: "none",
            labelOffset: 30,
            labelAnchor: "center",
            label: `Price of the Quarter ${" ".repeat(25)} of Wheat in Shillings`
          }),
          Plot.axisY({
            anchor: "left",
            tickFormat: (d) => (d === 0 || d > 100 ? "" : d % 10 === 0 ? d : 5),
            tickSize: 0,
            tickSpacing: 20,
            tickPadding: 4,
            fontSize: 10
          }),
          Plot.gridX(d3.range(1600, 1830, 50), {
            y1: 0,
            y2: 100,
            strokeWidth: 1.5,
            strokeOpacity: 1
          }),
          Plot.gridX(d3.range(1565, 1830, 5), {
            y1: 0,
            y2: 100,
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(0, 101, 10), {
            strokeWidth: 2,
            strokeOpacity: 1
          }),
          Plot.gridY(d3.range(5, 90, 10), {
            strokeWidth: 0.2,
            strokeOpacity: 1
          }),
          Plot.rectY(data, {
            x1: "year",
            x2: (d) => (d.year === 1820 ? 1821 : d.year + 5),
            y: "wheat",
            fill: "url(#vFade)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeWidth: 6,
            strokeLinecap: "butt",
            stroke: "rgb(204,78,91)"
          }),
          Plot.areaY(data, {
            filter: (d) => d.year <= 1810,
            x: "year",
            y: "wages",
            fill: "rgb(205,215,210)"
          }),
          Plot.line(data, {
            x: "year",
            y: "wages",
            strokeLinecap: "butt"
          }),
          Plot.text(["Weekly Wages of a Good Mechanic"], {
            x: 1626,
            y: 8.4,
            rotate: -1.3
          }),
          Plot.text(["Weekly Wages"], {
            x: 1741,
            y: 16.5,
            rotate: -7
          }),
          Plot.text(["of a Good Mechanic"], {
            x: 1762,
            y: 19.6,
            rotate: -12
          }),
          Plot.text(["№1"], {
            x: 1700,
            y: 105,
            fontFamily: fnt.serif,
            fontSize: 20
          }),
          Plot.text(["CHART"], {
            x: 1652,
            y: 81.5,
            fontFamily: fnt.display,
            fontSize: 20
          }),
          Plot.text(["Shewing at One View\nThe Price of The Quarter of Wheat,"], {
            x: 1652,
            y: 75,
            fontSize: 17
          }),
          Plot.text(["& Wages of Labour by the Week,"], {
            x: 1652,
            y: 68.5,
            fontFamily: fnt.serif,
            fontSize: 12
          }),
          Plot.text(["— from —"], {
            x: 1652,
            y: 66,
            fontFamily: fnt.serif,
            fontSize: 8
          }),
          Plot.text(["The Year 1565 to 1821,"], {
            x: 1652,
            y: 63.5,
            fontSize: 14
          }),
          Plot.text(["— by —"], {
            x: 1652,
            y: 60.5,
            fontFamily: fnt.serif,
            fontSize: 8
          }),
          Plot.text(["WILLIAM PLAYFAIR,"], {
            x: 1652,
            y: 57.75,
            fontFamily: fnt.display,
            fontSize: 12
          }),
          Plot.text(
            ["For a Particular Explanation, See Letter to the Lords & Commons"], {
              x: 1700,
              y: 0,
              dy: 40
            }
          )
        ]
      };

      document.getElementById("step1").appendChild(Plot.plot(step1));
      document.getElementById("step2").appendChild(Plot.plot(step2));
      document.getElementById("step3").appendChild(Plot.plot(step3));
      document.getElementById("step4").appendChild(Plot.plot(step4));
      document.getElementById("step5").appendChild(Plot.plot(step5));
      document.getElementById("step6").appendChild(Plot.plot(step6));
      document.getElementById("step7").appendChild(Plot.plot(step7));
      document.getElementById("step8").appendChild(Plot.plot(step8));
      document.getElementById("monarchs").appendChild(Plot.plot(monarchs));
      document.getElementById("step9").appendChild(Plot.plot(step9));
      document.getElementById("century").appendChild(Plot.plot(century));
      document.getElementById("step10").appendChild(Plot.plot(step10));
    });
  </script>
</body>

</html>