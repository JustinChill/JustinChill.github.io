<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <title>Flight Paths | Justin Chill</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Global flight paths">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="article" property="og:type">
  <meta content="https://justinchill.com/flights.html" property="og:url">
  <meta content="Flight paths | Justin Chill" property="og:title">
  <meta content="Global flight paths" property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/flights.html">

  <meta property="og:locality" content="New York">
  <meta property="og:region" content="NY">
  <meta property="og:country_name" content="USA">

  <meta name="datePublished" content="2025-06-16">
  <meta name="dateModified" content="2025-08-06">

  <meta content="https://www.justinchill.com/imgs/cover/flights_cover.webp" property="og:image">
  <meta content="https://www.justinchill.com/imgs/cover/flights_cover.webp" property="twitter:image">
  <meta content="World flight paths shown as bright violet lines across a dark world map." property="og:image:alt">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Flight paths | Justin Chill">
  <meta name="twitter:description" content="Global flight paths">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="preload" href="style.css" as="style" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <style type="text/css">
    #map {
      min-height: 490px;
      position: relative;
      /* Ensure consistent positioning context */
    }

    #map-base,
    #map-flights {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #map-flights {
      pointer-events: none;
      /* Let clicks pass through to base if needed */
      z-index: 2;
    }
  </style>
</head>

<body>
  <nav class="nav" role="navigation">
    <div class="nav__list">
      <a href="index.html" class="nav__item" aria-label="Homepage">Home</a>
      <a href="blog.html" class="nav__item" aria-label="Blog section">Blog</a>
      <a href="now.html" class="nav__item" aria-label="Now page">Now</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <div class="article-hero">
        <h2 class="article-category">Post</h2>
        <h1 class="article-title">Top Flight</h1>
        <h2 class="article-subtitle">World flight paths, 2014</h2>
      </div>

      <figure id="map" class="mid-size" aria-label="World map displaying global flight paths">
        <div id="map-base"></div>
        <div id="map-flights"></div>
        <figcaption class="right" style="position: absolute; bottom: 0; right: 0; z-index: 20;">Data: <a
            href="https://openflights.org">OpenFlights</a>, 2014</figcaption>

      </figure>

      <p>Global air travel is a vital part of the modern world, connecting cities, countries, and continents through a
        vast network of air routes. With over <strong>40,000</strong> airports globally and more than
        <strong>100,000</strong> daily flights, the aviation industry serves millions of passengers and transports
        significant cargo across the globe.
      </p>
      <p>World flight routes form a vast global network. Key hubs like Atlanta Hartsfield-Jackson and Beijing Capital
        International Airport handle a significant volume of air traffic. The Seoul to Jeju Island route in South Korea
        is the world's busiest by passenger traffic, with over 14 million passengers annually. In terms of long-haul
        routes, the New York to London and Los Angeles to Tokyo routes are among the busiest intercontinental flights.
        These routes are essential for global trade, tourism, and business, with commercial aviation contributing around
        <strong>3.6%</strong> of the world's GDP.
      </p>
      <span class="header-tag"><img src="imgs/tag.svg" alt="Chart header tag"></span>
      <h3>Busiest Airports by total passenger traffic (<small>M</small>)</h3>
      <figure id="chart-airports" aria-label="Bar chart showing the busiest airports in 2023">
        <figcaption class="right">Data: ACI World</figcaption>
      </figure>

    </article>
  </main>
  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <li id="pew">Recreation in Observable Plot of this original notebook by <a
          href="https://observablehq.com/@michaelbyrneau/flight-paths">Michael Byrne</a> showing all major air passenger
        routes as of 2014. Data sourced from OpenFlights.</li>
    </ol>

    <div>
      <p>Justin Chill &copy; 2026</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg"
            alt="GitHub logo" class="icon">Source code</a></span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>
  <script src="https://unpkg.com/@observablehq/stdlib@5.8.8/dist/stdlib.js"></script>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/topojson@3.0.2/dist/topojson.min.js"></script>

  <script type="text/javascript">
    // Use window.load to ensure the page renders before fetching heavy data
    window.addEventListener("load", async function () {
      var elementMid = d3.select('figure.mid-size').node();
      var widthMid = elementMid.getBoundingClientRect().width;
      var heightMid = 490; // Fixed height from CSS

      // 1. Fetch and Render Base Map (World Atlas)
      try {
        const world = await d3.json("https://unpkg.com/world-atlas@1/world/110m.json");
        const land = topojson.feature(world, world.objects.land);

        var baseMap = {
          width: widthMid,
          height: heightMid, // Explicit height to match CSS
          projection: "equal-earth",
          style: {
            backgroundColor: "#111",
          },
          marks: [
            Plot.sphere({
              fill: "#111"
            }),
            Plot.geo(land, {
              fill: "#262626"
            })
          ]
        };

        const mapBaseContainer = document.getElementById("map-base");
        mapBaseContainer.appendChild(Plot.plot(baseMap));

        // Fade out loader once base map is ready
        var loader = document.getElementById("map-loader");
        if (loader) {
          loader.classList.add('fade-out');
          setTimeout(() => loader.remove(), 500); // Remove after transition
        }

      } catch (error) {
        console.error("Error loading base map:", error);
      }

      // 2. Stream and Render Flights
      const url = "https://gist.githubusercontent.com/MichaelByrneAU/87383e163244055d641d4dcd58a5d24d/raw/d17299dcba8c9e18b4e1f4885f90a45618b55599/flight_paths_2014.csv";
      const flightContainer = document.getElementById("map-flights");

      try {
        const response = await fetch(url);
        const reader = response.body.getReader();
        const decoder = new TextDecoder("utf-8");
        let buffer = "";
        let flights = [];
        let chunkCount = 0;
        const CHUNK_SIZE = 25; // Update render every 25 flights for smoother initial feedback

        while (true) {
          const {
            done,
            value
          } = await reader.read();
          if (done) break;

          buffer += decoder.decode(value, {
            stream: true
          });
          const lines = buffer.split("\n");
          // Keep the last partial line in the buffer
          buffer = lines.pop();

          for (const line of lines) {
            const cols = line.split(",");
            // CSV structure: count, source_latitude, source_longitude, destination_latitude, destination_longitude
            if (cols.length >= 5) {
              const s_lat = parseFloat(cols[1]);
              const s_lon = parseFloat(cols[2]);
              const d_lat = parseFloat(cols[3]);
              const d_lon = parseFloat(cols[4]);

              if (!isNaN(s_lat) && !isNaN(s_lon) && !isNaN(d_lat) && !isNaN(d_lon)) {
                flights.push([
                  [s_lon, s_lat],
                  [d_lon, d_lat]
                ]);
              }
            }
          }

          // Incremental Render
          if (flights.length > chunkCount + CHUNK_SIZE) {
            chunkCount = flights.length;
            renderFlights(flights, widthMid, heightMid, flightContainer);
          }
        }

        // Final Render
        renderFlights(flights, widthMid, heightMid, flightContainer);

      } catch (error) {
        console.error("Error streaming flight data:", error);
      }

      function renderFlights(data, width, height, container) {
        container.innerHTML = "";
        const flightMap = {
          width: width,
          height: height,
          projection: "equal-earth",
          style: {
            background: "transparent",
          },
          marks: [
            Plot.link(data, {
              x1: d => d[0][0],
              y1: d => d[0][1],
              x2: d => d[1][0],
              y2: d => d[1][1],
              stroke: "#8014b7",
              strokeWidth: 0.25,
              strokeOpacity: 0.2,
              mixBlendMode: "screen"
            })
          ]
        };
        container.appendChild(Plot.plot(flightMap));
      }
    });

    // Top 10 Busiest Airports (2023)
    const airportData = [
      { airport: "Atlanta (ATL)", passengers: 104.7 },
      { airport: "Dubai (DXB)", passengers: 87.0 },
      { airport: "Dallas/Fort Worth (DFW)", passengers: 81.8 },
      { airport: "London Heathrow (LHR)", passengers: 79.2 },
      { airport: "Tokyo Haneda (HND)", passengers: 78.7 },
      { airport: "Denver (DEN)", passengers: 77.8 },
      { airport: "Istanbul (IST)", passengers: 76.0 },
      { airport: "Los Angeles (LAX)", passengers: 75.1 },
      { airport: "Chicago O'Hare (ORD)", passengers: 73.9 },
      { airport: "Delhi (DEL)", passengers: 72.2 }
    ];

    var airportChart = Plot.plot({
      marginLeft: 120,
      marginTop: 0,
      x: { label: "Passengers (Millions)", grid: true, ticks: 4, nice: true, },
      y: { label: null },
      marks: [
        Plot.barX(airportData, {
          x: "passengers",
          y: "airport",
          sort: { y: "x", reverse: true },
          fill: "#4c78a8",
          tip: true
        }),
        Plot.text(airportData, {
          x: "passengers",
          y: "airport",
          text: (d) => `${d.passengers}`,
          dx: 4,
          textAnchor: "start"
        })
      ]
    });

    document.getElementById("chart-airports").appendChild(airportChart);
  </script>
</body>

</html>