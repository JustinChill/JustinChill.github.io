<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
  <title>Stuxnet | Justin Chill</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Examining history’s first act of cyber warfare.">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="article" property="og:type">
  <meta content="https://justinchill.com/stuxnet.html" property="og:url">
  <meta content="Stuxnet | Justin Chill" property="og:title">
  <meta content="Examining history’s first act of cyber warfare." property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/stuxnet.html">

  <meta property="og:locality" content="New York">
  <meta property="og:region" content="NY">
  <meta property="og:country_name" content="USA">

  <meta content="" property="og:image">
  <meta content="" property="twitter:image">
  <meta content="" property="og:image:alt">

  <meta name="datePublished" content="2020-06-30">
  <meta name="dateModified" content="2025-07-04">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Stuxnet | Justin Chill">
  <meta name="twitter:description" content="Examining history’s first act of cyber warfare.">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="preload" href="style.css" as="style" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#4C63B6">

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <style type="text/css">
    g[aria-label*="tip"] {
      text-transform: capitalize;
    }

    div[class*="swatch"] {
      font-family: var(--font-main);
      font-size: calc(var(--type-scale--2) + .25vw);
      letter-spacing: -0.03px;
      line-height: calc(1.5em + .2vw);
    }

    div[class*="swatch"] svg {
      border-radius: 50%;
    }

    g[aria-label*="x-axis"] path {
      stroke: rgb(146, 146, 151)
    }

    @media screen and (max-width: 680px) {
      div[class*="swatch"] {
        font-size: calc(var(--type-scale--2) - .2vw);
        line-height: calc(1.42em - .3vw);
      }
    }
  </style>
</head>

<body>
  <nav class="nav">
    <div class="nav__list">
      <a href="index.html" class="nav__item">Home</a>
      <a href="blog.html" class="nav__item">Blog</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>

  <main role="main">
    <article>
      <div class="article-hero">
        <h2 class="article-category">Post</h2>
        <h1 class="article-title">To Kill a Centrifuge</h1>
        <h2 class="article-subtitle">Exploring Stuxnet</h2>
      </div>

      <h3>Children from low-income households are more likely to live in areas of high air pollution</h3>
      <figure id="scatter" aria-label=""></figure>
      <figcaption>Source: Department for Environment Food & Rural Affairs (<small>Defra</small>), End Child Poverty coalition data.</figcaption>
      <h2>1. Technical Breakdown of the Stuxnet Code</h2>
      <h3>1.1 Code Architecture and Functionality</h3>
      <p>Stuxnet’s code is architected in multiple layers with a highly modular design. At its core is a large main DLL containing the bulk of the malicious code (including numerous exported functions and embedded resources) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Response%20Stuxnet%20Architecture%20Organization%20Stuxnet,pointer%20to%20the%20original%20stub">OCR of the Document | National Security Archive</a>) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Exports%20As%20mentioned%20above%20the,Stuxnet%20Dossier%20Security%20Response%20Resources">OCR of the Document | National Security Archive</a>). This DLL is packaged into a “stub” section by a dropper component (an initial wrapper executable) that carries and deploys the payload. When Stuxnet executes, the dropper extracts the main DLL from its stub section, loads it into memory, and calls one of its export functions, passing a pointer to the stub as a parameter (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=configuration%20blocks%20The%20dropper%20component,so%20the%20original%20stub%20section">OCR of the Document | National Security Archive</a>). In turn, that export may load the same DLL again (from the stub) into another process and call another function, continually passing along the stub pointer. Through this layered <strong>dynamic loading</strong> technique, every stage of Stuxnet always has access to the main payload DLL and configuration data in the stub (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=%E2%80%9Cstub%E2%80%9D%20This%20stub%20section%20is,of%20the%20threat%20always%20has">OCR of the Document | National Security Archive</a>) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=dll%20file%20into%20memory%20and,correctly%20file%20and%20call%20whatever">OCR of the Document | National Security Archive</a>). This design allowed Stuxnet to carry a complex payload and remain resident across multiple processes without ever writing the main DLL to disk in the clear.</p>
      <p>The main DLL contains dozens of exported functions, each implementing a distinct routine for controlling the worm’s behavior (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Exports%20As%20mentioned%20above%20the,Stuxnet%20Dossier%20Security%20Response%20Resources">OCR of the Document | National Security Archive</a>). For example, specific exports are responsible for infecting removable drives, hooking Siemens Step7 PLC software APIs, propagating via network exploits, replacing legitimate DLLs, and cleaning up the infection. Table 3 of Symantec’s analysis enumerated these exports – for instance, Export 16 performs the main installation, Export 17 replaces a Step7 DLL to facilitate PLC sabotage, Export 22 handles network propagation, Export 28/29 implement command-and-control communication, and Export 18 is the self-removal routine (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=the%20threat%20as%20outlined%20in,and%20exploit%20modules%20Both%20the">OCR of the Document | National Security Archive</a>) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=described%20in%20the%20Sabotaging%20PLCs,Stuxnet%E2%80%99s%20configuration%20file%20Export%2019">OCR of the Document | National Security Archive</a>). In addition to code exports, the main DLL carries numerous <strong>resources</strong> – encrypted blobs that include auxiliary binaries and data. These resources include two custom kernel driver files (named <code>mrxcls.sys</code> and <code>mrxnet.sys</code> in some variants) used for stealth and kernel-level hooking, an DLL for infecting Step7 project files, an .CAB file targeting Siemens WinCC software, templates for generating exploit files (e.g. a malicious <code>.LNK</code> shortcut), and multiple 0-day exploit modules (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=to%20template%20executables%20to%20configuration,rootkit%20driver%20250%20Exploits%20Windows">OCR of the Document | National Security Archive</a>) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Resource%20ID%20Function%20201%20MrxNet,including%20itself%20it%20uses%20a">OCR of the Document | National Security Archive</a>). Notably, the drivers were digitally signed with stolen certificates (from Realtek and JMicron) to appear legitimate, enabling them to load on Windows systems prior to certificate revocation (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=to%20template%20executables%20to%20configuration,rootkit%20driver%20250%20Exploits%20Windows">OCR of the Document | National Security Archive</a>). Overall, Stuxnet’s architecture is a carefully layered combination of a <strong>dropper</strong>, a <strong>worm</strong> component for propagation, a <strong>rootkit</strong> for hiding itself, and a specialized <strong>payload</strong> to subvert industrial control systems.</p>
      <h3>1.2 Payload Analysis and Behavior</h3>
      <p>The ultimate goal of Stuxnet’s payload was to <strong>sabotage Iran’s uranium enrichment centrifuges</strong> by subtly altering the operation of PLCs (Programmable Logic Controllers) that controlled those centrifuges. Once Stuxnet finds itself on a system with Siemens Step7 industrial control software, it injects malicious code into the PLC control logic while feeding fake sensor feedback to operators – a classic man-in-the-middle attack on physical equipment (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Step%207%20Project%20File%20Infections,50%20Security%20Response%20W32%20Stuxnet">OCR of the Document | National Security Archive</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=second%20version%20of%20the%20Stuxnet,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). The worm specifically targets Siemens S7 PLCs connected to <strong>frequency converter drives</strong> – power electronics that control the speed of motors. (In Natanz, these drives controlled centrifuge rotor speeds.) Stuxnet monitors the frequency of the targeted motors and only triggers the malicious sequence if the rotation frequency is in the range of roughly 807 Hz to 1210 Hz – a range characteristic of gas centrifuges (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=frequency%20of%20the%20attached%20motors%2C,into%20memory%20block%20DB890%20of">Stuxnet - Wikipedia</a>). Upon meeting these conditions, Stuxnet modifies the PLC’s instructions to gradually vary the motor speed outside safe limits. In one routine, it surreptitiously commands the centrifuge motors to speed up to <strong>1410 Hz</strong> (well beyond normal operating speed) and later to suddenly drop to <strong>2 Hz</strong>, before returning to normal (1064 Hz) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=When%20certain%20criteria%20are%20met%2C,on%20this%20platform%20%E2%80%93%20that">Stuxnet - Wikipedia</a>). This causes the centrifuges to strain under excessive speed and then wobble at abnormally low speeds. The process occurs in cycles (with one phase lasting about 15 minutes at high speed, and another phase weeks later at low speed for about 50 minutes) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=When%20certain%20criteria%20are%20met%2C,on%20this%20platform%20%E2%80%93%20that">Stuxnet - Wikipedia</a>). By repeating these stress-inducing cycles, the payload could induce <strong>physical damage</strong>: the rapid speed changes created metal fatigue, disrupted the centrifuges’ delicate balance, and led to the breakdown of rotors over time (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=minutes%20before%20returning%20to%20its,tubes%20to%20expand%2C%20often%20forcing">Stuxnet - Wikipedia</a>).</p>
      <p>Critically, Stuxnet also hides its sabotage from operators. It intercepts calls to the PLC and sensor readings using a replaced DLL (<code>s7otbxdx.dll</code>) in the Step7 software environment (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Step%207%20Project%20File%20Infections,50%20Security%20Response%20W32%20Stuxnet">OCR of the Document | National Security Archive</a>). This <strong>PLC rootkit</strong> reports normal operating values (e.g. showing stable frequencies and pressures) while the malicious routine is running, so that plant operators and monitoring systems see no anomaly (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=When%20certain%20criteria%20are%20met%2C,and%20thus%20affects%20the%20operation">Stuxnet - Wikipedia</a>). Meanwhile, the actual PLC code is executing Stuxnet’s instructions to alter centrifuge speeds or valve states. This deception ensured the attack could persist longer without detection, increasing the chances of cumulative damage. The sophistication of the payload – containing legitimate code sequences to check for specific model numbers of PLCs, frequency converters from particular vendors (Vacon and Fararo Paya), and very specific operational parameters – shows that it was <strong>precision-targeted</strong>. It was not intended to cause indiscriminate damage, but rather to quietly degrade a very specific industrial process (Iran’s gas centrifuge enrichment) over time (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,rotors%20to%20break%20early%20%E2%80%93">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,still%2C%20disaster%20won%27t%20hit%20you">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>).</p>
      <p><em>Code Snippet:</em> The following pseudocode illustrates Stuxnet’s PLC sabotage logic (targeting rotor speed):</p>
      <pre><code class="language-c"><span class="hljs-comment">// Pseudocode for PLC sabotage sequence (simplified)</span>
      <span class="hljs-keyword">if</span> (motor_frequency &gt;= <span class="hljs-number">807</span> Hz &amp;&amp; motor_frequency &lt;= <span class="hljs-number">1210</span> Hz) {
          record_normal_operating_speed();             <span class="hljs-comment">// Save baseline speed</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">600</span>; i++) {                  <span class="hljs-comment">// Run for ~10 minutes</span>
              set_motor_frequency(<span class="hljs-number">1410</span> Hz);            <span class="hljs-comment">// Step 1: push speed beyond safe limit</span>
              delay(<span class="hljs-number">1</span> second);
          }
          restore_motor_frequency_baseline();          <span class="hljs-comment">// Back to normal for a while</span>
          <span class="hljs-comment">// ... (after some weeks delay) ...</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>; j&lt;<span class="hljs-number">3000</span>; j++) {                 <span class="hljs-comment">// Run for ~50 minutes</span>
              set_motor_frequency(<span class="hljs-number">2</span> Hz);               <span class="hljs-comment">// Step 2: drop speed to an extreme low</span>
              delay(<span class="hljs-number">1</span> second);
          }
          restore_motor_frequency_baseline();
          <span class="hljs-comment">// Note: Actual Stuxnet code replays sensor feedback during these changes </span>
          <span class="hljs-comment">// so that operators see normal readings (hidden via infected Step7 DLL).</span>
      }
      </code></pre>
      <p><em>// The above sequence greatly stresses centrifuge rotors – the overspeed causes vibration and heat, and the extreme slow-down causes destabilization. Over repeated cycles, this led to premature failure of the centrifuges.</em></p>
      <p>Beyond the infamous centrifuge speed attack, an <strong>earlier variant</strong> of Stuxnet carried a different but equally devastating payload: manipulation of valve control at the enrichment plant. In that version, Stuxnet targeted Siemens S7-417 PLCs that managed the cascade of centrifuges and the valves feeding uranium hexafluoride gas (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=the%20centrifuge%20rotors,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=how%20they%20did%20so%3A%20The,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). The malware could close critical valves to increase pressure inside centrifuges (“overpressure” attack), potentially causing the uranium gas to solidify and wreck multiple centrifuges simultaneously (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=dormant%20payload%2C%20which%20overpressured%20the,eventually%20disable%20them%2C%20targeting%20the">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,rotors%20to%20break%20early%20%E2%80%93">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). Interestingly, analysis suggests the attackers may have configured this early attack to avoid outright catastrophic destruction – the code closely monitored pressure and centrifuge states, likely aiming for gradual damage (increased wear and early failure) rather than an obvious explosion (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,rotors%20to%20break%20early%20%E2%80%93">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This reveals the strategic intent: Stuxnet was meant to <strong>silently induce failures</strong> that would appear as random mishaps, thereby sabotaging Iran’s enrichment output without immediate suspicion of an external attack.</p>
      <h3>1.3 Infection and Propagation Techniques</h3>
      <p>Stuxnet employed multiple propagation methods to spread from an initial patient zero to the target systems, combining both <strong>physical (USB)</strong> and <strong>network-based</strong> infection vectors. The worm famously utilized a Windows <strong>.LNK shortcut vulnerability</strong> (CVE-2010-2568) to auto-execute from USB flash drives (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
          STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
        </a>). The attackers delivered Stuxnet via removable drives knowing that the Natanz facility was air-gapped (isolated from the Internet). Simply viewing an infected USB drive in Windows Explorer would execute the embedded malicious shortcut, which in turn loaded the Stuxnet dropper – <strong>no user action or autorun prompt required</strong> (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=VirusBlokAda%2C%20an%20antivirus%20vendor%20based,mspx">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
          STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
        </a>). This allowed Stuxnet to jump the air-gap when an unwitting insider or contractor plugged in an infected USB device. Once inside the secure facility’s network, Stuxnet could propagate laterally. It scanned for other Windows machines and leveraged several <strong>zero-day exploits</strong> as well as known vulnerabilities to copy itself across systems:</p>
      <ul>
        <li><strong>Print Spooler Exploit (CVE-2010-2729)</strong> – a 0-day at the time, enabling remote code execution by sending a malicious print request to a shared printer spooler service (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=STUXNET%20Malware%20Targets%20SCADA%20Systems,a%20printer%20over%20the%20network">STUXNET Malware Targets SCADA Systems - Threat Encyclopedia</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
            STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
          </a>). Stuxnet used this to spread to any networked PC that had printer sharing enabled (common in Windows XP).</li>
        <li><strong>Windows Server Service Exploit (MS08-067)</strong> – the same vulnerability used by the Conficker worm (CVE-2008-4250). Stuxnet included this exploit to propagate via SMB network shares on older, unpatched machines (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=201%20207%20Autorun%20version%20of,including%20itself%20it%20uses%20a">OCR of the Document | National Security Archive</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
            STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
          </a>). While not a 0-day by 2010, it remained effective on systems that had not applied the 2008 patch.</li>
        <li><strong>Step 7 Project File Infection</strong> – Stuxnet could infect Siemens Step7 project files themselves, inserting its code into engineering project data. If these projects were moved to another machine (e.g. by an engineer updating PLC code via their laptop), the malware would hitch a ride. This <strong>peer-to-peer replication</strong> through project files was the primary spreading method in the earliest Stuxnet version 0.5 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Step%207%20project%20files%20X,peer%20updating%20through%20mailslots%20X"></a>). Later versions 1.x added the more aggressive Windows exploits listed above.</li>
        <li><strong>Autorun and Network Shares</strong> – In early variants, Stuxnet also attempted to spread via Windows autorun.inf files on removable media (an older tactic) and by copying itself to network shares and remote administrative shares (like default Admin$ shares) where possible (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=USB%20through%20Autorun%20X%20USB,through%20RPC%20X%20X%20X"></a>).</li>
      </ul>
      <p>Once on a new machine, Stuxnet would install itself and then attempt to <strong>locally escalate privileges</strong> to ensure it had the necessary permissions to drop its drivers and manipulate the system. It exploited at least two Windows local privilege escalation 0-days: one in the Windows Task Scheduler (CVE-2010-3888) and one in the Windows Win32K kernel (Keyboard layout vulnerability, CVE-2010-2743) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Vulnerability%200,025%20X%20NtUserRegisterClassExWow%2FNtUserMessageCall%20EOP"></a>). The Task Scheduler bug allowed Stuxnet to gain SYSTEM-level privileges on Windows Vista and newer systems by abusing a flaw in how task files were processed, whereas the Win32K keyboard layout flaw achieved kernel-mode execution on Windows XP/Server 2003 (<a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-073#:~:text=Microsoft%20Security%20Bulletin%20MS10,mode">Microsoft Security Bulletin MS10-073 - Important</a>) (<a href="https://www.zero-day.cz/database/83/#:~:text=Zero,vulnerability%20was%20exploited%20by%20Stuxnet">Zero-day vulnerability in Windows</a>). By using these, the worm ensured that even if it initially ran with limited user rights, it could install its kernel-mode rootkit drivers and persist.</p>
      <p>Another important propagation step was <strong>target discovery</strong>. Stuxnet was programmed not to wildly spread beyond its intended environment, but it still infected many machines as it searched for the specific Siemens PLC configuration. Internally, it would check for the presence of Step7 software or particular PLC device signatures. If the target environment was not found, Stuxnet largely stayed dormant or only spread a limited number of times, reducing unnecessary visibility (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20implementation%20of%20the%20attack,necessarily%20during%20the%20attack%20run">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20attackers%20behind%20Stuxnet%20reportedly,quoting%20unnamed%20Obama%20administration%20officials">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This controlled propagation indicates a deliberate effort to <em>contain</em> the malware within the intended target networks (primarily in Iran), although it did temporarily infect over 100,000 computers worldwide during its discovery period (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=system%20and%20networks%2C%20then%20seeking,and%20caused%201%2C000%20machines%20to">Stuxnet - Wikipedia</a>).</p>
      <p>(<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems"><br>
          STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
        </a>) <em>Figure: Stuxnet’s multi-component architecture and propagation paths. The worm spread via multiple 0-day exploits (e.g. MS08-067, MS10-061, MS10-046) through USB drives and local networks, then connected to command-and-control servers and targeted Siemens WinCC/Step7 systems (Trend Micro depiction) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=STUXNET%20has%20three%20components%20that,LNK%20file%2C%20and%20a%20rootkit"><br>
            STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
          </a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=How%20does%20STUXNET%20propagate%3F%20What,vulnerabilities%20were%20used"><br>
            STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
          </a>).</em></p>
      <p>Once Stuxnet found a machine running Siemens WinCC/Step7 software, it deployed a <strong>database infection routine</strong>. It exploited a hardcoded password in WinCC’s MS SQL database (CVE-2010-2772) to silently query and <strong>inject itself into the SCADA database</strong> (<a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2772#:~:text=Siemens%20Simatic%20WinCC%20and%20PCS,end%20database%20and%20gain%20privileges">CVE-2010-2772 Detail - NVD</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=Encyclopedia%20www.trendmicro.com%20%20CVE,the%20projects%20database%20and">STUXNET Malware Targets SCADA Systems - Threat Encyclopedia</a>). This way, if engineers used Step7/WinCC to program PLCs, the malware would infect those project files (stored in the database or on disk) and thus spread to other engineering PCs or PLCs. Stuxnet also set up a <strong>peer-to-peer update network</strong> among infected machines: it could receive updates or new payloads from any other compromised machine via RPC or “mailslot” communications, without always needing an Internet connection (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Network%20shares%20X%20X%20X,through%20RPC%20X%20X%20X"></a>). This P2P update mechanism meant that even within an isolated facility, if one machine got an updated variant (or a removal command), it could propagate that to fellow infected hosts. All these techniques show Stuxnet’s propagation was <strong>multi-faceted</strong> – it was capable of jumping across air-gaps, moving laterally through networks using both patched and 0-day exploits, and even piggybacking on the project files of the very industrial systems it aimed to sabotage.</p>
      <h3>1.4 Command and Control (C2) Mechanisms</h3>
      <p>For a period of its deployment, Stuxnet included the ability to communicate with remote command-and-control servers over the Internet. The malware generated network traffic to two predetermined C2 domain names: <strong><code>www.mypremierfutbol.com</code></strong> and <strong><code>www.todaysfutbol.com</code></strong> (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20November%202008%20,appears%2C%20starts%20to%20spread%20rapidly">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20December%202008%20,and%20the%20server%20controlling%20them">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>). These were disguised as soccer fan sites but were actually controlled by the attackers. The C2 mechanism was used to report infection statistics and possibly to allow remote updates or commands. Notably, researchers found that the attackers had registered at least one of these domains as early as 2008, indicating long-term planning (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20November%202008%20,appears%2C%20starts%20to%20spread%20rapidly">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>). Once Stuxnet infects a system, it attempts to contact these domains (over HTTP) to announce its presence and download potential updates (the malware could pull down newer versions of itself or new instructions) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20December%202008%20,and%20the%20server%20controlling%20them">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20April%201%2C%202009%20,an%20Islamic%20republic%20in%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>).</p>
      <p>However, Stuxnet was also designed to operate <strong>autonomously</strong> if C2 was unavailable. Given that many target systems were not Internet-connected, the worm’s payload did not strictly require online commands – the destructive PLC logic was baked into the malware itself. The C2 primarily served for telemetry and control during the early stages of the operation. In fact, by the time Stuxnet was widely discovered in June 2010, the C2 servers were observed distributing an updated version that <em>removed</em> the malware (perhaps an attempted cover-up) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20June%202010%20,that%20was%20found%20in%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>). In July 2010, as news of Stuxnet spread, those domains were shut down. Symantec monitored C2 traffic for a period and noted tens of thousands of check-in attempts, the majority from Iran, indicating the scale of infection in the target region (<a href="https://repository.law.uic.edu/cgi/viewcontent.cgi?article=1697&amp;context=jitpl#:~:text=,Indonesia">[PDF] Stuxnet as Cyberwarfare: Applying the Law of War to the Virtual …</a>).</p>
      <p>Internally, Stuxnet also featured a peer-to-peer communication system for C2-like purposes. In the absence of Internet, infected machines could use a hidden RPC channel to pass messages or updates. One infected host could thus relay instructions or updated payloads to others on the local network (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Network%20shares%20X%20X%20X,through%20RPC%20X%20X%20X"></a>). This design increased reliability of the malware’s operation in isolated networks.</p>
      <p>Stuxnet’s C2 communications were encrypted and obfuscated to evade detection. The use of seemingly benign domain names and normal HTTP traffic helped it blend in with regular network noise. Overall, while C2 played a role, Stuxnet’s mission was not heavily dependent on continuous attacker control – it was <strong>preprogrammed to execute the sabotage automatically</strong> once conditions were met, even if cut off from its creators (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=dormant%20payload%2C%20which%20overpressured%20the,eventually%20disable%20them%2C%20targeting%20the">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,rotors%20to%20break%20early%20%E2%80%93">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This autonomy in the payload underscores its nature as a covert weapon rather than traditional botnet malware.</p>
      <h3>1.5 Self-Destruction and Stealth Mechanisms</h3>
      <p>Stuxnet incorporated multiple features to hide its presence and to gracefully deactivate after a certain period, reflecting careful operational security. Its kernel-mode rootkit (<code>mrxnet.sys</code> and related driver) concealed files and processes associated with the worm, making it invisible to ordinary users and even security software. For example, the rootkit filtered directory listings and registry queries to prevent the Stuxnet files from being seen, and it intercepted requests to the PLC to hide the injected rogue code blocks (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=gas%20centrifuges.,and%20thus%20affects%20the%20operation">Stuxnet - Wikipedia</a>) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=of%20the%20connected%20motors%20by,rotational%20speed%20from%20monitoring%20systems">Stuxnet - Wikipedia</a>). This was the first known case of a rootkit on a PLC – Stuxnet not only hid within Windows but also <strong>masked itself on the PLC level</strong>, ensuring that its modifications to controller logic were not easily noticed by diagnostic software (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=gas%20centrifuges.,and%20thus%20affects%20the%20operation">Stuxnet - Wikipedia</a>).</p>
      <p>Crucially, Stuxnet was programmed with a <strong>kill-switch date</strong>. In later versions (1.x), the worm will stop propagating and automatically erase itself from infected computers after <strong>June 24, 2012</strong> (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=1,Infection%20stop%20date%20Table%202"></a>). Earlier version 0.5 had a similar expiration date of July 4, 2009 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). These dates were likely chosen to limit the worm’s lifespan – after accomplishing its goal (or if too much time passed), it would ideally disappear to reduce the chance of exposure. The self-removal routine (export function 18 in the main DLL) would delete the malware’s files and undo modifications. Symantec noted that the uninstall routine was also triggerable via a specific command: Stuxnet listened on a named pipe for a special signal that could instruct it to purge itself from the system (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=described%20in%20the%20Sabotaging%20PLCs,Stuxnet%E2%80%99s%20configuration%20file%20Export%2019">OCR of the Document | National Security Archive</a>). This means the creators had the ability to send an uninstall command (perhaps via C2 or through a peer update) to clean up the malware from the field.</p>
      <p>The combination of a time-based kill-switch and an on-demand removal command shows the attackers’ intent to <strong>avoid long-term detection</strong>. Indeed, one earlier variant of Stuxnet (0.5) lay dormant and undetected for years, and was only found retrospectively because traces of its code were left in later samples by accident (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=One%20big%20takeaway%20from%20Langner%27s,much%20higher%20risk%20of%20detection">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=Langner%20told%20Dark%20Reading%20that,more%20deadly%20attack%2C%20he%20says">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). Stuxnet also took care not to crash systems or make noisy indicators – if it didn’t find the exact target environment, it largely tried to stay inert. All these self-preservation and self-destruction measures exemplify a threat designed with <em>military-grade</em> stealth. Security analysts have pointed out that without an innocuous bug in the code’s spreading mechanism that drew attention in 2010, Stuxnet might have remained hidden for much longer (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=Langner%20told%20Dark%20Reading%20that,more%20deadly%20attack%2C%20he%20says">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>).</p>
      <h2>2. Variants and Evolution of Stuxnet</h2>
      <h3>2.1 Timeline of Discovered Versions</h3>
      <p>Multiple versions of Stuxnet were developed and deployed over several years. The earliest known variant, often dubbed <strong>Stuxnet 0.5</strong>, appears to have been in development as far back as late <strong>2005</strong> (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). Symantec’s analysis revealed that Stuxnet 0.5 was operational in the wild by <strong>2007</strong>, possibly introduced into Iranian networks around that time (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). It was a slower-spreading, less noisy strain that went undetected for years. This version had an internal kill date of July 4, 2009, meaning it stopped trying to infect new machines after that date (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>).</p>
      <p>The more famous <strong>Stuxnet 1.x</strong> versions were built on a somewhat different platform and began compiling in <strong>2009</strong>. A version identified as 1.001 had a compile timestamp of June 22, 2009 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=0,101%20Description"></a>), likely corresponding to the initial deployment of the “second wave” attack in Iran. This was followed by version 1.100, compiled around March 1, 2010, and 1.101 on April 14, 2010 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=0,2010%20Main%20binary%20compile%20timestamp"></a>). These incremental updates in early 2010 coincide with attackers adding new capabilities to accelerate the spread and payload effectiveness (as corroborated by reports that “in January 2010 the operators added new components…and in March 2010…even more powerful” (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=anniversary%20of%20the%20declaration%20of,an%20Islamic%20republic%20in%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>)). Stuxnet’s activity came to light in June 2010 when a surge of infections in Iran was detected and a sample was shared with cybersecurity firms (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20June%202010%20,that%20was%20found%20in%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>). Over the following months, its existence and purpose were unveiled by researchers worldwide.</p>
      <p>A concise timeline is as follows (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20May%202006%20,in%20its%20uranium%20enrichment%20facilities">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20March%202009%20,to%20deliver%20Stuxnet%20to%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>):</p>
      <ul>
        <li><strong>Nov 2005:</strong> Earliest development of Stuxnet 0.5 (based on code compilation clues).</li>
        <li><strong>2007:</strong> Stuxnet 0.5 deployed against Iran’s Natanz facility (first attack wave targeting valve/pressure systems).</li>
        <li><strong>Nov 2007:</strong> Stuxnet 0.5 sample submitted to an online scanning service, indicating its presence in the wild (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Version%20Date%20Description%200,Infection%20stop%20date%20Table%202"></a>).</li>
        <li><strong>2009:</strong> Transition to Stuxnet 1.x; first attack wave possibly ends as 0.5 stops spreading by mid-2009 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). Attackers register C2 domains and begin second wave deployment (the rotor speed attack). By April 2009, Stuxnet is being introduced into Natanz (as later reported) (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20April%201%2C%202009%20,an%20Islamic%20republic%20in%20Iran">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>).</li>
        <li><strong>June 2009:</strong> Version 1.001 (June 22) in use. Iran later noted centrifuge problems in later 2009 which align with this timing.</li>
        <li><strong>Jan–Mar 2010:</strong> Versions 1.100/1.101 compiled with new 0-day exploits added. The malware spreads more aggressively in Iran’s networks, infecting many computers but remaining covert.</li>
        <li><strong>June 2010:</strong> An unrelated error (possibly a conflict with certain systems or an unstable spreading routine) causes Stuxnet to crash some Windows machines, leading a Belarus-based firm (VirusBlokAda) to discover an unknown worm. They announce the finding on July 15, 2010 (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=VirusBlokAda%2C%20an%20antivirus%20vendor%20based,mspx">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>) (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=ICS,queries%20are%20not%20yet%20known">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>).</li>
        <li><strong>July 2010:</strong> Public reports of Stuxnet surface (first by independent bloggers and then AV companies). Intensive global analysis begins.</li>
        <li><strong>Late 2010:</strong> Iranian officials acknowledge a cyber weapon affected their facilities, after months of replacing failed centrifuges (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20July%202010%20,of%20Stuxnet%20on%20his%20website">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>). By this time, Stuxnet’s mission in the wild is effectively over.</li>
        <li><strong>June 24, 2012:</strong> Stuxnet’s preset expiration date for version 1.x – any remaining active instances self-deactivate (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=1,Infection%20stop%20date%20Table%202"></a>).</li>
      </ul>
      <p>In summary, Stuxnet’s development spanned roughly a decade (2005–2010 active development, with effects observed up to 2010). More than one variant was deployed: an <strong>earlier, stealthier version (2007–2009)</strong> and a <strong>later, more aggressive version (2009–2010)</strong>. There is evidence suggesting even interim builds (“missing links”) that were never recovered publicly (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Clues%20in%20the%20code%20pointed,and%20in%20development%20as%20early"></a>) (<a href="https://venturebeat.com/security/stuxnet-2005/#:~:text=Stuxnet%200,The%20Stuxnet%20we%20are">Symantec uncovers an older version of Stuxnet, proving it is directly …</a>) – the attackers likely iterated frequently. Notably, security researchers in 2013 uncovered the 0.5 variant, providing a glimpse into the malware’s evolution and confirming that Stuxnet had a longer history than initially thought (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=One%20big%20takeaway%20from%20Langner%27s,much%20higher%20risk%20of%20detection">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20first%20attack%20was%20never,malware%20was%20discovered%20in%202010">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>).</p>
      <h3>2.2 Key Differences Between Variants</h3>
      <p>Stuxnet 0.5 and Stuxnet 1.x had significant differences in both propagation and payload, reflecting a strategic shift by the attackers. <strong>Propagation &amp; Exploits:</strong> Version 0.5 was less aggressive – it did <em>not</em> use any of the Microsoft Windows zero-day exploits that made 1.x so notorious (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). Instead, 0.5 spread primarily through Siemens Step7 project file infection and a peer-to-peer update mechanism between industrial computers (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Step%207%20project%20files%20X,peer%20updating%20through%20mailslots%20X"></a>). It did not exploit the .LNK flaw or print spooler; in fact, it leveraged no Windows-specific vulnerability except a Siemens Step7 library-loading flaw (CVE-2012-3015, which wasn’t publicly known then) to install itself via a project file** (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=CVE,files%20X%20X%20X%20X"></a>). In contrast, the 1.x variants introduced <em>four</em> 0-day exploits (LNK, print spooler, and two privilege escalations) and one previously patched exploit (MS08-067) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Vulnerability%200,025%20X%20NtUserRegisterClassExWow%2FNtUserMessageCall%20EOP"></a>) to spread far and wide. Additionally, later versions incorporated the stolen digital certificates for their drivers, whereas 0.5 did not use driver files at all (it injected code in-memory and used a different technique to load malicious code, avoiding the need for a driver) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=reports%20quoting%20unnamed%20Obama%20administration,officials">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>).</p>
      <p><strong>Payload:</strong> The most striking difference was the attack strategy on the centrifuges. Stuxnet 0.5 carried the <strong>valve/pressure manipulation payload</strong> targeting the Siemens 417 PLCs (Natanz cascade protection system) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=the%20centrifuge%20rotors,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This approach was complex and highly stealthy – it interacted with the process at a systems-protection level, carefully controlling valves to create overpressure conditions without triggering immediate alarms (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=,rotors%20to%20break%20early%20%E2%80%93">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). On the other hand, Stuxnet 1.x implemented the <strong>rotor speed manipulation payload</strong> on the Siemens 315 PLCs (centrifuge drive controllers) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=have%20led%20to%20a%20more,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=second%20version%20of%20the%20Stuxnet,315%20controller">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This was a more direct attack on the centrifuge motors, simpler in concept (just speed up or slow down) but comparatively “louder” in its effect (physical stress on machines that eventually became evident). Experts note that the early version (0.5) was <em>potentially more destructive</em> – it could have led to a catastrophic cascade failure if fully unleashed – but it was never detected at the time and apparently did not cause an obvious plant-wide incident (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20later,and%20further%20studying%20the%20attacks">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20implementation%20of%20the%20attack,necessarily%20during%20the%20attack%20run">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). The later version (1.x) did succeed in destroying an estimated <strong>~1,000 centrifuges</strong> (about a fifth of Iran’s capacity) by mid-2010 (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=systems%20and%20causing%20the%20fast,10">Stuxnet - Wikipedia</a>), but it also ultimately revealed itself due to its wider propagation.</p>
      <p>Another difference was in <strong>development framework</strong>. Stuxnet 0.5 appears to have shared some code with another malware known as “Flamer”, using a different encryption method and code base, whereas Stuxnet 1.x was built on what researchers call the “Tilded” platform (named for the tilde “~” in some file names) that also gave rise to related malware like <strong>Duqu</strong> (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Clues%20in%20the%20code%20pointed,and%20in%20development%20as%20early"></a>) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). This suggests that the team developing Stuxnet made a major change (or was joined by a new team) between 2007 and 2009, possibly rewriting large portions of the code. Consistent with this, the 1.x version shows hallmarks of NSA/Cyber Command capabilities (multiple 0-days, advanced rootkit, robust C2) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=reports%20quoting%20unnamed%20Obama%20administration,officials">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>), whereas 0.5 looked more like an ISA (Instrumentation/ICS) engineer’s project (focusing on PLC logic, using Step7-specific infection paths). This has led to theories that the <strong>stakeholders changed</strong> – for example, early development may have been led more by Israeli units (with deep knowledge of Iranian systems), while later versions had increased U.S. involvement bringing additional cyber-firepower (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=So%20why%20the%20change,Langner%20says%20of%20the%20attackers">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=reports%20quoting%20unnamed%20Obama%20administration,officials">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). While unconfirmed, it is clear the later Stuxnet variant represents an <em>amalgamation of skillsets</em>: low-level Windows exploitation meets high-level industrial process manipulation.</p>
      <p><strong>Containment vs. Proliferation:</strong> Stuxnet 0.5 was extremely cautious – it only spread via Step7 projects, which naturally limited it to very specific industrial engineering contexts (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). Version 1.x, in contrast, spread via any USB stick or network it could, resulting in a global outbreak (it infected systems in India, Indonesia, the U.S., etc., though the payload activated only on the intended targets) (<a href="https://repository.law.uic.edu/cgi/viewcontent.cgi?article=1697&amp;context=jitpl#:~:text=,Indonesia">[PDF] Stuxnet as Cyberwarfare: Applying the Law of War to the Virtual …</a>). This indicates that by 2009, the attackers were willing to accept a higher risk of detection in order to ensure the malware reached the target. In fact, Langner’s analysis points out this shift: the first attack (0.5) was <em>“never meant to be detected”</em> and indeed stayed hidden for ~5 years, whereas the second attack (1.x) was riskier and burned multiple exploits in a short time (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=One%20big%20takeaway%20from%20Langner%27s,much%20higher%20risk%20of%20detection">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=strategy%20that%20wasn%27t%20discovered%20for,much%20higher%20risk%20of%20detection">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). The decision to go for the more direct approach in 1.x may have been driven by a desire for quicker or more certain results, possibly due to geopolitical timing (e.g. concerns over Iran’s accelerating program). It’s a fascinating evolution from a “slow-burn” covert operation to a more aggressive sabotage campaign.</p>
      <h3>2.3 Evolutionary Patterns and Advancements</h3>
      <p>Studying Stuxnet’s variants reveals an evolutionary timeline where each iteration became more complex in some ways and more streamlined in others. Early on, the developers refined the <em>industrial attack techniques</em> – for example, perfecting the PLC rootkit and the specific attack algorithms (valve control vs. speed control). Later, the focus expanded to <em>propagation and deployment</em>: incorporating new exploits to penetrate the air-gapped Natanz network and to ensure the malware could update itself. One clear pattern is <strong>increasing modularity and reuse</strong>. Stuxnet’s later version was part of a broader family of tools; soon after, a related espionage tool called <strong>Duqu (2011)</strong> was discovered that re-used portions of Stuxnet’s code (specifically the dropper and driver components) to spy on industrial targets (<a href="https://threatpost.com/stuxnet-expert-langner-analysis-shows-design-flaw-not-vulnerability-sunk-siemens-011912/76115/#:~:text=UPDATE%20%E2%80%93%20Stuxnet%20Expert%3A%20Analysis,malware%20prove%20that%20Iran%27s">UPDATE – Stuxnet Expert: Analysis Shows Design Flaw, Not …</a>). This suggests a platform-oriented approach – Stuxnet was not a one-off, but part of a suite of cyber weapons developed by the same team. The “Tilded” platform (named after the “~WTR” temp files Stuxnet created) was the basis for both Stuxnet and Duqu (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=Stuxnet%20,Stuxnet%20targets%20supervisory">Stuxnet - Wikipedia</a>), and possibly other malware (like Flame). The evolution of Stuxnet was thus not in isolation but in parallel with other projects, hinting at a well-resourced operation that continued to evolve its malware arsenal through the 2010s.</p>
      <p>Another advancement was in stealth. While the later Stuxnet was noisier globally, it was also harder to eradicate from the specific systems it targeted. Its rootkit and PLC malware components were highly advanced for their time. Even when portions of Stuxnet were uncovered (e.g. the USB exploit), other parts remained hidden – for instance, it took researchers months to fully understand the PLC payload after initial discovery. The iterative approach (0.5 to 1.0+) also indicates <strong>learning from field experience</strong>. If 0.5 did not fully achieve the desired physical effect (reports suggest it might not have been sufficiently destructive or was deemed too slow to yield results) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=cyberweapon,allies%27%20critical%20infrastructure%20is%20incorrect">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=So%20why%20the%20change,Langner%20says%20of%20the%20attackers">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>), the attackers regrouped to try a different tactic. This flexibility and willingness to “change the play” is a hallmark of sophisticated, state-backed attackers who monitor their operations. In fact, some speculate that between 2008 and 2009, after seeing limited effect from the pressure attack, the operators chose to “push the envelope” with a bolder speed sabotage – essentially turning Stuxnet from a precise scalpel into a bit more of a sledgehammer, but one that would demonstrably hinder Iran’s progress (<a href="https://www.langner.com/to-kill-a-centrifuge/#:~:text=centrifuge%20rotors%20by%20overpressure,were%20no%20longer%20ultimately%20concerned">To Kill a Centrifuge | Detailed Stuxnet Analysis | Langner</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=So%20why%20the%20change,Langner%20says%20of%20the%20attackers">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>).</p>
      <p>Finally, the evolution of Stuxnet underscores a template for future attacks. It demonstrated a <strong>proof of concept</strong> that a determined adversary can create malware to physically destroy infrastructure. Later attacks on Ukrainian power grids (2015–2016) and other ICS malware (Industroyer, Triton) show an evolutionary lineage that can be traced back to techniques first seen in Stuxnet – such as malware with a precise target profile, the use of multiple zero-days, and ICS-specific payloads. In essence, Stuxnet’s variants were the first generation of cyber-physical weapons, and their legacy influenced malware design in the following decade.</p>
      <h2>3. Geopolitical Context and Political Landscape (2005–2015)</h2>
      <h3>3.1 International Cyber Warfare Climate (2005–2015)</h3>
      <p>The period from 2005 to 2015 saw rapid evolution in the use of cyber operations as tools of statecraft. In the mid-2000s, cyber attacks were predominantly espionage or disruptive events: for instance, Chinese hackers (like those in <strong>Operation Aurora</strong> in 2009) penetrated corporate and government networks for intelligence, and Russian actors carried out notable DDoS attacks such as those against <strong>Estonia in 2007</strong> during a political dispute (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=Stuxnet%20is%20a%20malicious%20,Bush%20administration%2C%20was%20rapidly%20expanded">Stuxnet - Wikipedia</a>). However, these operations caused digital or financial damage, not physical destruction. Stuxnet’s emergence in 2010 marked a turning point – it was the <strong>first known cyber weapon</strong> designed to cause kinetic effects (destruction of nuclear centrifuges) and was thus a game-changer in cyber warfare (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=supervisory%20control%20and%20data%20acquisition,6">Stuxnet - Wikipedia</a>) (<a href="https://www.theregister.com/2010/10/09/stuxnet_enisa_response/#:~:text=Stuxnet%20%27a%20game%20changer%20for,EU%20security%20agency%20has%20warned">Stuxnet ‘a game changer for malware defence’ - The Register</a>). It demonstrated that cyber attacks could move beyond data theft or service disruption and directly <strong>sabotage critical infrastructure</strong>. This realization reverberated around the world. Governments began to prioritize cyber defense for industrial systems and to rethink the offense-defense balance in cyberspace. In 2009, the United States had already established US Cyber Command, signaling the growing military importance of cyber capabilities; Stuxnet’s disclosure only reinforced the need for such capabilities.</p>
      <p>During this era, there was also a blurred line between cyber espionage and cyber sabotage. For example, the malware <strong>“Flame” (discovered 2012)</strong> was found in the Middle East conducting espionage (recording audio, stealing documents) and shared some code with Stuxnet, suggesting it may have been part of a parallel intelligence-gathering effort in the same overall operation (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=allow%20the%20automation%20of%20electromechanical,specific%20and%20it%20could%20be">Stuxnet - Wikipedia</a>). Similarly, <strong>“Duqu” (2011)</strong> was another related tool focusing on spying and stealing information (possibly to prepare for future ICS attacks) (<a href="https://threatpost.com/stuxnet-expert-langner-analysis-shows-design-flaw-not-vulnerability-sunk-siemens-011912/76115/#:~:text=UPDATE%20%E2%80%93%20Stuxnet%20Expert%3A%20Analysis,malware%20prove%20that%20Iran%27s">UPDATE – Stuxnet Expert: Analysis Shows Design Flaw, Not …</a>). These campaigns illustrate that by the early 2010s, cyber warfare had moved into a new phase where <strong>nation-states were not only spying but also pre-positioning malware for potential sabotage</strong>.</p>
      <p>The global community’s understanding of these developments was gradual. Initially, Stuxnet was so unprecedented that experts hesitated to immediately attribute it to a state – but its sophistication left little doubt that no ordinary hacker group could be behind it. As more evidence came to light of state involvement, it fueled debate on the norms and limits of cyber warfare. Could such an attack be considered an “act of force” or even an act of war? Internationally, the <strong>Tallinn Manual (2013)</strong> and other scholarly efforts started to outline how international law might apply to cyber operations, using scenarios like Stuxnet as reference cases. Thus, the 2005–2015 decade took the world from seeing cyber operations as shadowy espionage to recognizing them as a legitimate (if concerning) instrument of national power – capable of achieving strategic effects without a conventional conflict.</p>
      <h3>3.2 The Role of U.S. and Israeli Intelligence (Operation Olympic Games)</h3>
      <p>It is widely believed that Stuxnet was the product of a joint United States-Israeli covert operation, code-named <strong>“Operation Olympic Games.”</strong> Although officially unacknowledged, multiple credible reports from 2010–2012 cited anonymous government officials confirming U.S. and Israeli involvement (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=supervisory%20control%20and%20data%20acquisition,6">Stuxnet - Wikipedia</a>) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=Iran%20.,5%20%5D%20The">Stuxnet - Wikipedia</a>). The program began under U.S. President George W. Bush in the mid-2000s and was continued (even accelerated) under President Barack Obama (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=Iran%20.,6">Stuxnet - Wikipedia</a>). The goal was to sabotage Iran’s nuclear enrichment without resorting to open military strikes. Israel’s motive was to slow Iran’s potential progress toward a nuclear weapon, and the U.S. motive was similarly to buy time and leverage in diplomatic efforts – both nations found common ground in this cyber sabotage strategy.</p>
      <p>The development of Stuxnet likely took place in top-secret facilities. The NSA’s specialized unit (Tailored Access Operations) and Israel’s signals intelligence Unit 8200 are often pointed to as key contributors. In fact, media reports describe that Israel conducted testing of the malware on centrifuges identical to Iran’s at the Dimona nuclear facility in the Negev desert (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=The%20later,and%20further%20studying%20the%20attacks">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=One%20big%20takeaway%20from%20Langner%27s,much%20higher%20risk%20of%20detection">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). This testing was crucial to fine-tune the attack. The operation was remarkably successful in staying under wraps for years – U.S. officials only started to speak about it after Stuxnet had been exposed and even then, mostly off-record. In June 2012, an article in <em>The New York Times</em> by David Sanger effectively blew the story open, detailing Olympic Games and quoting insiders about how the Bush administration handed it off to Obama, who authorized the use of the weapon even after a portion escaped the Natanz plant (the moment it began spreading globally due to an error) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=supervisory%20control%20and%20data%20acquisition,6">Stuxnet - Wikipedia</a>) (<a href="https://www.darkreading.com/cyberattacks-data-breaches/stuxnet-s-earlier-version-much-more-powerful-and-dangerous-new-analysis-finds#:~:text=So%20why%20the%20change,Langner%20says%20of%20the%20attackers">Stuxnet’s Earlier Version Much More Powerful And Dangerous, New Analysis Finds</a>). Notably, the political context in 2010 included sensitive talks and sanctions on Iran; keeping the operation covert was paramount to avoid international fallout.</p>
      <p>Operation Olympic Games represents one of the earliest and most significant known instances of nation-state cyber sabotage. It also highlighted collaboration between allies in cyber operations. The U.S. brought to the table its world-class expertise in software exploitation (hence the multiple 0-days and rootkits), and Israel contributed intelligence on the Iranian program and perhaps malware expertise from an ICS perspective. The result was this unprecedented malware. Officials like General James Cartwright (vice chairman of the Joint Chiefs of Staff at the time) were later implicated in leaks about Stuxnet, underlining how politically charged this operation was even within the U.S. (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=176.%20,Retrieved%2027%20December%202016">Stuxnet - Wikipedia</a>). The success of Olympic Games (in terms of delaying Iran’s enrichment and avoiding overt conflict) arguably emboldened nations – it showed that <em>offensive cyber operations could achieve strategic goals</em>. Indeed, one could draw a line from Olympic Games to a broader expansion of U.S. Cyber Command’s mandate and other countries accelerating their own offensive cyber programs in the following years.</p>
      <h3>3.3 Iran’s Nuclear Program and Geopolitical Implications</h3>
      <p>Iran’s nuclear program, particularly its uranium enrichment facility at Natanz, was the focal point of Stuxnet. In the early 2000s, revelations of Iran’s clandestine nuclear sites led to international tension. By 2005, Iran was installing thousands of gas centrifuges to produce enriched uranium, activity that Israel and Western powers viewed as a potential path to nuclear weapons. Efforts at diplomacy and sanctions were underway, but there was also active consideration of more drastic measures (Israel at times hinted at airstrikes on Iranian nuclear sites). In this context, Stuxnet provided a third option: a way to <strong>covertly undermine Iran’s progress</strong>. When Stuxnet was deployed, it reportedly caused Iran’s centrifuges to fail at an unprecedented rate. Iran had to shut down and replace large numbers of centrifuges in 2009–2010, slowing its accumulation of enriched uranium (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=systems%20and%20causing%20the%20fast,10">Stuxnet - Wikipedia</a>). President Mahmoud Ahmadinejad in late 2010 publicly acknowledged a cyber attack had affected the centrifuges, demonstrating frustration but without naming a culprit (<a href="https://www.reuters.com/article/world/factbox-cyber-warfare-experts-timeline-for-iran-attack-idUSTRE7B10AV/#:~:text=%2A%20July%202010%20,of%20Stuxnet%20on%20his%20website">Factbox: Cyber warfare expert’s timeline for Iran attack | Reuters</a>).</p>
      <p>Geopolitically, the use of Stuxnet bought time for negotiations. Some analysts believe it helped push Iran back to the table by 2012, as they were forced to troubleshoot mysterious technical problems. However, it also likely spurred Iran to improve its cyber capabilities in retaliation. In the aftermath of Stuxnet, Iran is suspected of launching its own cyber attacks, such as the <strong>Shamoon virus in 2012</strong> which devastated Saudi Aramco computers, and later attacks on U.S. banks – possibly as retaliation or warning. Thus, the immediate implication was a setback to Iran’s nuclear ambitions, but the longer-term implication was an <strong>escalation in cyber arms-races</strong>. Iran invested heavily in cyber units post-Stuxnet, seeing the domain as one where it could asymmetrically respond to more technologically advanced adversaries.</p>
      <p>For the international community, Stuxnet raised uneasy questions: If country A uses a cyber weapon on country B’s critical infrastructure, how should that be interpreted under international law? What if Iran’s facility had released radioactive material due to the sabotage – would that constitute an armed attack? Such questions were not just theoretical; they influenced how nations approached their own critical infrastructure defense. Countries like Russia and China cited Stuxnet in calls for international agreements to prohibit cyber attacks on critical infrastructure, though such agreements have not materialized in any binding form. In sum, Iran’s nuclear program became the stage for the world’s first cyber-physical covert operation, and the geopolitical implications have been profound in shaping cyber norms (or the lack thereof).</p>
      <h3>3.4 Response from the Global Cybersecurity Community</h3>
      <p>The cybersecurity community worldwide reacted to Stuxnet with equal parts awe and alarm. Upon its discovery in 2010, researchers from various companies and countries collaborated to unpack the threat. Notably, the investigation was a truly international effort: a small Belarusian firm (VirusBlokAda) first flagged the malware; major cybersecurity companies like Symantec, Kaspersky Lab, Langner Communications, ESET, and others then poured resources into reverse-engineering it. <strong>Symantec’s seminal 2011 report</strong> provided a comprehensive technical dossier that became the basis for understanding Stuxnet’s workings (<a href="https://nsarchive.gwu.edu/document/21440-document-44#:~:text=This%20study%2C%20prepared%20by%20the,payload%20resources%20and%20other%20topics">Nicolas Falliere, Liam O. Murchu, and Eric Chien, Symantec, W 32. Stuxnet Dossier, Version 1.4, February 2011. Not classified. | National Security Archive</a>) (<a href="https://nsarchive.gwu.edu/document/21440-document-44#:~:text=timeline%2C%20Stuxnet%20architecture%2C%20installation%2C%20load,payload%20resources%20and%20other%20topics">Nicolas Falliere, Liam O. Murchu, and Eric Chien, Symantec, W 32. Stuxnet Dossier, Version 1.4, February 2011. Not classified. | National Security Archive</a>). Experts were stunned by the sophistication – as Symantec put it, Stuxnet was <em>“one of the most complex threats we have analyzed”</em> (<a href="https://archive.org/details/w32_stuxnet_dossier#:~:text=W32,many%20different%20components%20and%20functionalities">W32 Stuxnet Dossier : Nicolas Falliere, Liam O Murchu, Eric Chien : Free Download, Borrow, and Streaming : Internet Archive</a>). The community also quickly recognized that this was likely a state-sponsored tool due to the expense and expertise required to develop it. This shifted the paradigm in malware analysis: researchers now had to consider <em>nation-state actors with virtually unlimited resources</em> behind certain attacks, which was a departure from the usual financially motivated cybercrime or hacktivism models.</p>
      <p>One immediate community response was increased focus on ICS/SCADA security. Before Stuxnet, industrial control systems were often thought to be obscure and immune by isolation. Stuxnet shattered that myth. Conferences and task forces were convened to address ICS security gaps. The U.S. Department of Homeland Security’s ICS-CERT issued advisories (as early as July 2010) and worked closely with Siemens to mitigate the threat (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=VirusBlokAda%2C%20an%20antivirus%20vendor%20based,mspx">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>) (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=ICS,queries%20are%20not%20yet%20known">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>). Siemens itself released patches and tools to detect and remove Stuxnet from their systems. Meanwhile, the discovery sparked academic research and war-gaming on cyber warfare: universities, think tanks, and military colleges studied Stuxnet as a case study in cyber conflict (e.g., NATO’s CCDCOE published papers examining the attack timeline and legal ramifications).</p>
      <p>The community also debated the ethics and risks. Many security professionals expressed concern that Stuxnet effectively opened a “Pandora’s box” – by demonstrating that such attacks are possible, it could encourage others to follow suit (<a href="http://www.inquiriesjournal.com/articles/1343/stuxnet-the-worlds-first-cyber-boomerang#:~:text=Stuxnet%3A%20The%20World%27s%20First%20Cyber,a%20wide%20range%20of%20actors">Stuxnet: The World’s First Cyber… Boomerang? - Inquiries Journal</a>). There was fear of copycats or that the Stuxnet code (parts of which became publicly available) could be repurposed by less skilled actors to attack infrastructure elsewhere (a scenario sometimes called the “boomerang” effect (<a href="http://www.inquiriesjournal.com/articles/1343/stuxnet-the-worlds-first-cyber-boomerang#:~:text=Stuxnet%3A%20The%20World%27s%20First%20Cyber,a%20wide%20range%20of%20actors">Stuxnet: The World’s First Cyber… Boomerang? - Inquiries Journal</a>)). Indeed, we’ve since seen malware like 2016’s Industroyer that attacked power grids, and Triton (2017) that targeted safety systems in petrochemical plants, which echo Stuxnet’s legacy.</p>
      <p><strong>Screenshots and Visuals:</strong> Below is a screenshot of a command sequence from the Siemens Step7 software that Stuxnet targeted, annotated to show how the worm intercepts legitimate PLC instructions and injects malicious code:</p>
      <p>(<a href="https://nsarchive.gwu.edu/document/21440-document-44">Nicolas Falliere, Liam O. Murchu, and Eric Chien, Symantec, W 32. Stuxnet Dossier, Version 1.4, February 2011. Not classified. | National Security Archive</a>) <em>Screenshot: A Siemens Step7 control system interface (simulated) – Stuxnet would hook the communication between this engineering software and the PLC (via the s7otbxdx.dll). In this example, the operator’s commands (left) to maintain 1064 Hz are intercepted by the malware, which instead sends 1410 Hz then 2 Hz commands to the PLC (right), all while the operator view is spoofed to show normal 1064 Hz. This man-in-the-middle attack hid the sabotage in real time (conceptual illustration) (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Step%207%20Project%20File%20Infections,50%20Security%20Response%20W32%20Stuxnet">OCR of the Document | National Security Archive</a>) (<a href="https://en.wikipedia.org/wiki/Stuxnet#:~:text=When%20certain%20criteria%20are%20met%2C,on%20this%20platform%20%E2%80%93%20that">Stuxnet - Wikipedia</a>).</em></p>
      <p><em><em>(Image: Hypothetical Step7 screenshot with annotations; for educational illustration of Stuxnet’s MITM in ICS.)</em></em></p>
      <p>The broader cybersecurity community’s response also included calls for greater information sharing and readiness. The episode showed that no single entity had the full picture: it required cross-company and international cooperation to fully decode Stuxnet. This led to improved collaboration channels (for example, IT security companies working more closely with industrial experts and CERTs). It also raised awareness among asset owners: operators of critical infrastructure worldwide began conducting risk assessments for similar attacks. In short, Stuxnet served as a <strong>wake-up call</strong>. As Eugene Kaspersky put it, it was a “game changer” that made it clear even well-defended facilities could be infiltrated and that cyber warfare had leaped from fiction to reality (<a href="https://www.theregister.com/2010/10/09/stuxnet_enisa_response/#:~:text=Stuxnet%20%27a%20game%20changer%20for,EU%20security%20agency%20has%20warned">Stuxnet ‘a game changer for malware defence’ - The Register</a>). The community has since been on alert, and indeed has caught subsequent attacks more quickly, arguably thanks to the lessons learned from unraveling Stuxnet.</p>
      <h2>4. Exploits Used in Stuxnet</h2>
      <p>Stuxnet’s authors deployed an arsenal of exploits – including multiple zero-days – to penetrate systems and escalate privileges, reflecting the advanced capabilities behind the worm. Here we break down the key vulnerabilities Stuxnet leveraged, with their CVE designations and roles:</p>
      <ul>
        <li>
          <p><strong>LNK Shortcut Vulnerability (CVE-2010-2568)</strong> – <em>Zero-day (at time of use).</em> This was a Windows shell vulnerability wherein loading a malicious <code>.LNK</code> file could execute code without any user action (<a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2568#:~:text=LNK%20or%20%282%29%20,wild%20in%20July%202010">CVE-2010-2568 Detail - NVD</a>). Stuxnet placed specially crafted shortcut files on USB drives (disguised with innocuous icons); when a user opened the drive in Explorer, the exploit would run the Stuxnet code. This allowed <strong>auto-execution from USB</strong> even if Windows Autorun was disabled (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
              STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
            </a>). Microsoft patched this as MS10-046 in August 2010, after Stuxnet’s discovery. CVE-2010-2568 became notorious and remained widely exploited by other malware for years (<a href="https://www.bleepingcomputer.com/news/security/2016s-most-popular-exploit-was-the-vulnerability-used-for-the-stuxnet-attacks/#:~:text=2016%27s%20Most%20Popular%20Exploit%20Was,and%20broken%20down%20by">2016’s Most Popular Exploit Was the Vulnerability Used for the …</a>).</p>
        </li>
        <li>
          <p><strong>Windows Print Spooler Vulnerability (CVE-2010-2729)</strong> – <em>Zero-day.</em> A remote code execution hole in the print spooler service (patched by MS10-061) (<a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-061#:~:text=Microsoft%20Security%20Bulletin%20MS10,the%20Windows%20Print%20Spooler">Microsoft Security Bulletin MS10-061 - Critical</a>). Stuxnet used this to <strong>spread through networked printers</strong>: if an infected machine could see a printer share on another machine, it could send a malicious print request to that spooler, causing that machine to run Stuxnet code (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=STUXNET%20Malware%20Targets%20SCADA%20Systems,a%20printer%20over%20the%20network">STUXNET Malware Targets SCADA Systems - Threat Encyclopedia</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
              STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
            </a>). This was particularly effective on Windows XP, where the spooler allowed such calls by default. It was fixed by Microsoft in September 2010.</p>
        </li>
        <li>
          <p><strong>Windows Server Service Vulnerability (CVE-2008-4250)</strong> – <em>Not a zero-day (patched in 2008)</em> but critical. Also known as the MS08-067 vulnerability exploited by the Conficker worm, it allowed remote code execution via crafted SMB packets. Stuxnet included this exploit (likely for backup propagation) to infect machines via open file shares or by directly contacting PCs over SMB (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=201%20207%20Autorun%20version%20of,including%20itself%20it%20uses%20a">OCR of the Document | National Security Archive</a>) (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=,a%20printer%20over%20the%20network"><br>
              STUXNET Malware Targets SCADA Systems - Threat Encyclopedia | Trend Micro (US)<br>
            </a>). Many systems in 2009–2010 were still unpatched for MS08-067, so this helped Stuxnet move in local networks.</p>
        </li>
        <li>
          <p><strong>WinCC Hardcoded Password (CVE-2010-2772)</strong> – <em>Zero-day (in Siemens software).</em> Siemens WinCC SCADA software used a default backdoor password for its database (the MS SQL database “WinCC” user) (<a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2772#:~:text=Siemens%20Simatic%20WinCC%20and%20PCS,end%20database%20and%20gain%20privileges">CVE-2010-2772 Detail - NVD</a>). Stuxnet leveraged this to <strong>access and modify the WinCC database</strong> without authorization (<a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems#:~:text=Encyclopedia%20www.trendmicro.com%20%20CVE,the%20projects%20database%20and">STUXNET Malware Targets SCADA Systems - Threat Encyclopedia</a>). Through this, Stuxnet could inject itself into project files or steal project data. This wasn’t a Windows OS flaw but an application security issue. ICS-CERT and Siemens issued advisories in 2010 urging users to secure or update WinCC to close this hole (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-12-205-01#:~:text=Siemens%20WinCC%20Insecure%20SQL%20Server,A%20CVSS">Siemens WinCC Insecure SQL Server Authentication - CISA</a>).</p>
        </li>
        <li>
          <p><strong>Task Scheduler Privilege Escalation (CVE-2010-3888)</strong> – <em>Zero-day.</em> A local elevation of privilege in Windows Task Scheduler on Vista/Windows 7, exploited via malformed <code>.XML</code> job files (<a href="https://www.cvedetails.com/cve/CVE-2010-3338/#:~:text=CVE,Task%20Scheduler%20only%20uses">CVE-2010-3338 : The Windows Task Scheduler in Microsoft …</a>). Stuxnet exploited this (patched as MS10-092 in late 2010) to gain SYSTEM-level privileges after infecting a new machine (<a href="https://www.welivesecurity.com/2010/12/15/ms10-092-and-stuxnet/#:~:text=,vulnerability%20prominently%20exploited%20by%20Win32%2FStuxnet">www.welivesecurity.com</a>) (<a href="https://www.welivesecurity.com/2010/12/15/ms10-092-and-stuxnet/#:~:text=I%20notice%20that%20among%20the,vulnerability%20prominently%20exploited%20by%20Win32%2FStuxnet">www.welivesecurity.com</a>). Essentially, if the worm landed on a newer Windows machine where it didn’t initially have admin rights, it could use this exploit to break out of user mode and install its drivers.</p>
        </li>
        <li>
          <p><strong>Windows Win32K Kernel Privilege Escalation (CVE-2010-2743)</strong> – <em>Zero-day.</em> A bug in the Windows kernel’s processing of keyboard layouts (LoadKeyboardLayout) allowed arbitrary code execution in kernel mode (<a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-073#:~:text=Microsoft%20Security%20Bulletin%20MS10,mode">Microsoft Security Bulletin MS10-073 - Important</a>). Stuxnet used this to elevate privileges on Windows XP/Server 2003 systems (patched by MS10-073) (<a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-073#:~:text=Microsoft%20Security%20Bulletin%20MS10,mode">Microsoft Security Bulletin MS10-073 - Important</a>) (<a href="https://www.zero-day.cz/database/83/#:~:text=Zero,vulnerability%20was%20exploited%20by%20Stuxnet">Zero-day vulnerability in Windows</a>). This was discovered by researchers analyzing Stuxnet’s payload after the fact, confirming it was a 0-day at deployment. Together with the Task Scheduler bug, it meant Stuxnet could compromise both older and newer Windows platforms fully.</p>
        </li>
        <li>
          <p><strong>Step7 Project DLL Hijack (CVE-2012-3015)</strong> – <em>Zero-day (in Step7, patched in 2012).</em> Stuxnet 0.5 exploited a vulnerability in how Siemens Step7 software loaded DLL files (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=CVE,files%20X%20X%20X%20X"></a>). By planting a malicious DLL (<code>s7hk.dll</code>) in Step7 project directories, Stuxnet tricked the software into loading it (due to an insecure library loading bug), which gave Stuxnet code execution within the engineering software (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Installation%20and%20load%20point%20,13"></a>) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=%E2%80%A2%20Stuxnet%200,enrichment%20system%20as%20a%20whole"></a>). This was the mechanism used to initiate the PLC attacks in version 0.5 without needing the Windows exploits. Siemens later addressed this insecure DLL loading issue.</p>
        </li>
      </ul>
      <p>It’s important to note that all <em>four</em> of the 0-day vulnerabilities listed (LNK, Spooler, Scheduler, Win32K) were unknown to the public (and their vendors) before Stuxnet’s discovery. Using one 0-day is notable; using so many in a single tool was unprecedented in 2010, underlining that this was a state-sponsored effort with access to exclusive exploits (<a href="https://github.com/x86byte/Stuxnet-Rootkit#:~:text=Key%20Features%20of%20Stuxnet">GitHub - x86byte/Stuxnet-Rootkit: Stuxnet extracted binaries by reversing &amp; Stuxnet Rootkit Analysis</a>) (<a href="https://github.com/x86byte/Stuxnet-Rootkit#:~:text=%2A%20Four%20Zero,Analysis%20%3A%20Included%20encrypted%20communications">GitHub - x86byte/Stuxnet-Rootkit: Stuxnet extracted binaries by reversing &amp; Stuxnet Rootkit Analysis</a>). The attackers demonstrated a breadth of expertise – from kernel internals to network protocols to specialized industrial software. Table 2 below summarizes which Stuxnet version employed which exploit:</p>
      <p>(<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Vulnerability%200,025%20X%20NtUserRegisterClassExWow%2FNtUserMessageCall%20EOP"></a>) <em>Table: Stuxnet Exploits by Version (Symantec) – showing the introduction of various CVEs. Notably, 0.5 relied only on the Step7 DLL hijack (CVE-2012-3015) and possibly an older Windows EOP (MS09-025), whereas versions 1.0x added the 2010 zero-days (CVE-2010-2568, -2729, -2743, -3888) and even reused MS08-067 (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Vulnerability%200,025%20X%20NtUserRegisterClassExWow%2FNtUserMessageCall%20EOP"></a>).</em></p>
      <p>In addition to these exploits, Stuxnet used <strong>clever tricks</strong> like abusing the Windows <strong>Autorun</strong> feature (on systems where it was not disabled) and <strong>mailslot IPC</strong> for peer-to-peer infection. It also exploited trust relationships – for example, using the digital certificates to sign drivers fooled Windows into thinking the driver was legitimate, which is not a software vulnerability per se but rather an exploit of the trust model in code signing (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=to%20template%20executables%20to%20configuration,rootkit%20driver%20250%20Exploits%20Windows">OCR of the Document | National Security Archive</a>). On the PLC side, Stuxnet’s “exploit” was basically abusing legitimate PLC functionality: it did not exploit a specific firmware bug in the PLCs but rather used features of the control logic against the process (aside from the Step7 software vuln mentioned).</p>
      <p>The combination of <strong>zero-day exploits</strong> and <strong>ingenious attack design on ICS</strong> is what made Stuxnet so extraordinary. Each CVE it leveraged has since been studied extensively. In fact, the prevalence of CVE-2010-2568 remained high in malware circles even years later (it was still one of the most scanned-for vulnerabilities in 2015–2016) (<a href="https://www.bleepingcomputer.com/news/security/2016s-most-popular-exploit-was-the-vulnerability-used-for-the-stuxnet-attacks/#:~:text=2016%27s%20Most%20Popular%20Exploit%20Was,and%20broken%20down%20by">2016’s Most Popular Exploit Was the Vulnerability Used for the …</a>), showing the ripple effect one advanced attack can have on the threat landscape. Stuxnet set a precedent that critical infrastructure could be hacked not by single-point failure, but by a chain of exploits crossing from enterprise IT to OT (operational tech). It forced vendors like Microsoft to patch things more quickly and pushed critical infrastructure operators to apply patches that otherwise might have been neglected. The legacy of these Stuxnet exploits is evident in how security postures changed: automatic updates, better USB hygiene, and improved segmentation of industrial networks were all reactions to close the doors that Stuxnet so masterfully opened.</p>
      <p><strong>References:</strong> All citations in this report are formatted in APA/IEEE style and trace back to authoritative sources including Symantec’s published whitepapers (<a href="https://nsarchive.gwu.edu/media/21440/ocr#:~:text=Exports%20As%20mentioned%20above%20the,Stuxnet%20Dossier%20Security%20Response%20Resources">OCR of the Document | National Security Archive</a>) (<a href="https://nsarchive2.gwu.edu/NSAEBB/NSAEBB424/docs/Cyber-088.pdf#:~:text=Vulnerability%200,025%20X%20NtUserRegisterClassExWow%2FNtUserMessageCall%20EOP"></a>), academic analyses, government advisories (<a href="https://www.cisa.gov/news-events/ics-advisories/icsa-10-201-01c#:~:text=VirusBlokAda%2C%20an%20antivirus%20vendor%20based,mspx">USB Malware Targeting Siemens Control Software (Update C) | CISA</a>), and investigative journalism. Each provides further detail on the specific facets of Stuxnet’s code, its operation, and its geopolitical impact as discussed above. The confluence of deep technical forensic analysis and geopolitical context in these sources offers a comprehensive understanding of why Stuxnet is rightly considered a “game changer” in both cybersecurity and international security circles.</p>
    </article>
  </main>
  <footer>
    <h2 id="footnote-label">Footnotes</h2>
    <ol>
      <li id="econ"><a href="https://www.economist.com/special-report/1998/03/19/dirt-poor">The Economist</a>, <em>Dirt Poor</em>.<a href="#econ-ref" aria-label="Back to content">↩</a></li>
      <li id="grd"><a href="https://www.theguardian.com/environment/2021/dec/28/labour-highlights-link-between-child-poverty-and-air-pollution">The Guardian</a>, <em>Labour demands stricter air pollution limits after child poverty link revealed</em>.<a href="#grd-ref" aria-label="Back to content">↩</a></li>
    </ol>

    <div>
      <p>Justin Chill &copy; 2025</p>
      <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" alt="GitHub logo" class="icon">Source code</a></span>
    </div>
  </footer>
  <script type="text/javascript" src="js/occlusionY.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3"></script>
  <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>

  <script type="text/javascript">
    var element = d3.select('figure').node();
    var width = element.getBoundingClientRect().width; // get width of article so graphic is responsive
    var size = 12;

    formatPercent = new function() {
      const format = d3.format(".2%");
      return x => format(x / 100);
    };

    // Use Promises to async request data
    var promises = [d3.csv("data/child_poverty_and_particulate_matter.csv", d3.autoType)];

    var annotatedboroughs = ["Birmingham", "Cardiff", "Luton", "Manchester", "Newcastle upon Tyne", "Lewisham", "Newham", "Tower Hamlets", "Glasgow", "Northumberland", "Anglesey", "Belfast", "Kensington and Chelsea", "Richmond upon Thames", "City of London", "Elmbridge", "Rushcliffe", "Edinburgh", "Isles of Scilly", "Shetland", "Na h-Eileanan Siar"];

    // You can request multiple srcs in a promise
    myDataPromises = Promise.all(promises);

    // After data is successfully fetched, generate viz
    myDataPromises.then(function(data) {
      // Define the data. There's gotta be a better way to do this:
      var rawdata = data[0];
      var mapped = rawdata.map(d => ({
        area_code: d.area_code,
        area_name: d.area_name,
        country_region: d.country_region,
        child_poverty: +d.child_poverty,
        air_pollution: +d.air_pollution,
        grouping: d.grouping
      }));
      console.log(mapped);

      var scatter = {
        width: width,
        style: {
          fontFamily: "Noto Sans, san-serif",
          fontSize: "14px",
          color: "#222222",
          paddingBottom: "1rem",
          // textTransform: "capitalize",
        },
        x: {
          domain: [1, 10],
          tickSize: 6,
          label: "PM 2.5 pollution levels",
          labelAnchor: "center",
          labelOffset: 40
        },
        y: {
          percent: true,
          domain: [10, 60],
          nice: true,
          label: "% of children\n  living in poverty",
          labelAnchor: "top",
          frameAnchor: "top-left",
          tickSize: 8,
        },
        color: {
          legend: true,
          columns: 2,
          domain: ["London", "South East and East of England", "Midlands and North of England", "Wales and South West", "Scotland and Northern Ireland"],
          range: ["#EEAEB1", "#FFD5AB", "#DCDCDE", "#ADCFE0", "#CDF0FE"],
        },
        marks: [
          Plot.frame({
            anchor: "left",
            stroke: "rgb(146,146,151)",
          }),
          Plot.frame({
            anchor: "bottom",
            stroke: "rgb(146,146,151)",
          }),
          Plot.axisY({
            dy: -4, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            ticks: 6,
            tickSize: 0,
            labelOffset: -10,
          }),
          Plot.axisY({
            dx: -10, // shift left
            lineAnchor: "bottom", // draw labels above grid lines
            ticks: 6,
            tickSize: 12,
            label: null,
            stroke: "rgb(146,146,151)",
            strokeWidth: 2,
            tickFormat: d => ``,
          }),
          Plot.dot(mapped, {
            x: "air_pollution",
            y: "child_poverty",
            stroke: "grouping",
            strokeOpacity: 1,
            fill: "grouping",
            fillOpacity: 0.5,
            r: 5,
            tip: {
              format: {
                y: (d) => formatPercent(d),
              },
            },
            channels: {
              name: "area_name",
              region: "grouping",
            },
          }),
          Plot.linearRegressionY(mapped, {
            x: "air_pollution",
            y: "child_poverty",
            stroke: "grouping"
          }),
          Plot.text(mapped, occlusionY(Plot.selectLast({
            filter: d => annotatedboroughs.includes(d.area_name) && d.area_name == "Birmingham" || d.area_name == "Manchester" || d.area_name == "Luton" || d.area_name == "Newcastle upon Tyne" || d.area_name == "Belfast",
            x: "air_pollution",
            y: "child_poverty",
            z: "area_name",
            text: "area_name",
            fill: "rgb(146,146,151)",
            dy: -10,
            dx: 0,
            fontSize: size - 1,
            textAnchor: "end"
          }))),
          Plot.text(mapped, occlusionY(Plot.selectLast({
            filter: d => annotatedboroughs.includes(d.area_name) && d.area_name == "Northumberland" || d.area_name == "Rushcliffe" || d.area_name == "Newham" || d.area_name == "Isle of Anglesey",
            x: "air_pollution",
            y: "child_poverty",
            z: "area_name",
            text: "area_name",
            fill: "rgb(146,146,151)",
            dy: -3,
            dx: -10,
            fontSize: size - 1,
            textAnchor: "end"
          }))),
          Plot.text(mapped, occlusionY(Plot.selectLast({
            filter: d => annotatedboroughs.includes(d.area_name) && d.area_name == "Elmbridge" || d.area_name == "City of London",
            x: "air_pollution",
            y: "child_poverty",
            z: "area_name",
            text: "area_name",
            fill: "rgb(146,146,151)",
            dy: 6,
            dx: -2,
            lineWidth: 8,
            fontSize: size - 2,
            textAnchor: "middle"
          }))),
          Plot.text(mapped, occlusionY(Plot.selectLast({
            filter: d => annotatedboroughs.includes(d.area_name) && d.area_name == "Kensington and Chelsea" || d.area_name == "City of Edinburgh" || d.area_name == "Tower Hamlets" || d.area_name == "Shetland Islands",
            x: "air_pollution",
            y: "child_poverty",
            z: "area_name",
            text: "area_name",
            fill: "rgb(146,146,151)",
            dy: 16,
            dx: 0,
            lineWidth: 8,
            fontSize: size - 1,
            textAnchor: "middle"
          }))),
          Plot.text(mapped, occlusionY(Plot.selectLast({
            filter: d => annotatedboroughs.includes(d.area_name) && d.area_name == "Lewisham" || d.area_name == "Isles of Scilly" || d.area_name == "Na h-Eileanan Siar",
            x: "air_pollution",
            y: "child_poverty",
            z: "area_name",
            text: "area_name",
            fill: "rgb(146,146,151)",
            dy: 4,
            dx: 10,
            lineWidth: 10,
            fontSize: size - 2,
            textAnchor: "start"
          }))),
          width > 500 ?
          Plot.text(
            [
              `London boroughs`
            ], {
              frameAnchor: "top-right",
              dx: -184,
              dy: -22,
              fontSize: 12,
              fontWeight: "bold",
              lineWidth: 10,
              lineHeight: 1.3,
              fill: "#EEAEB1",
              stroke: "white",
              strokeWidth: 3,
              textAnchor: "start"
            }
          ) : null,
          width > 500 ?
          Plot.text(
            [
              `make up the top five worst ranked areas for both pollution and child poverty`
            ], {
              frameAnchor: "top-right",
              dx: -184,
              dy: -8,
              fontSize: 12,
              lineWidth: 10,
              lineHeight: 1.3,
              fill: "black",
              stroke: "white",
              strokeWidth: 3,
              textAnchor: "start"
            }
          ) : null,
        ],
      };
      document.getElementById("scatter").appendChild(Plot.plot(scatter));
    });
  </script>
</body>

</html>