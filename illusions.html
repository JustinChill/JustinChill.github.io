<!DOCTYPE html>
<html lang="en">
<head>
	<title>Optical illusions in code</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="style.css" />
	<script src="script.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Optical illusions with CSS">
	<meta name="author" content="Justin Chill">

	<style type="text/css">
		header{
			grid-column: 2 / 7;
		}
		article{
			margin-top: 0;
		}
		article>figure{
			grid-column: 4;
			margin: 0 auto;
			padding: 1rem;
		}
		.subtitle{
			text-align: center;
		}

		/* Spinning illusion, spinning pinwheel */
		.square1{
			width: 50px;
			height: 50px;
			background: #444;
			position: absolute;
			animation: spin1 4s infinite linear;
		}

		.square2{
			width: 50px;
			height: 50px;
			background: #ccc;
			/*position: absolute;*/
			animation: spin1 4s infinite linear;
		}

		.negative-space-container,
		.negative-space-container-2{
			overflow: hidden;
			/*position: absolute;*/
			width: 1000px;
			height: 500px;
		}

		.negative-space-container{
			background: #ccc;
		}

		.negative-space-container-2{
			background: #444;
			display: none;
		}

		@keyframes spin1{
			0%{
				transform: rotate(0deg);
			}

			25%{
				transform: rotate(90deg);
			}

			50%{
				transform: rotate(180deg);
			}

			75%{
				transform: rotate(270deg);
			}

			100%{
				transform: rotate(360deg);
			}
		}

		/* Penrose Triangle */
		.penrose-triangle-cutaway{
			display: none;
		}
		.penrose-triangle {
			display: block;
			width: 20rem;
			height: 20rem;
			grid-column: 2/7;
			margin: 4rem auto;
			/*padding: 2rem;*/
			position: relative;
/*			transform-origin: 13.3rem 11.5rem;
			-webkit-animation: rotate 30s linear infinite;*/
			/*animation: rotate 30s linear infinite;*/
			filter: drop-shadow(0 0 4rem rgba(0, 0, 0, 0.2));
		}
		.penrose-triangle-cutaway .side,
		.penrose-triangle .side {
			display: block;
			width: 20rem;
			height: 20rem;
			position: absolute;
			-webkit-clip-path: polygon(57% 0, 75% 0, 26% 85%, 89.5% 85%, 98.4% 100%, 0 100%);
			clip-path: polygon(57% 0, 75% 0, 26% 85%, 89.5% 85%, 98.4% 100%, 0 100%);
			transition: background-color .65s ease;
		}
		
		.penrose-triangle .side:nth-of-type(1),
		.penrose-triangle .side:nth-of-type(1) {
			top: 0;
			left: 0;
			transform: rotate(0deg);
			background-color: hsl(40, 15%, 80%);
		}
		.penrose-triangle-cutaway .side:nth-of-type(1),
		.penrose-triangle-cutaway .side:nth-of-type(1) {
			top: 0;
			left: 0;
			transform: rotate(0deg);
			background-color: hsl(40, 15%, 80%);
			background-color: white;
			border: 1px solid black;
		}

		.penrose-triangle .side:nth-of-type(2) {
			top: 18.3%;
			left: 43.3%;
			transform: rotate(120deg);
			background-color: hsl(37, 11%, 28%);
		}
		.penrose-triangle-cutaway .side:nth-of-type(2) {
			top: 18.3%;
			left: 43.3%;
			transform: rotate(120deg);
			background-color: hsl(37, 11%, 28%);
			background-color: white;
			border: 1px solid black;
		}

		.penrose-triangle .side:nth-of-type(3) {
			top: 46.5%;
			left: 5.9%;
			transform: rotate(240deg);
			background-color: hsl(42, 15%, 13%);
		}
		.penrose-triangle-cutaway .side:nth-of-type(3) {
			top: 46.5%;
			left: 5.9%;
			transform: rotate(240deg);
			background-color: hsl(42, 15%, 13%);
			opacity: 5%;
			/*background-color: white;*/
			border: 1px solid black;
		}

		/* Bars */
		#bars {
		  width: 360px;
		  margin: 1rem auto;
		  background-color: #777;
		  color: #fff;
		}

		.col {
		  box-sizing: border-box;
		  width: 30px;
		  display: inline-block;
		  margin: 0 20px 0 0;
		  filter: blur(2px);
		  -webkit-filter: blur(2px);
		}

		.col:last-child {
		  margin-right: 0;
		}

		.gabor {
		  width: 10px;
		  height: 10px;
		  border-radius: 50%;
		  margin: 6px 10px;
		  display: inline-block;
		  background: linear-gradient(90deg, #fff 0, #000 25%, #fff 50%, #000 75%, #fff 100%);
		  /*background: linear-gradient(90deg, #fff 0, #000 16.7%, #fff 33.3%, #000 50%, #fff 66.7%, #000 83.3%, #fff 100%);*/
		  background-size: 200% 200%;
		  animation: HorizontalRight .5s linear infinite;
		  /* animation-direction: alternate;*/
		}

		.gabor:nth-child(9) {
		  animation: HorizontalLeft .5s linear infinite;
		}

		.gabor:nth-child(2) {
		  animation: HorizontalRight 1s linear infinite;
		}
		.gabor:nth-child(8) {
		  animation: HorizontalLeft 1s linear infinite;
		}

		.gabor:nth-child(3) {
		  animation: HorizontalRight 1.5s linear infinite;
		}
		.gabor:nth-child(7) {
		  animation: HorizontalLeft 1.5s linear infinite;
		}

		.gabor:nth-child(4) {
		  animation: HorizontalRight 2s linear infinite;
		}
		.gabor:nth-child(6) {
		  animation: HorizontalLeft 2s linear infinite;
		}


		.gabor:nth-child(5) {
		  animation: none;
		}




		.col:nth-child(odd) .gabor:nth-child(1) {
		  animation: HorizontalLeft .5s linear infinite;
		  /*animation-direction: alternate;*/
		}
		.col:nth-child(odd) .gabor:nth-child(9) {
		  animation: HorizontalRight .5s linear infinite;
		  /*animation-direction: alternate;*/
		}

		.col:nth-child(odd) .gabor:nth-child(2) {
		  animation: HorizontalLeft 1s linear infinite;
		  /*animation-direction: alternate;*/
		}
		.col:nth-child(odd) .gabor:nth-child(8) {
		  animation: HorizontalRight 1s linear infinite;
		  /*animation-direction: alternate;*/
		}

		.col:nth-child(odd) .gabor:nth-child(3) {
		  animation: HorizontalLeft 1.5s linear infinite;
		  /*animation-direction: alternate;*/
		}
		.col:nth-child(odd) .gabor:nth-child(7) {
		  animation: HorizontalRight 1.5s linear infinite;
		  /*animation-direction: alternate;*/
		}

		.col:nth-child(odd) .gabor:nth-child(4) {
		  animation: HorizontalLeft 2s linear infinite;
		  /*animation-direction: alternate;*/
		}
		.col:nth-child(odd) .gabor:nth-child(6) {
		  animation: HorizontalRight 2s linear infinite;
		  /*animation-direction: alternate;*/
		}


		@keyframes HorizontalLeft {
		  0% {
		    background-position: 0% 50%
		  }
		  50% {
		    background-position: 100% 50%
		  }
		  100% {
		    background-position: 200% 50%
		  }
		}

		@keyframes HorizontalRight {
		  0% {
		    background-position: 200% 50%
		  }
		  50% {
		    background-position: 100% 50%
		  }
		  100% {
		    background-position: 0% 50%
		  }
		}

		/* Parallel Lines */
		.cafe-wall{
			grid-column: 1 / -1;
			width: 100%;
			margin: 2rem 0;
		}
		.row {
			width: 100%;
			height: 50px;
			background-image: linear-gradient(
				to right,
				#fff 0%,
				#fff 50%,
				hsl(42, 15%, 13%) 51%,
				hsl(42, 15%, 13%) 100%
				);
			background-size: 90px 100%;		  
			background-repeat: repeat-x;
			border-bottom: 1px solid #666;
		}
		.row:nth-child(2n) {
			background-position: 20px 0;
		}



		/* Hole */
		.hole svg {
			background:#ddd;
			transform:rotateX(68deg) rotateZ(-32deg);
		}
		div.hole {
			margin: 0 auto;
			width: 300px;
			perspective:700px;
			perspective-origin:0 10%;
		}
		canvas {
		  display: block;
		  cursor: pointer;
		}
	</style>

</head>
<body>
  <header class="Nav">
    <div class="Container">
      <a href="https://www.JustinChill.com"><h2 class="logo">Justin Chill</h2></a>
      <ul class="Nav-base allowExpand">
        <li class="developersRoot hasDropdown" data-dropdown="developers">
          <a class="rootLink"><h2 class="dark">Blog</h2></a>
        </li>
        <li class="companyRoot hasDropdown" data-dropdown="company">
          <a class="rootLink"><h2 class="dark">About</h2></a>
        </li>
      </ul>
    </div>

    <div class="Dropdown-base">
      <div class="Dropdown-bg">
        <div class="Dropdown-bg--alt"></div>
      </div>

      <div class="Dropdown-arrow"></div>

      <div class="Dropdown-container">
        <div class="Dropdown-section" data-dropdown="developers">
          <div class="Dropdown-content">
            <div class="Nav-linkGroup documentationGroup">
              <a class="Nav-link withIcon item-documentation" href="/">
                <h2 class="linkTitle linkIcon">
                Justin Chill</h2>
                <span class="linkSub">My blog, thoughts, and musings
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="20px" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                  </svg></span>
                </a>
                <div class="documentationArticles">
                  <ul>
                    <li>
                      <h4>Just in posts</h4></li>
                      <li><a href="/Anscombe.html">Anscombe's quartet</a></li>
                      <li><a href="/illusions.html">Impossible objects</a></li>
                      <li><a href="/rings.html">Spinning rings</a></li>
                    </ul>
                    <ul>
                      <li>
                        <h4>Just for fun</h4></li>
                        <li><a href="/bingo.html">Conference call bingo</a></li>
                        <li><a href="/inf-hoe-graphic.html">Inf-hoe-graphic</a></li>
                        <li><a href="/xkcd.html">Security tips</a></li>
                        <li><a href="/to-don't.html">To-don't list</a></li>
                      </ul>
                    </div>
                  </div>

                  <ul class="Nav-linkGroup linkList developersGroup">
                    <li>
                      <a class="Nav-link item-apiStatus" href="/glossary.html">
                        <h3 class="linkTitle linkIcon"><svg width="17" height="17"><path d="M1 9h2.95l3-6.5 3 12 3-5.45L16 9" fill="none" stroke="#6772e5" class="hover-strokeDark" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>Data visualization glossary</h3>
                      </a>
                    </li>
                    <li>
                      <a class="Nav-link item-apiReference" href="/UI-details.html">
                        <h3 class="linkTitle linkIcon"><svg xmlns="http://www.w3.org/2000/svg" width="17" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                        </svg>User Interface details</h3>
                      </a>
                    </li>
                    <li>
                      <a class="Nav-link item-openSource" href="/css-selectors.html">
                        <h3 class="linkTitle linkIcon"><svg width="17" height="17"><path fill="#6772E5" class="hover-fillDark" d="M8.5 17a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17zM6.987 6.078a.684.684 0 0 0-.968-.968L3.116 8.012a.684.684 0 0 0 0 .967l2.9 2.9a.684.684 0 0 0 .97-.967l-2.42-2.418 2.42-2.42zm6.996 1.95L11.08 5.123a.684.684 0 0 0-.966.968l2.418 2.42-2.418 2.417a.684.684 0 0 0 .967.967l2.904-2.902a.684.684 0 0 0 0-.966z"></path></svg>Cascading Style Sheets (CSS)</h3>
                      </a>
                    </li>
                  </ul>

                </div>
              </div>

              <div class="Dropdown-section" data-dropdown="company">
                <div class="Dropdown-content">
                  <ul class="Nav-linkGroup linkList companyGroup">
                    <li>
                      <a class="Nav-link item-about" href="javascript:void(0);">
                        <h3 class="linkTitle linkIcon"><span class="wave">👋</span> Hello there</h3>
                        <span class="linkSub">You look great today</span>
                      </a>
                    </li>
              <li>
                <a class="Nav-link item-customers" href="http://linkedin.com/in/justinrichardhill/">
                  <h3 class="linkTitle linkIcon"><svg width="17" height="17"><path fill="#87BBFD" class="hover-fillLight" d="M2 16a1 1 0 0 1-1-1V9a4 4 0 0 1 8 0v7H2zm3-9a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"></path><path fill="#6772E5" class="hover-fillDark" d="M15 16H9a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h.55a2.5 2.5 0 0 1 4.9 0H15a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1z"></path><path fill="#87BBFD" class="hover-fillLight" d="M11 12h2v4h-2v-4z"></path></svg>LinkedIn</h3>
                </a>
              </li>
              <li>
                <a class="Nav-link item-jobs" href="data/Justin Hill Resume  2021.pdf" download>
                  <h3 class="linkTitle linkIcon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" width="17" height="17"><path fill="#6772E5" class="hover-fillDark" d="M1.5 4h14c.828 0 1.5.67 1.5 1.5v8a1.5 1.5 0 0 1-1.5 1.5h-14A1.5 1.5 0 0 1 0 13.5v-8C0 4.67.67 4 1.5 4z"></path><path fill="#87BBFD" class="hover-fillLight" d="M13 15V4h2v11h-2zM2 4h2v11H2V4z"></path><path fill="#6772E5" class="hover-fillDark" d="M11.5 3.5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1V4H4v-.5A2.5 2.5 0 0 1 6.5 1h4A2.5 2.5 0 0 1 13 3.5V4h-1.5v-.5z"></path>
                    </svg>
                  Resume</h3>
                </a>
              </li>
            </ul>

            <div class="Nav-linkGroup blogGroup">
              <a class="Nav-link withIcon item-blog" href="/index.html">
                <h3 class="linkTitle linkIcon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" width="17" height="17" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                  </svg>
                Recent posts</h3>
              </a>
              <ul class="Nav-blogPosts">
                <li><a class="fresh" href="/rhcp.html"><span>RHCP tribute</span></a></li>
                <li><a href="/to-don't.html"><span>To-Don't List</span></a></li>
                <li><a href="/word-avalanches.html"><span>Word avalanches</span></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header><main role="main">
		<article>
		<figure>
			<canvas class="canvas" id="canvas-spin"></canvas>
		</figure>			

			<header>
				<h1>Optical Illusions & Impossible Objects</h1>		
				<h2 class="subtitle">100% CSS, no images</h2>
				<time date="1993-02-26"></time>
			</header>
			<p>“We do not know space. We do not see it, we do not hear it, we do not feel it. We are standing in the middle of it, we ourselves are part of it, but we know nothing about it.” 
			― M.C. Escher</p>
			<p>All of the optical illusions on this page are made using CSS and javascript code. Recreating these classical illustrations is a fun way to learn about different CSS properties and experiment. I'll do my best to walk through each illustration so you can see how simple it is.</p>

			<div class="penrose-triangle">
				<div class="side"></div>
				<div class="side"></div>
				<div class="side"></div>
			</div>
			
			<h2>Penrose Triangle</h2>
			<p>
				The Penrose triangle is a triangular impossible object. It was first created by the Swedish artist Oscar Reutersvärd in 1934. The triangle is featured prominently in the works of artist M. C. Escher, whose earlier depictions of impossible objects partly inspired it.</p>
				<p>There are two steps to recreating the Penrose triangle using CSS. First draw 3 squares, stacked on top of each other. Rotate the second square 120 degrees and the third square 240 degrees. Cut-off the space where the squares <i>don't</i> overlap.</p>
				<div class="penrose-triangle-cutaway">
					<div class="side"></div>
					<div class="side"></div>
					<div class="side"></div>
				</div>
				<h2>Gabor Bars</h2>
				<div id="bars">
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				  <div class="col">
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				    <div class="gabor"></div>
				  </div>
				</div>
				<p>This illusion exploits a core assumption the human brain makes when visually processing- that usually, all the parts of a given moving surface have a single, coherent global motion. In other words, objects move together. This illusion employs strong motion signals (the movement inside each stationary bar) that fool the brain into thinking that the whole object is moving<a href="#footnotes" aria-describedby="footnote-label" id="footnotes-ref"></a>.</p>

				<div class="cafe-wall">
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
					<div class="row"></div>
				</div>
				<h2>Café wall ☕️</h2>
				<p>This illusion is a pattern where different coloured squares in straight lines appear to form horizontal curved lines. It is called a café wall illusion because this type of artwork is often seen on café walls. </p>

				<h2>Stanley Yelnats</h2>
				<figure>
				<div class="hole">
					<svg width="300" height="300">
						<defs>
							<linearGradient id="grad5" x1="0%" y1="0%" x2="100%" y2="0%">
								<stop offset="0%" style="stop-color:rgb(70,70,70);stop-opacity:1" />
								<stop offset="100%" style="stop-color:rgb(230,230,230);stop-opacity:1" />
							</linearGradient>
						</defs>
						<g>
							<path d="M0,30 270,30 270,300 300,300 300,0 0,0Z M0,90 210,90 210,300 240,300 240,60 0,60Z M0,150 150,150 150,300 180,300 180,120 0,120Z M0,210 90,210 90,300 120,300 120,180 0,180Z M0,240 60,240 60,300 0,300Z" style="fill:black"/>
							<line x1="0" y1="100%" x2="100%" y2="0" style="stroke-width:3px; stroke:black;" />
						</g>
						<g>
							<path d="M270,30 270,300 240,300 240,60Z M210,90 210,300 180,300 180,120Z M150,150 150,300 120,300 120,180Z M90,210 90,300 60,300 60,240Z" style="fill:url(#grad5);"/>
						</g>
					</svg>
				</div>
				</figure>

				<p>The CSS rotate3d() function is used to rotate elements in a three-dimensional space. To create the illusion of a hole, above, 2 <code>path</code> elements create squares. Those squares are rotated around an axis. Specifically they are rotated around the X axis: <mark>rotateX(68deg)</mark>, and the Z axis: <mark>rotateZ(-32deg)</mark>. Because each shape </p>

				<h2>Circles</h2>
				<figure>
					<canvas class="canvas" id="canvas"></canvas>
				</figure>

			</article>
		</main>
		
		<footer>
		  <h2 id="footnote-label">Footnotes</h2>
		  <ol>
		    <li id="footnotes">This is an adaptation of a motion perception illusion by Mathew T. Harrison and Gideon P. Caplovitz from the University of Reno, Nevada, USA. Their illusion was written up in <a href="https://blogs.scientificamerican.com/illusion-chasers/a-review-of-2016-s-best-illusion-of-the-year-contest-video/">Scientific American</a> and explained in a <a href="https://youtu.be/Jri0del_6t4">YouTube</a> video.<a href="#footnotes-ref" aria-label="Back to content">↩</a></li>
		    
		  </ol>
		  <h1 class="visually-hidden">Justin Chill © 2020</h1>
		</footer>

		<script type="text/javascript">
			/*
			  Canvas fun from Johan Karlsson, 2021
			  https://twitter.com/DonKarlssonSan
			  MIT License, see Details View.
			  https://codepen.io/DonKarlssonSan/pen/VwpwQwQ
			*/
			let canvas;
			let ctx;
			let w, h;
			let min;
			let nrOfCircles;
			let angle;
			let nrOfLines;
			let speed;

			function setup() {
			  canvas = document.querySelector("#canvas");
			  ctx = canvas.getContext("2d");
			  resize();
			  reset();
			  window.addEventListener("resize", () => {
			    resize();
			  });
			  canvas.addEventListener("click", reset);
			}

			function resize() {
			  w = canvas.width = (window.innerWidth);
			  h = canvas.height = (window.innerHeight);
			  min = Math.min(w, h);
			}

			function reset(){
			  nrOfCircles = Math.round(Math.random() * 8 + 2);
			  ctx.lineWidth = min / (Math.random() * 60 + 40);
			  angle = Math.PI / Math.random() * 10;
			  nrOfLines = Math.round(Math.random() * 30 + 20);
			  speed = Math.random() * 0.03;
			}

			function draw(now) {
			  requestAnimationFrame(draw);
			  let offset = now * speed;
			  ctx.save();
			  ctx.fillStyle = "white";
			  ctx.fillRect(0, 0, w, h);
			  ctx.translate(w / 2, h / 2);
			  for(let i = 0; i < nrOfCircles; i++) {
			    ctx.rotate(angle);
			    ctx.save();
			    
			    let r1 = min * 0.45 * i / nrOfCircles;
			    let r2 = min * 0.45 * (i+1) / nrOfCircles;
			    clip(r1, r2);
			    
			    drawLines(nrOfLines, min, offset);
			    
			    ctx.restore();
			  }
			  ctx.restore();
			}

			function clip(r1, r2) {
			  let region = new Path2D();
			  region.arc(0, 0, r1, 0, Math.PI * 2);
			  region.arc(0, 0, r2, 0, Math.PI * 2);
			  ctx.clip(region, "evenodd");
			}

			function drawLines(nrOfLines, min, offset) {
			  let step = min / nrOfLines;
			  for(let j = 0; j < nrOfLines; j++) {
			    ctx.beginPath();
			    ctx.moveTo(-min / 2, - min / 2 + j * step + offset % step);
			    ctx.lineTo(min / 2, - min / 2 + j * step + offset % step) ;
			    ctx.stroke();
			  }
			}

			setup();
			draw(performance.now());

			(function () {
			  var canvas = document.getElementById("canvas-spin");
			  // var w = canvas.width = window.innerWidth;
			  // var h = canvas.height = window.innerHeight;
			  var w = canvas.width;
			  var h = canvas.height;

			  var centerX = w/2;
			  var centerY = h/2;

			  var ctx = canvas.getContext("2d");
			  
			  ctx.lineWidth = 15;
			  var max = Math.max(w, h) * 1.2;
			  var start = 0;
			  var startIncrement = -0.2;
			  function draw() {
			    requestAnimationFrame(draw);
			    ctx.clearRect(0, 0, w, h);
			    ctx.beginPath();
			    var t = start;
			    for(var i = 0; i < max; ++i) {
			      x = Math.cos(t) * i/2 + centerX;
			      y = Math.sin(t) * i/2 + centerY;
			      ctx.lineTo(x, y);
			      t += 0.1;
			    }
			    ctx.stroke();
			    start += startIncrement;
			  }
			  requestAnimationFrame(draw);
			  
			  function toggleDirection(){
			    startIncrement *= -1;
			  }
			  
			  canvas.addEventListener("click", toggleDirection, false);
			})();
		</script>
	</body>
	</html>