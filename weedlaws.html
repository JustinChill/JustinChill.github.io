<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <title>Altered States</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Interactive map on cannabis legalization, medical use, and recreational use by US state">
  <meta name="author" content="Justin Chill">
  <!-- OpenGraph tags -->
  <meta name="keywords" content="marijuana, legal, state, USA, cannabis">
  <meta name="robots" content="all">
  <meta content="en_US" property="og:locale">
  <meta content="JustinChill" property="og:site_name">
  <meta content="website" property="og:type">
  <meta content="https://justinchill.com/weedlaws.html" property="og:url"> 
  <meta content="Altered States" property="og:title">
  <meta content="Interactive map on cannabis legalization, medical use, and recreational use by US state" property="og:description">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  <link rel="canonical" href="https://www.justinchill.com/weedlaws.html">

  <meta content="https://disa.com/uploads/drug-n-alcohol/_1200x630_crop_center-center_82_none/Marijuana-legality.jpg?mtime=1677001111" property="og:image">
  <meta content="1200" property="og:image:width">
  <meta content="630" property="og:image:height">
  <meta content="marijuana types" property="og:image:alt">
  <meta content="https://www.justinchill.com/blog.html" property="og:see_also">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Altered states">
  <meta name="twitter:description" content="Interactive map on cannabis legalization, medical use, and recreational use by US state">

  <link type="text/plain" href="humans.txt" rel="author">
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/favicon.ico">
  <!-- <link rel="icon" href="/imgs/Cannabis_leaf.svg"> -->
  <!-- <link rel=”mask-icon” href=”/imgs/Cannabis_leaf.svg color="#000000"> -->
  <meta name="theme-color" content="#4C63B6">
  
  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>
  
  <style type="text/css">
    .article-subtitle{
      margin-bottom: 1rem;
    }
    [class*="-swatches-wrap"]{
      justify-content: center;
    }

    g[aria-label*="tip"] tspan:first-of-type {{
      font-weight: 700;
    }

</style>
</head>
<body>
  <nav class="nav">
    <div class="nav__list">
      <a href="index.html" class="nav__item">Home</a>
      <a href="blog.html" class="nav__item">Blog</a>
    </div>
    <div class="nav__list">
      <a href="http://linkedin.com/in/justinrichardhill/" class="nav__item" target="_blank">LinkedIn</a>
      <a href="#" class="nav__item js-email-link">Email</a>
    </div>
  </nav>
  
  <main role="main">
    <article>
     <div class="article-hero">
      <h2 class="article-category">Post</h2>
      <h1 class="article-title">Altered States</h1>
      <h2 class="article-subtitle">Cannabis legality in the USA</h2>
    </div>

    <figure id="map" class="mid-size"></figure>
    <figcaption>Data: <a href="https://en.wikipedia.org/wiki/Legality_of_cannabis_by_U.S._jurisdiction">Wikipedia</a>.</figcaption>

    <p>Marijuana is illegal under federal law, but most Americans now live in a state that has legalized the drug<a href="#pew" aria-describedby="footnote-label" id="pew-ref"></a>. The legal cannabis industry in America is barely a decade old. At the start of 2014 adults could not legally purchase weed simply to get high, rather than to ease pain, anywhere in America. Recreational use is now legal in 24 out of 50 states, home to just over half of Americans. Medical use is legal in 38. </p>
    <ul>
      <li><strong>54% of Americans live in a state where the recreational use of marijuana is legal</strong> <strong>–</strong> just a dozen years after <a href="https://money.cnn.com/2012/11/07/news/economy/marijuana-legalization-washington-colorado/index.html">Colorado and Washington became the first states to allow the drug for recreational purposes</a>.</li>
      <li><strong>74% of Americans live in a state where marijuana is legal for either recreational or medical use.</strong> <a href="https://www.latimes.com/archives/la-xpm-1996-11-06-mn-62740-story.html">California was the first state to legalize medical marijuana</a> in 1996.</li>
      <li><strong>79% of Americans live in a county with at least one cannabis dispensary.</strong></li>
      <li><strong>There are nearly 15,000 cannabis dispensaries in the United States.</strong> Dispensaries (businesses that sell cannabis products) are common on the West Coast and Northeast, but also in interior states like Michigan, Oklahoma and Colorado.</li>
      <li><strong>California has far more dispensaries than any state:</strong> 3,659 at the time of this analysis, more than double the amount in the second-highest ranking state. A quarter of all marijuana dispensaries in the U.S. are in California, and nearly all Californians (99.5%) have a dispensary in their county. Los Angeles County alone has more dispensaries (1,481) than any state other than California itself.</li>
      <li><strong>Oklahoma has the most marijuana dispensaries <em>per capita </em>of any state: </strong>36 dispensaries for every 100,000 residents.</li>
    </ul>

    <figure id="stacks"></figure>
    <figcaption>Data: <a href="https://en.wikipedia.org/wiki/Legality_of_cannabis_by_U.S._jurisdiction">Wikipedia</a>.</figcaption>
  </article>
</main>
<footer>
  <h2 id="footnote-label">Footnotes</h2>
  <ol>
    <li id="pew"><a href="https://www.pewresearch.org/short-reads/2024/02/29/most-americans-now-live-in-a-legal-marijuana-state-and-most-have-at-least-one-dispensary-in-their-county/">Pew Research Center, <i>Most Americans now live in a legal marijuana state – and most have at least one dispensary in their county</i> </a>.<a href="#pew-ref" aria-label="Back to content">↩</a></li>
  </ol>

  <div>
    <p>Justin Chill © 2024. Thanks&nbsp;for&nbsp;reading!</p>
    <span><a href="https://github.com/JustinChill/JustinChill.github.io" target="_blank"><img src="imgs/github.svg" class="icon">Source code and feedback</a></span>    
  </div>
</footer>
<svg style="display: none;">
  <filter id="coastalGlow">
    <feGaussianBlur stdDeviation="10" in="SourceAlpha" result="shadow"></feGaussianBlur>
    <feflood flood-color="#9fd8e0" result="color" />
    <feComposite operator="in" in="color" in2="shadow" />
  </filter>
</svg>
<script src="https://cdn.jsdelivr.net/npm/d3"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/topojson@3.0.2/dist/topojson.min.js"></script>

<script type="text/javascript">
  var element = d3.select('figure').node();
  var width = element.getBoundingClientRect().width; // get width of article so graphic is responsive
  var height = document.getElementById("map").getBoundingClientRect().x *3; // get width of article so graphic is responsive
  var size = 12;
  var scheme = "pastel1";
  
  // Use Promises to async request data
  // Todo remove "State laws" from .csv
  var promises = [d3.json("data/geo/us-counties-10m.json"),d3.csv("data/state-weedlaws.csv",d3.autoType),d3.csv("data/geo/us-state-grid.csv",d3.autoType)];

  myDataPromises = Promise.all(promises);

  // After data is successfully fetched, generate viz
  myDataPromises.then(function(data) {
    // Define the data. There's gotta be a better way to do this:
    var us = data[0];
    var laws = data[1];
    var stategrid = data[2];

    var states = topojson.feature(us, us.objects.states);
    var lawmap = new Map(laws.map(d => [d.State, d.LegalStatus]));
    var medmap = new Map(laws.map(d => [d.State, d.Medicinal]));
    var crimmap = new Map(laws.map(d => [d.State, d.Decriminalized]));
    var stateabbr = new Map(stategrid.map(d => [d.name, d.key]));

    const formatDate = d3.timeFormat("%B %d, %Y");

    // Coastal glow from
    var waterColor = "#EAF1F2";
    var waterGlowColor = "#9fd8e0";
    var landColor = "#fff6e6";
    console.log(states);
    var map = {
      width: width,
      inset: 4,
      style:{textTransform: 'capitalize'},
      projection: "albers-usa",
      color: {scheme: scheme, reverse:false, legend: true, },
      marks: [
        // Plot.sphere({fill: waterColor, fillOpacity: .65}),
        // Plot.geo(topojson.mesh(us, us.objects.states, (a, b) => a == b)),
       Plot.geo(states, Plot.centroid({
        fill: d => lawmap.get(d.properties.name) != undefined ? lawmap.get(d.properties.name) : "Mixed", // This is a hack to "hide" undefined values. TODO fix 
        // fill: landColor,
        stroke: null,
        channels: {name: "name", medicinal: d=> medmap.get(d.properties.name), Decriminalized: d=> crimmap.get(d.properties.name), status: d =>lawmap.get(d.properties.name)},
        tip: {
          opacity: 0.9,
          textPadding: 10,
          lineHeight: 1.65,
          fontSize: size,
        },
      })),
       Plot.geo(topojson.mesh(us, us.objects.states, (a, b) => a !== b), {stroke: "darkgray", strokeWidth: .33, strokeOpacity: .95, strokeLinecap: "round" }),
       Plot.text(
         states.features.filter(d => (d.properties.name != "Rhode Island" && d.properties.name != "District of Columbia")),
         Plot.centroid({
           text: (d) => stateabbr.get(d.properties.name),
           textAnchor: "middle",
           stroke: "white",
           strokeWidth: 2,
           fill: "black",
           fontSize: width > 450 ? size : size - 4,
         })
         ),
         Plot.text(
          states.features.filter(d => (d.properties.name == "Rhode Island" || d.properties.name == "District of Columbia")),
          Plot.centroid({
            text: (d) => stateabbr.get(d.properties.name),
            textAnchor: "middle",
            stroke: "white",
            strokeWidth: 2,
            fill: "black",
            fontSize: width > 450 ? size : size - 4,
            dx: width > 450 ? 0 : 7,
            dy: width > 450 ? 0 : 7,
            // dx: d => d.properties.name == "Maryland" ? 20 : 10,
          })
          ),
       ]
    };

    var stacks = {
      width: width,
      style:{fontSize: size, paddingTop: 10, paddingBottom:10},
      aspectRatio: 30,
      x: {label: null},
      y: {label: null, axis: null},
      color: {legend: false, scheme: scheme},
      marks: [
        Plot.ruleY([0], {stroke: "#ccc", strokeLinecap: "round", strokeWidth: 2}),
        Plot.waffleY(laws, Plot.groupX({y: "count"}, {x: "LegalStatus", fill: "LegalStatus"})),
        Plot.axisX({anchor: "bottom", lineWidth: 10, tickSize: 0, fontSize: width > 450 ? size * 2 : size}),
        ]
    };

    document.getElementById("map").appendChild(Plot.plot(map));
    document.getElementById("stacks").appendChild(Plot.plot(stacks));
  });
</script>
</body>
</html>